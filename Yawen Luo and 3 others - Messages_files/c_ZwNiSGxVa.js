/*!CK:3136547186!*//*1409623398,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["vtPzf"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){e.exports={ACTION_EDUCATE:"educate",ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};},null);
__d("ComposedBlockType",[],function(a,b,c,d,e,f){e.exports={UNSTYLED:0,PARAGRAPH:1,UNORDERED_LIST_ITEM:2,ORDERED_LIST_ITEM:3,BLOCKQUOTE:4,HEADER_ONE:5,HEADER_TWO:6,CODE:7,MEDIA:8};},null);
__d("ComposedEntityMutability",[],function(a,b,c,d,e,f){e.exports={MUTABLE:0,IMMUTABLE:1,SEGMENTED:2};},null);
__d("ComposedEntityType",[],function(a,b,c,d,e,f){e.exports={MENTION:0,LINK:1,IMAGE:2,VIDEO:3};},null);
__d("ComposedInlineStyle",[],function(a,b,c,d,e,f){e.exports={NONE:0,BOLD:1,ITALIC:2,UNDERLINE:4,CODE:8};},null);
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.bind(null,la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;},null);
__d("Chat",["Arbiter"],function(a,b,c,d,e,f,g){var h={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function i(k,l){g.subscribe(h[k],function(event,m){l(m);});}var j={openBuddyList:function(){i('buddyListNub',function(k){k.show();i('sidebar',function(l){l.enable();});});},closeBuddyList:function(){i('buddyListNub',function(k){k.hide();});},toggleSidebar:function(){i('sidebar',function(k){k.toggle();});}};a.Chat=e.exports=j;},3);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("OrderedFriendsList",["AvailableList","createArrayFrom","ShortProfiles","WorkModeConfig","InitialChatFriendsList"],function(a,b,c,d,e,f,g,h,i,j){var k=[],l={},m=[],n={contains:function(o){return o in l;},getList:function(){if(j.is_work_user)return h(k);n.reRank();var o=h(k);o=o.filter(function(p){var q=i.getNowUnsafe(p);return !q||q.type=="friend";});return o;},getRank:function(o){return o in l?l[o]:k.length;},reRank:function(){var o={},p={};m.forEach(function(r,s){var t=r.substr(0,r.length-2),u=r.substring(r.length-1);if(typeof(p.uid)=='undefined'){if(typeof(o.uid)=='undefined')o[t]=g.get(t);var v=o[t];if(v==u)p[s]=t;}});k=[];for(var q in p)k.push(p[q]);k.forEach(function(r,s){l[r]=s;});}};(function(){var o=b('InitialChatFriendsList');k=o.list.length?o.list:[];if(!j.is_work_user){m=k.slice();n.reRank();}k.forEach(function(p,q){l[p]=q;});})();e.exports=a.OrderedFriendsList||n;},null);
__d("ChatSidebarSheet",["ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","copyProperties","mixin","setTimeoutAcrossTransitions","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=q.create('sidebar_sheet');function x(da){switch(da){case j.HINT_AUTH:return "Your session has timed out. Please log in.";case j.HINT_CONN:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});case j.HINT_MAINT:return v._("Facebook {Chat} is currently down for maintenance.",{Chat:"Chat"});default:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});}}function y(da){var ea;if(da===null||false===navigator.onLine){ea="Unable to connect to chat. Check your Internet connection.";}else if(da>l.get('warning_countdown_threshold_msec')){var fa=o.create('a',{href:'#',className:'fbChatReconnectLink'},"Try again");ea=o.tx._("Unable to connect to chat. {try-again-link}",{'try-again-link':fa});}else if(da>1000){ea=v._("Unable to connect to chat. Reconnecting in {seconds}...",{seconds:Math.floor(da/1000)});}else ea="Unable to connect to chat. Reconnecting...";return ea;}var z=t(g);for(var aa in z)if(z.hasOwnProperty(aa))ca[aa]=z[aa];var ba=z===null?null:z.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=z;function ca(da){"use strict";this._root=da;this._message=o.find(da,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ca.prototype._handleConnectionChange=function(da,ea){"use strict";this._channelStatus=da;this._channelData=ea;this._render();};ca.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,x(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var da=this._channelData;o.setContent(this._message,y(da));if(da>1000){if(da>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=u(this._handleConnectionChange.bind(this,i.RECONNECTING,da-1000),1000);}}};ca.prototype._renderOffline=function(){"use strict";var da='fbChatGoOnlineLink',ea="Turn on chat",fa=o.create('a',{href:'#',className:da},ea),ga=o.tx._("{=Go online} to see who's available.",{'=Go online':fa});o.setContent(this._message,ga);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),da)){w.log('sidebar_go_online');m.goOnline();return false;}});};ca.prototype._renderBlackbirdUpsell=function(){"use strict";o.setContent(this._message,h.getOfflineContent());};ca.prototype._renderBlackbird=function(da){"use strict";o.setContent(this._message,h.getBlackbirdContent(da));};ca.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ca.prototype._render=function(){"use strict";this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var da=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,da);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ea="Alerts are off while you use another client to chat.";o.setContent(this._message,ea);}this.inform('updated');};s(ca.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ca;},null);
__d("SidebarFitWindowHeight",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","TinyViewport","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$SidebarFitWindowHeight0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){"use strict";if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight1=new k();this.$SidebarFitWindowHeight1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight2!==0){j.set(this.$SidebarFitWindowHeight0,'margin-top','0');this.$SidebarFitWindowHeight2=0;}this.$SidebarFitWindowHeight1&&this.$SidebarFitWindowHeight1.release();}};s.prototype.onScroll=function(){"use strict";o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){"use strict";this.$SidebarFitWindowHeight3=m.getScrollPosition().y;this.$SidebarFitWindowHeight4||(this.$SidebarFitWindowHeight4=this.$SidebarFitWindowHeight0.offsetHeight);};s.prototype.resizeSidebar=function(){"use strict";var t=-Math.max(Math.min(this.$SidebarFitWindowHeight3,this.$SidebarFitWindowHeight4),0);j.set(this.$SidebarFitWindowHeight0,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight2){this.$SidebarFitWindowHeight2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){"use strict";return this.$SidebarFitWindowHeight2;};e.exports=s;},null);
__d("ChatSidebar",["Arbiter","ArbiterMixin","AsyncRequest","Banzai","BanzaiLogger","BootloaderConfig","ChatConfig","ChatImpressionLogger","ChatOptions","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","JSLogger","JSXDOM","KeyEventController","LitestandClassicPlaceHolders","ModalLayer","OrderedFriendsList","Parent","PresencePrivacy","ScrollableArea","SidebarFitWindowHeight","Style","ViewportBounds","copyProperties","createArrayFrom","csx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){var ma,na=false,oa=false,pa=false,qa=false,ra=false,sa=false,ta,ua,va,wa,xa,ya=null,za,ab,bb=u.create('chat_sidebar'),cb='succeeded',db=k.create(ga({retry:true},j.VITAL));function eb(){q.removeClass(document.documentElement,'sidebarMode');if(!qa||!nb.isVisible()){g.inform('reflow');return;}pa=false;ya=null;va.hide();wa.getCore().reset();q.hide(ta);bb.log('sidebar_hide');nb.inform('sidebar/hide',nb);g.inform('sidebar/hide',nb);g.inform('reflow');}function fb(){var ob=nb.shouldShowSidebar();q.conditionClass(document.documentElement,'sidebarCapable',ob);if(nb.isEnabled()&&ob){ib();var pb=ha(ta.childNodes),qb=hb(pb),rb=va.getItemHeight(),sb=8,tb=Math.floor((qb-sb)/rb);ea.set(ma,'height',qb+'px');va.setNumTopFriends(tb);var ub=Math.floor((qb-sb)/rb);ub=(ub-2)>0?ub-2:0;wa.getData().setMaxResults(ub);nb.inform('sidebar/resized',nb);g.inform('sidebar/resized',nb);g.inform('reflow');}else eb();if(!qa){lb();qa=true;}ya=null;}function gb(){if(wa&&nb.isVisible())wa.getCore().getElement().focus();}function hb(ob){if(!ob)ob=ha(ta.childNodes);var pb=xa.height;ob.forEach(function(qb){if(qb&&qb!==ma)pb-=s.getElementDimensions(qb).height;});if(za)pb-=za.getOffset();return Math.max(0,pb);}function ib(){if(nb.isVisible())return;pa=true;ya=null;q.show(ta);q.addClass(document.documentElement,'sidebarMode');va.show();bb.log('sidebar_show');nb.inform('sidebar/show',nb);g.inform('sidebar/show',nb);x.destroy('sidebar');}function jb(){o.setSetting('sidebar_mode',nb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(ka).setErrorHandler(ka).setData({sidebar_mode:nb.isEnabled()}).setAllowCrossPageTransition(true).send();}function kb(){return z.getList().length<=m.get('sidebar.min_friends');}function lb(){var ob=true;if(!nb.isEnabled()){bb.log('state_not_enabled');ob=false;}if(!nb.isViewportCapable()){bb.log('state_not_shown_viewport');ob=false;}if(oa){bb.log('state_not_shown_hidden');ob=false;}if(kb()){bb.log('state_not_shown_num_friends');ob=false;}bb.log(ob?'state_shown':'state_not_shown');}function mb(event,ob){if(!nb.isVisible())return;if(ob){ea.set(ta,'right',ob+'px');}else ea.set(ta,'right','');}var nb={init:function(ob,pb,qb,rb){nb.init=ka;ra=true;ta=ob;va=pb;wa=qb;ua=rb;ma=r.find(ob,'div.fbChatSidebarBody');t.listen(window,'resize',fb);w.registerKey('q',function(event){if(pa){var vb=null;if(ab){vb=r.scry(ab,'.inputsearch')[0];}else vb=r.scry(ob,'.inputsearch')[0];if(vb){vb.focus();event.prevent();}}});var sb=new p(ob);sb.subscribe('updated',fb);g.subscribe('sidebar/invalidate',fb);pb.setScrollContainer(aa.byClass(pb.getRoot(),'uiScrollableAreaWrap'));pb.subscribe(['render','show','hide'],ja(function(vb){if(vb==='render'&&!sa){sa=true;nb.inform('sidebar/chatRendered',null,g.BEHAVIOR_PERSISTENT);}var wb=pb.getRoot(),xb=ca.getInstance(wb);xb&&xb.adjustGripper();}));g.subscribe('chat/option-changed',function(vb,wb){if(wb.name=="sidebar_mode"){na=!!o.getSetting('sidebar_mode');fb();}});qb.getCore().subscribe('sidebar/typeahead/active',nb.updateOnActiveTypeahead);qb.subscribe('reset',function(){if(!qb.getCore().getValue()&&!va.isVisible())nb.updateOnActiveTypeahead(null,false);});g.subscribe('buddylist-nub/initialized',function(vb,wb){t.listen(wb.getButton(),'click',function(event){var xb=oa;oa=false;nb.enable();var yb=nb.shouldShowSidebar();oa=xb&&!yb;return !yb;});});na=!!o.getSetting('sidebar_mode');ba.subscribe('privacy-user-presence-changed',fb);fb();n.init(va);fa.addPersistentRight(nb.getVisibleWidth);nb.inform('sidebar/initialized',nb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',nb,g.BEHAVIOR_PERSISTENT);if(m.get('sidebar_below_bluebar')){var tb=r.find(ob,"._5qqe");za=new da(tb);za.subscribe('resized',fb);}if(m.get('chat_sidebar_load_log')){var ub={event:cb,session_token:rb.session_token,country_code:rb.viewer_country_code,buddylist_short:m.get('buddylist_short_group'),bootloader_retry:l.retry_on_timeout};db.log('MessagesSidebarLoadLoggerConfig',ub);}y.subscribe('CompensateForScrollbar',mb);},updateOnActiveTypeahead:function(ob,pb){if(!pa)return;if(pb){va.hide();}else{va.show();fb();}},isInitialized:function(){return qa;},disable:function(){if(!nb.isEnabled())return;na=false;jb();eb();},enable:function(){if(nb.isEnabled())return;na=true;jb();fb();setTimeout(gb,0);},forceEnsureLoaded:function(){if(ra)return;if(la('pagelet_sidebar'))return;d(['UIPagelet'],function(ob){var pb=v.div({id:"pagelet_sidebar"});r.appendContent(document.body,pb);ob.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ra=true;},ensureLoaded:function(){if(!na)return;nb.forceEnsureLoaded();},hide:function(){if(oa)return;oa=true;eb();},unhide:function(){if(!oa)return;oa=false;fb();},getBody:function(){return ma;},getRoot:function(){return ta;},getVisibleWidth:function(){if(!pa||!ta)return 0;if(ya===null)ya=ta.offsetWidth;return ya;},isEnabled:function(){return na;},isViewportCapable:function(){xa=s.getViewportWithoutScrollbarDimensions();var ob=m.get('sidebar.minimum_width');return xa.width>ob;},shouldShowSidebar:function(){var ob=nb.isViewportCapable();return ob&&!oa&&!kb();},isVisible:function(){return pa;},resize:fb,toggle:function(){nb.isEnabled()?nb.disable():nb.enable();}};ga(nb,h);e.exports=nb;},null);
__d("VideoCallingTour",["Arbiter","ArbiterMixin","Chat","ChatSidebar","ChatVisibility","CSS","DOM","PresencePrivacy","Run","Toggler","Vector","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w=[],x=function(){};function y(){if(j.isVisible()){z();}else if(u)aa();}function z(){s.setContext(t.getBody());ba();s.show();ca();}function aa(){if(!v)v=p.createInstance(u.getRoot());var fa=m.scry(u.getRoot(),'div.fbNubFlyout')[0];if(fa){s.setContext(fa);ba();s.show();ca();}}function ba(){var fa=q.getElementDimensions(s.getContext()).y;s.setOffsetY(fa*.6);s.updatePosition();}function ca(){if(u)w.push(u.subscribe('hide',function(){da();if(!j.isVisible())s.hide();}),u.subscribe('show',function(){s.show();}),u.subscribe('resize',function(){ba();s.updatePosition();}));w.push(g.subscribe('sidebar/show',z),g.subscribe('sidebar/hide',aa),g.subscribe('sidebar/resized',ba));}function da(){if(v){v.setSticky(false);v=null;}}function ea(){while(w.length)w.pop().unsubscribe();if(u)da();s.hide();l.show('fbVideoCallingGetStarted');}r(x,h,{start:function(fa){s=fa;l.hide('fbVideoCallingGetStarted');k.goOnline(function(){w.push(n.subscribe('privacy-user-presence-changed',ea));o.onLeave(ea);i.openBuddyList();var ga=null;w.push(j.subscribe('sidebar/initialized',function(ha,ia){t=ia;clearTimeout(ga);ga=setTimeout(y,0);}),x.subscribe('videocallingtour/end',ea));w.push(g.subscribe('buddylist-nub/initialized',function(ha,ia){u=ia;clearTimeout(ga);ga=setTimeout(y,0);}));});x.inform('videocallingtour/start');}});e.exports=x;},null);
__d("ChatTypeaheadBehavior",["ChatOpenTab","CSS","MercuryConfig","Parent","Rect","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(p,q){var r=j.byClass(p,"_4oes");if(r)h.conditionClass(r,"_5q83",q);}function o(p){"use strict";this._typeahead=p;}o.prototype.enable=function(){"use strict";var p=this._typeahead;this._subscriptions=[p.subscribe('focus',function(){p.getData().refreshData();n(p.getElement(),true);}),p.subscribe('blur',function(q){p.getCore().reset();n(p.getElement(),false);}),p.subscribe('respond',function(q,r){if(r.value&&r.value===p.getCore().getValue()){if(!r.results.length){var s=r.value.toLowerCase(),t=p.getData().getQueryCache();if(!r.isAsync&&!t.hasOwnProperty(s))return;p.getView().showNoResults();}h.addClass(p.getElement(),'hasValue');}}),p.subscribe('reset',function(){h.removeClass(p.getElement(),'hasValue');}),p.subscribe('select',function(q,r){var s=r.selected.uid;if(i.MercuryFBIDGK&&r.selected.mercury_thread&&!r.selected.mercury_thread.is_canonical)s=r.selected.mercury_thread.thread_fbid;p.getView().hide();g.openTabByType(s,r.selected.type,'typeahead');}),p.subscribe('highlight',function(q,r){if(r.index>=0){var s=p.getView().getItems()[r.index];if(s){var t=new k(s),u=s.offsetParent,v=t.boundWithin(new k(u)).getPositionVector();t.getPositionVector().sub(v).scrollElementBy(u);}}})];};o.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(p){this._typeahead.unsubscribe(p);},this);this._subscriptions=null;};l(o.prototype,{_subscriptions:null});e.exports=o;},null);
__d("ContextualLayer.react",["ContextualLayer","React","ReactLayer","Style"],function(a,b,c,d,e,f,g,h,i,j){var k=h.PropTypes,l=i.createClass({propTypes:{contextRef:k.string,context:function(m,n,o){if((m.context==null)==(m.contextRef==null))return new Error(("Exactly one of `context` or `contextRef` must be set on `")+(o+"`."));var p=m[n];if(p!=null){if(typeof p!=='object')return new Error(("Invalid `"+n+"` supplied to `"+o+"`, ")+("expected a React component."));if(h.isValidComponent(p))return new Error(("Invalid `"+n+"` supplied to `"+o+"`, ")+("expected a React component instance. You're passing a React ")+("descriptor."));}}},immutableProps:{modal:null},createLayer:function(m){var n=this._getContextNode(),o={context:n,contextBounds:this.props.contextBounds,position:this.props.position,alignment:this.props.alignment,offsetX:this.props.offsetX,offsetY:this.props.offsetY,addedBehaviors:this.enumerateBehaviors(this.props.behaviors),shouldSetARIAProperties:this.props.shouldSetARIAProperties},p=new g(o,m);this._node=m;this._matchContextSize(this.props);if(this.props.contextBounds)p.setContextWithBounds(n,this.props.contextBounds);p.conditionShow(this.props.shown);return p;},receiveProps:function(m){this.updateBehaviors(m.behaviors);var n=this._getContextNode();if(m.contextBounds){this.layer.setContextWithBounds(n,m.contextBounds);}else this.layer.setContext(n);this._matchContextSize(m);this.layer.setPosition(m.position);this.layer.setAlignment(m.alignment);this.layer.setOffsetX(m.offsetX);this.layer.setOffsetY(m.offsetY);this.layer.conditionShow(m.shown);},_getContextNode:function(){var m;if(this.props.context){m=this.props.context.getDOMNode();}else if(this.props.contextRef)m=this.getNodeForOwnerRef(this.props.contextRef);return m;},_matchContextSize:function(m){var n=this._node,o=this._getContextNode();if(m.containerWidthMatchContext)j.set(n,'width',o.offsetWidth+'px');if(m.containerHeightMatchContext)j.set(n,'height',o.offsetHeight+'px');}});e.exports=l;},null);
__d("SearchableTextInput.react",["EventListener","React","AbstractTextFieldMixin.react","AbstractTextInput.react","getActiveElement","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.createClass({displayName:'SearchableTextInput',propTypes:l(i.propTypes,{queryString:h.PropTypes.string,searchSource:h.PropTypes.object,searchSourceOptions:h.PropTypes.object,onEntriesFound:h.PropTypes.func.isRequired,searchOnFocus:h.PropTypes.bool,searchOnUpdate:h.PropTypes.bool,onPaste:h.PropTypes.func,onFocus:h.PropTypes.func,onChange:h.PropTypes.func}),componentDidMount:function(){if(this.props.onPaste)this._listener=g.listen(this.refs.input.getTextFieldDOM(),'paste',this.props.onPaste);},componentDidUpdate:function(n){if(this.props.searchOnUpdate)if(n.queryString!==this.props.queryString)this.search(this.props.queryString);},componentWillUnmount:function(){if(this._listener){this._listener.remove();this._listener=null;}},_onInputFocus:function(){this.props.searchSource.bootstrap(function(){if(this.props.searchOnFocus)this.search(this.props.queryString);}.bind(this));this.props.onFocus&&this.props.onFocus();},_onSearchCallback:function(n,o){if(this.props.queryString===o)this.props.onEntriesFound(n);},_onChange:function(event){this.props.onChange&&this.props.onChange(event);var n=event.target.value;setTimeout(function(){this.search(n);}.bind(this));},search:function(n){this.props.searchSource.search(n,this._onSearchCallback,this.props.searchSourceOptions);},focusInput:function(){var n=this.getTextFieldDOM();if(k()===n){this._onInputFocus();}else n.offsetHeight&&n.focus();},blurInput:function(){var n=this.getTextFieldDOM();n.offsetHeight&&n.blur();},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();},render:function(){return (h.createElement(j,Object.assign({},this.props,{ref:"input",value:this.props.queryString||'',onFocus:this._onInputFocus,onChange:this._onChange})));}});e.exports=m;},null);
__d("TypeaheadNavigation",[],function(a,b,c,d,e,f){var g={moveUp:function(h,i,j){var k=h.indexOf(i),l=k==-1?h.length-1:k-1;j(l==-1?null:h[l]);},moveDown:function(h,i,j){var k=h.indexOf(i)+1;j(k==h.length?null:h[k]);}};e.exports=g;},null);
__d("TypeaheadView.react",["React","cx","merge"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'TypeaheadView',propTypes:{entries:g.PropTypes.array.isRequired,extraRendererProps:g.PropTypes.object,highlightedEntry:g.PropTypes.object,isVisible:g.PropTypes.bool,queryString:g.PropTypes.string,Renderer:g.PropTypes.func.isRequired,selectedEntry:g.PropTypes.object},_onSelect:function(k,l){if(this.props.onSelect)this.props.onSelect(k,l);},_onHighlight:function(k){this.props.onHighlight(k);},render:function(){var k=((!this.props.isVisible?"hidden_elem":'')),l=i({highlightedEntry:this.props.highlightedEntry,selectedEntry:this.props.selectedEntry,entries:this.props.entries,onSelect:this._onSelect,onHighlight:this._onHighlight,onRenderHighlight:this.props.onRenderHighlight,queryString:this.props.queryString},this.props.extraRendererProps),m=this.props.Renderer;return (g.createElement(g.DOM.div,{className:k},g.createElement(m,Object.assign({},l))));}});e.exports=j;},null);
__d("AbstractTypeahead.react",["AbstractTextFieldMixin.react","ContextualLayer.react","InputSelection","React","ReactLayeredComponentMixin","SearchableTextInput.react","TypeaheadNavigation","TypeaheadView.react","cx","getOrCreateDOMID","merge","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=10,t=j.createClass({displayName:'AbstractTypeahead',mixins:[k],propTypes:q(g.propTypes,{inputClassName:j.PropTypes.string,placeholder:j.PropTypes.string,autoCapitalize:j.PropTypes.string,queryString:j.PropTypes.string,searchSource:j.PropTypes.object.isRequired,searchSourceOptions:j.PropTypes.object,excludedEntries:j.PropTypes.object,presenter:j.PropTypes.object.isRequired,onSelectAttempt:j.PropTypes.func,onEnterWithoutSelection:j.PropTypes.func,autoHighlight:j.PropTypes.bool,showEntriesOnFocus:j.PropTypes.bool,selectOnBlur:j.PropTypes.bool,selectOnTab:j.PropTypes.bool,focusedOnInit:j.PropTypes.bool,hideViewWithEntries:j.PropTypes.bool,disabled:j.PropTypes.bool,entriesWidthMatchContext:j.PropTypes.bool,selectedEntry:j.PropTypes.object,onTypeaheadVisibilityChanged:j.PropTypes.func,onPaste:j.PropTypes.func}),getDefaultProps:function(){return {selectOnBlur:false,selectOnTab:true,hideViewWithEntries:true,entriesWidthMatchContext:true};},getInitialState:function(){return {highlightedEntry:null,isAutoHighlight:this.props.autoHighlight,activeDescendant:null,activeEntries:[],focused:!!this.props.focusedOnInit,viewIsVisible:!!this.props.focusedOnInit};},_onRenderHighlight:function(u){var v=p(u);this.setState({activeDescendant:v});},_onEntriesFound:function(u){if(!this.isMounted())return;if(this.props.excludedEntries){var v=this.props.excludedEntries;u=u.filter(function(da){return !v.hasOwnProperty(da.getUniqueID());});}var w=this.props.presenter,x=typeof w.sortEntries=='function'?w.sortEntries(u):u,y=x.slice(0,w.maxEntries||s);if(!y.length){this.setState({activeDescendant:null,activeEntries:y,highlightedEntry:null,isAutoHighlight:this.props.autoHighlight});this._setViewIsVisible(false);return;}var z=this.state.highlightedEntry,aa=z&&y.indexOf(z)!==-1,ba=(this.state.focused&&(this.props.showEntriesOnFocus||this.props.queryString.length>0));if(!this.props.autoHighlight){this.setState({activeEntries:y,highlightedEntry:aa?z:null});if(ba)this._setViewIsVisible(true);return;}var ca=this.state.isAutoHighlight;if(ca){z=y[0];}else{z=aa?z:y[0];ca=!aa;}this.setState({activeEntries:y,highlightedEntry:z,isAutoHighlight:ca});if(ba)this._setViewIsVisible(true);},_onInputFocus:function(){if((this.state.activeEntries.length&&this.state.queryString)||this.props.showEntriesOnFocus)this._setViewIsVisible(true);this.setState({focused:true});this.props.onFocus&&this.props.onFocus();},_onInputBlur:function(){if(this.props.hideViewWithEntries){this._setViewIsVisible(false);this.clearActiveEntries();}if(this.props.selectOnBlur&&this.state.highlightedEntry)this.props.onSelectAttempt(this.state.highlightedEntry);this.setState({focused:false});this.props.onBlur&&this.props.onBlur();},_onInputClick:function(){var u=this.getTextFieldDOM(),v=i.get(u);if(v&&v.start==v.end)u.select();this.props.onClick&&this.props.onClick();},_onEnter:function(event){if(this.props.onEnterWithoutSelection&&(!this.state.viewIsVisible||!this.state.highlightedEntry)){this.props.onEnterWithoutSelection(event);return;}if(!this.state.viewIsVisible)return;if(!this.state.highlightedEntry){event.preventDefault();return;}if(this.props.hideViewWithEntries)this._setViewIsVisible(false);if(this.props.onSelectAttempt)this.props.onSelectAttempt(this.state.highlightedEntry);event.preventDefault();},_onTab:function(event){if(this.props.selectOnTab&&this.state.viewIsVisible&&this.props.onSelectAttempt&&this.state.highlightedEntry){if(this.props.hideViewWithEntries){this._setViewIsVisible(false);event.preventDefault();}this.props.onSelectAttempt(this.state.highlightedEntry);}},_onDownArrow:function(event){event.preventDefault();m.moveDown(this.state.activeEntries,this.state.highlightedEntry,this._setHighlight);},_onUpArrow:function(event){event.preventDefault();m.moveUp(this.state.activeEntries,this.state.highlightedEntry,this._setHighlight);},_setHighlight:function(u){this.setState({highlightedEntry:u,isAutoHighlight:!u});},_onInputChange:function(event){if(this.props.onChange)this.props.onChange(event);this._setViewIsVisible(this.state.focused&&(this.props.showEntriesOnFocus||event.target.value.length>0)&&this.state.activeEntries.length>0);},_onViewHighlight:function(u){this.setState({highlightedEntry:u,isAutoHighlight:false});},_getView:function(){return (j.createElement(n,{Renderer:this.props.presenter.ViewRenderer,extraRendererProps:this.props.presenter.extraRendererProps,highlightedEntry:this.state.highlightedEntry,selectedEntry:this.props.selectedEntry,isVisible:this.state.viewIsVisible,onHighlight:this._onViewHighlight,onRenderHighlight:this._onRenderHighlight,onSelect:this.props.onSelectAttempt,entries:this.state.activeEntries,queryString:this.props.queryString}));},_setViewIsVisible:function(u){if(u!==this.state.viewIsVisible){this.props.onTypeaheadVisibilityChanged&&this.props.onTypeaheadVisibilityChanged(u);this.setState({viewIsVisible:u});}},componentWillReceiveProps:function(u){if(!u.queryString&&!this.props.showEntriesOnFocus)this.clearActiveEntries();},renderLayers:function(){if(!this.props.presenter.useLayer)return {};var u=null,v=null;if(this.props.context){u=this.props.context;}else v='input';return {typeaheadView:j.createElement(h,{behaviors:this.props.presenter.layerBehaviors,containerWidthMatchContext:this.props.entriesWidthMatchContext,contextRef:v,context:u,position:"below",shown:this.state.viewIsVisible,shouldSetARIAProperties:false},this._getView())};},render:function(){var u=j.createElement(l,{'aria-activedescendant':this.state.activeDescendant,'aria-autocomplete':"list",ref:"input",autoCapitalize:this.props.autoCapitalize,className:this.props.inputClassName,queryString:this.props.queryString,placeholder:this.props.placeholder,searchSource:this.props.searchSource,searchSourceOptions:this.props.searchSourceOptions,searchOnFocus:!!this.props.showEntriesOnFocus,disabled:this.props.disabled,onEntriesFound:this._onEntriesFound,onBlur:this._onInputBlur,onFocus:this._onInputFocus,onChange:this._onInputChange,onDownArrow:this._onDownArrow,onUpArrow:this._onUpArrow,onTab:this._onTab,onEnter:this._onEnter,onBackspace:this.props.onBackspace,onPaste:this.props.onPaste,onClick:this._onInputClick}),v=null;if(!this.props.presenter.useLayer)v=this._getView();return (j.createElement(j.DOM.span,Object.assign({},this.props,{className:r(this.props.className,"_58ah"),onBlur:null,onClick:null,onFocus:null}),{searchableInput:u,view:v}));},componentDidMount:function(){if(this.props.focusedOnInit)this.refs.input.focusInput();},clearActiveEntries:function(){this.setState({activeDescendant:null,activeEntries:[],highlightedEntry:null});},focusInput:function(){this.refs.input.focusInput();},blurInput:function(){if(this.refs.input.blur){this.refs.input.blur();}else if(this.refs.input.blurInput)this.refs.input.blurInput();},hideView:function(){this._setViewIsVisible(false);},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();}});e.exports=t;},null);
__d("AbstractSearchSource",["Deferred","emptyFunction","mixInto"],function(a,b,c,d,e,f,g,h,i){function j(){}var k={bootstrap:function(l){l=l||h;if(this._bootstrapped){l();return;}if(this._bootstrapDeferred)return this._bootstrapDeferred.addCallback(l);this._bootstrapDeferred=new g();this._bootstrapDeferred.addCallback(l);this.bootstrapImpl(function(){this._bootstrapped=true;this._bootstrapDeferred.succeed();this._bootstrapDeferred=null;}.bind(this));return this._bootstrapDeferred;},search:function(l,m,n){this.searchImpl(l,m,n);},bootstrapImpl:function(l){l();},searchImpl:function(l,m,n){throw new Error('Abstract method #searchImpl is not implemented.');}};i(j,k);j.Mixin=k;e.exports=j;},null);
__d("SearchSourceCallbackManager",["createObjectFrom","invariant"],function(a,b,c,d,e,f,g,h){function i(k){"use strict";this.$SearchSourceCallbackManager0=k.parseFn;h(typeof this.$SearchSourceCallbackManager0==='function');this.$SearchSourceCallbackManager1=k.matchFn;h(typeof this.$SearchSourceCallbackManager1==='function');this.$SearchSourceCallbackManager2=k.alwaysPrefixMatch||false;this.$SearchSourceCallbackManager3=k.indexFn||j;this.reset();}i.prototype.search=function(k,l,m){"use strict";var n=this.$SearchSourceCallbackManager4(k,l,m);if(n)return 0;this.$SearchSourceCallbackManager5.push({queryString:k,callback:l,options:m});var o=this.$SearchSourceCallbackManager5.length-1;this.$SearchSourceCallbackManager6.push(o);return o;};i.prototype.$SearchSourceCallbackManager4=function(k,l,m){"use strict";var n=this.$SearchSourceCallbackManager7(k),o=!!this.$SearchSourceCallbackManager8[k];if(!n.length){l([],k);return o;}var p=n.map(function(q){return this.$SearchSourceCallbackManager9[q];},this);l(p,k);return o;};i.prototype.$SearchSourceCallbackManagera=function(){"use strict";var k=this.$SearchSourceCallbackManager6;this.$SearchSourceCallbackManager6=[];k.forEach(this.$SearchSourceCallbackManagerb,this);};i.prototype.$SearchSourceCallbackManagerb=function(k){"use strict";var l=this.$SearchSourceCallbackManager5[k];if(!l)return;var m=this.$SearchSourceCallbackManager4(l.queryString,l.callback,l.options);if(m){delete this.$SearchSourceCallbackManager5[k];return;}this.$SearchSourceCallbackManager6.push(k);};i.prototype.reset=function(){"use strict";this.$SearchSourceCallbackManager9={};this.$SearchSourceCallbackManagerc={};this.$SearchSourceCallbackManagerd={};this.$SearchSourceCallbackManagere={};this.$SearchSourceCallbackManager8={};this.$SearchSourceCallbackManager6=[];this.$SearchSourceCallbackManager5=[undefined];};i.prototype.addLocalEntries=function(k){"use strict";k.forEach(function(l){var m=l.getUniqueID(),n=this.$SearchSourceCallbackManager3(l);this.$SearchSourceCallbackManager9[m]=l;this.$SearchSourceCallbackManagerc[m]=n;var o=this.$SearchSourceCallbackManager0(n);o.tokens.forEach(function(p){if(!this.$SearchSourceCallbackManagerd.hasOwnProperty(p))this.$SearchSourceCallbackManagerd[p]={};this.$SearchSourceCallbackManagerd[p][m]=true;},this);},this);this.$SearchSourceCallbackManagera();};i.prototype.addQueryEntries=function(k,l){"use strict";var m=this.$SearchSourceCallbackManager7(l),n=this.$SearchSourceCallbackManager0(l).flatValue;this.$SearchSourceCallbackManagere[n]=g(m,true);k.forEach(function(o){var p=o.getUniqueID();this.$SearchSourceCallbackManager9[p]=o;this.$SearchSourceCallbackManagerc[p]=this.$SearchSourceCallbackManager3(o);this.$SearchSourceCallbackManagere[n][p]=true;},this);this.$SearchSourceCallbackManagera();};i.prototype.unsubscribe=function(k){"use strict";delete this.$SearchSourceCallbackManager5[k];};i.prototype.removeEntry=function(k){"use strict";delete this.$SearchSourceCallbackManager9[k];};i.prototype.getAllEntriesMap=function(){"use strict";return this.$SearchSourceCallbackManager9;};i.prototype.setQueryStringAsExhausted=function(k){"use strict";this.$SearchSourceCallbackManager8[k]=true;};i.prototype.unsetQueryStringAsExhausted=function(k){"use strict";delete this.$SearchSourceCallbackManager8[k];};i.prototype.$SearchSourceCallbackManager7=function(k){"use strict";var l=this.$SearchSourceCallbackManagerf(k,this.$SearchSourceCallbackManagerg(k)),m=this.$SearchSourceCallbackManagerf(k,this.$SearchSourceCallbackManagerh(k)),n=l.concat(m),o={},p=[];n.forEach(function(q){if(!o[q]&&this.$SearchSourceCallbackManager9[q]!==undefined){p.push(q);o[q]=true;}},this);return p;};i.prototype.$SearchSourceCallbackManagerf=function(k,l){"use strict";var m=this.$SearchSourceCallbackManageri(k,l),n=this.$SearchSourceCallbackManager9;function o(p,q){if(m[p]!==m[q])return m[p]?-1:1;var r=n[p],s=n[q];if(r.getOrder()!==s.getOrder())return r.getOrder()-s.getOrder();var t=r.getTitle().length,u=s.getTitle().length;if(t!==u)return t-u;return r.getUniqueID()-s.getUniqueID();}return l.sort(o).slice();};i.prototype.$SearchSourceCallbackManageri=function(k,l){"use strict";var m={};l.forEach(function(n){m[n]=this.$SearchSourceCallbackManager1(k,this.$SearchSourceCallbackManagerc[n]);},this);return m;};i.prototype.$SearchSourceCallbackManagerg=function(k){"use strict";var l=this.$SearchSourceCallbackManager0(k,this.$SearchSourceCallbackManager2),m=this.$SearchSourceCallbackManager2?l.sortedTokens:l.tokens,n=m.length,o=l.isPrefixQuery?n-1:null,p={},q={},r={},s=false,t={},u=0;m.forEach(function(w,x){if(t.hasOwnProperty(w))return;u++;t[w]=true;for(var y in this.$SearchSourceCallbackManagerd){var z=(y===w&&!p.hasOwnProperty(y)),aa=false;if(!z)aa=((this.$SearchSourceCallbackManager2||o===x)&&y.indexOf(w)===0);if(!z&&!aa)continue;if(y===w){if(q.hasOwnProperty(y))s=true;p[y]=true;}else{if(p.hasOwnProperty(y)||q.hasOwnProperty(y))s=true;q[y]=true;}for(var ba in this.$SearchSourceCallbackManagerd[y])if(x===0||(r.hasOwnProperty(ba)&&r[ba]==u-1))r[ba]=u;}},this);var v=Object.keys(r).filter(function(w){return r[w]==u;});if(s||u<n)v=this.$SearchSourceCallbackManagerj(k,v);return v;};i.prototype.$SearchSourceCallbackManagerh=function(k){"use strict";var l=this.$SearchSourceCallbackManager0(k).flatValue,m=this.$SearchSourceCallbackManagerk(l);if(this.$SearchSourceCallbackManagere.hasOwnProperty(l))return m;return this.$SearchSourceCallbackManagerj(k,m);};i.prototype.$SearchSourceCallbackManagerk=function(k){"use strict";var l=0,m=null,n=this.$SearchSourceCallbackManagere;Object.keys(n).forEach(function(o){if(k.indexOf(o)===0&&o.length>l){l=o.length;m=o;}});return (n.hasOwnProperty(m)?Object.keys(n[m]):[]);};i.prototype.$SearchSourceCallbackManagerj=function(k,l){"use strict";return l.filter(function(m){return this.$SearchSourceCallbackManager1(k,this.$SearchSourceCallbackManagerc[m]);},this);};function j(k){return [k.getTitle(),k.getKeywordString()].join(' ');}e.exports=i;},null);
__d("isValidUniqueID",[],function(a,b,c,d,e,f){function g(h){return (h!==null&&h!==undefined&&h!==''&&(typeof h==='string'||typeof h==='number'));}e.exports=g;},null);
__d("SearchableEntry",["HTML","isValidUniqueID","invariant"],function(a,b,c,d,e,f,g,h,i){function j(l){switch(typeof l){case 'string':return l;case 'object':var m=g.replaceJSONWrapper(l);if(g.isHTML(m)){var n=m.getRootNode();return n.textContent||n.innerText||'';}else return '';default:return '';}}function k(l){"use strict";i(h(l.uniqueID));i(!!l.title&&typeof l.title==='string');this.$SearchableEntry0=l.uniqueID+'';this.$SearchableEntry1=l.title;this.$SearchableEntry2=l.order||0;this.$SearchableEntry3=j(l.subtitle);this.$SearchableEntry4=l.keywordString||'';this.$SearchableEntry5=l.photo||'';this.$SearchableEntry6=l.uri||'';this.$SearchableEntry7=l.type||'';this.$SearchableEntry8=l.auxiliaryData||null;}k.prototype.getUniqueID=function(){"use strict";return this.$SearchableEntry0;};k.prototype.getOrder=function(){"use strict";return this.$SearchableEntry2;};k.prototype.getTitle=function(){"use strict";return this.$SearchableEntry1;};k.prototype.getSubtitle=function(){"use strict";return this.$SearchableEntry3;};k.prototype.getKeywordString=function(){"use strict";return this.$SearchableEntry4;};k.prototype.getPhoto=function(){"use strict";return this.$SearchableEntry5;};k.prototype.getURI=function(){"use strict";return this.$SearchableEntry6;};k.prototype.getType=function(){"use strict";return this.$SearchableEntry7;};k.prototype.getAuxiliaryData=function(){"use strict";return this.$SearchableEntry8;};e.exports=k;},null);
__d("AbstractAsyncSearchSource",["AbstractSearchSource","SearchSourceCallbackManager","SearchableEntry","TokenizeUtil","copyProperties","emptyFunction","isValidUniqueID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in g)if(g.hasOwnProperty(n))p[n]=g[n];var o=g===null?null:g.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=g;function p(q,r,s){"use strict";this.$AbstractAsyncSearchSource0=q.bootstrapRequests;this.$AbstractAsyncSearchSource1=q.queryRequests;this.$AbstractAsyncSearchSource2=q.auxiliaryFields;this.$AbstractAsyncSearchSource3=q.asyncErrorHandler||l;this.$AbstractAsyncSearchSource4=q.packageFn||this.$AbstractAsyncSearchSource5;this.$AbstractAsyncSearchSource6=q.getAllForEmptyQuery;this.$AbstractAsyncSearchSource7=[];this.$AbstractAsyncSearchSource8=new h({parseFn:j.parse,matchFn:j.isQueryMatch,indexFn:q.indexFn});this.$AbstractAsyncSearchSource9=r;this.$AbstractAsyncSearchSourcea=s;}p.prototype.bootstrapImpl=function(q){"use strict";if(!this.$AbstractAsyncSearchSource0||!this.$AbstractAsyncSearchSource0.length){q();return;}var r=this.$AbstractAsyncSearchSource0.length,s=0;this.$AbstractAsyncSearchSource0.forEach(function(t){this.$AbstractAsyncSearchSourceb({},t,function(u){this.$AbstractAsyncSearchSource8.addLocalEntries(u);this.$AbstractAsyncSearchSource7=this.$AbstractAsyncSearchSource7.concat(u);s++;if(s===r){q();q=null;}}.bind(this));}.bind(this));};p.prototype.searchImpl=function(q,r,s){"use strict";if(this.$AbstractAsyncSearchSource6&&q===''){this.getBootstrappedEntries(function(y){r(y,q);});return;}var t=null,u={},v=this.$AbstractAsyncSearchSource8.search(q,function(y){if(!t){t=y;t.forEach(function(z){u[z.getUniqueID()]=true;});}else y.forEach(function(z){var aa=z.getUniqueID();if(!u[aa]){t.push(z);u[aa]=true;}});r(t,q);},s);if(!v||!this.$AbstractAsyncSearchSource1||!this.$AbstractAsyncSearchSource1.length)return;var w={value:q,existing_ids:t&&t.map(function(y){return y.getUniqueID();}).join(',')},x=this.$AbstractAsyncSearchSource1.length;this.$AbstractAsyncSearchSource1.forEach(function(y){this.$AbstractAsyncSearchSourceb(w,y,function(z){this.$AbstractAsyncSearchSourcec(z,q);x--;if(!x)this.$AbstractAsyncSearchSource8.setQueryStringAsExhausted(q);}.bind(this));},this);};p.prototype.getBootstrappedEntries=function(q){"use strict";return this.bootstrap(function(){return q(this.$AbstractAsyncSearchSource7||[]);}.bind(this));};p.prototype.getAllEntriesMap=function(){"use strict";return this.$AbstractAsyncSearchSource8.getAllEntriesMap();};p.prototype.$AbstractAsyncSearchSourceb=function(q,r,s){"use strict";this.$AbstractAsyncSearchSource9(q,r,function(t){return s(this.$AbstractAsyncSearchSourcea(t,this.$AbstractAsyncSearchSource4).filter(function(u){return !!u;}));}.bind(this),this.$AbstractAsyncSearchSource3);};p.prototype.$AbstractAsyncSearchSourced=function(q){"use strict";this.$AbstractAsyncSearchSource8.addLocalEntries(q);};p.prototype.$AbstractAsyncSearchSourcec=function(q,r){"use strict";if(q.length)this.$AbstractAsyncSearchSource8.addQueryEntries(q,r);};p.prototype.$AbstractAsyncSearchSource5=function(q,r){"use strict";var s=q.title||q.text,t=q.uniqueID||q.uid;if(!s||!m(t))return null;return new i({uniqueID:t,order:q.order||q.index||r,title:s,subtitle:q.subtitle||q.category||q.subtext,keywordString:q.keywordString||q.tokens,type:q.type,photo:q.photo,uri:q.uri||q.path,auxiliaryData:this.$AbstractAsyncSearchSourcee(q)});};p.prototype.$AbstractAsyncSearchSourcee=function(q){"use strict";var r;if(this.$AbstractAsyncSearchSource2){r={};for(var s in this.$AbstractAsyncSearchSource2){var t=this.$AbstractAsyncSearchSource2[s];r[s]=q[t];}}if(q.aux_data){r=r||{};k(r,q.aux_data);}return r;};e.exports=p;},null);
__d("WebAsyncSearchSource",["AbstractAsyncSearchSource","AbstractSearchSource","AsyncRequest","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){for(var k in h)if(h.hasOwnProperty(k))m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){"use strict";this.$WebAsyncSearchSource0=new g(n,this.$WebAsyncSearchSource1,this.$WebAsyncSearchSource2);}m.prototype.bootstrapImpl=function(n){"use strict";this.$WebAsyncSearchSource0.bootstrap(n);};m.prototype.searchImpl=function(n,o,p){"use strict";this.$WebAsyncSearchSource0.search(n,o,p);};m.prototype.getBootstrappedEntries=function(n){"use strict";return this.$WebAsyncSearchSource0.getBootstrappedEntries(n);};m.prototype.getAllEntriesMap=function(){"use strict";return this.$WebAsyncSearchSource0.getAllEntriesMap();};m.prototype.$WebAsyncSearchSource1=function(n,o,p,q){"use strict";new i(o.uri).setData(j({},n,o.data)).setMethod('GET').setReadOnly(true).setHandler(p).setErrorHandler(q).send();};m.prototype.$WebAsyncSearchSource2=function(n,o){"use strict";var p=n.getPayload().entries||n.getPayload()||[];return p.map(o,this);};e.exports=m;},null);
__d("getDOMImageSize",["URI"],function(a,b,c,d,e,f,g){function h(m){m.onload=null;m.onerror=null;m.onreadystatechange=null;m._callback=null;m._thisObj=null;m._srcStr=null;m.parentNode&&m.parentNode.removeChild(m);}function i(){var m=this;if(m._callback)m._callback.call(m._thisObj,m.naturalWidth||m.width,m.naturalHeight||m.height,m._srcStr);h(m);}function j(){var m=this;if(m.readyState==='complete')i.call(m);}function k(){var m=this;if(m._callback)m._callback.call(m._thisObj,0,0,m._srcStr);h(m);}function l(m,n,o){o=o||null;if(!m){n.call(o,0,0,'');return;}var p=document.body;if(!p){setTimeout(l.bind(this,m,n,o),500);return;}var q;if(typeof m==='string'){q=m;}else if(typeof m==='object')if(typeof m.width==='number'&&typeof m.height==='number'){if(typeof m.src==='string'){q=m.src;if(m.naturalWidth&&m.naturalHeight){n.call(o,m.naturalWidth,m.naturalHeight,q);return;}}if(typeof m.uri==='string'){q=m.uri;if(m.width&&m.height){n.call(o,m.width,m.height,q);return;}}}else if(m instanceof g)q=m.toString();if(!q){n(0,0,m);return;}var r=document.createElement('img');r.onreadystatechange=j;r.onload=i;r.onerror=k;r._callback=n;r._thisObj=o;r._srcStr=q;r.src=q;r.style.cssText='position:absolute;left:0;top:0;width:auto;height:auto;clip:rect(0 0 0 0);';p.insertBefore(r,p.firstChild);}e.exports=l;},null);
__d("CachedDOMImageSizePool",["debounce","getDOMImageSize"],function(a,b,c,d,e,f,g,h){function i(j,k){"use strict";this.$CachedDOMImageSizePool0={};this.$CachedDOMImageSizePool1=k;this.$CachedDOMImageSizePool2=0;this.$CachedDOMImageSizePool3=j;this.$CachedDOMImageSizePool4=g(this.$CachedDOMImageSizePool5,5000,this);this.$CachedDOMImageSizePool6={};this.$CachedDOMImageSizePool7={};}i.prototype.get=function(j,k,l){"use strict";if(!j){k.call(l,0,0,j);return;}var m=this.$CachedDOMImageSizePool0[j];if(m){m.lastAccessTime=Date.now();k.call(l,m.width,m.height,m.src);}else if(this.$CachedDOMImageSizePool6[j]){this.$CachedDOMImageSizePool6[j].push(k);this.$CachedDOMImageSizePool7[j].push(l);}else{this.$CachedDOMImageSizePool6[j]=[k];this.$CachedDOMImageSizePool7[j]=[l];h(j,this.$CachedDOMImageSizePool8,this);}};i.prototype.set=function(j,k,l){"use strict";if(this.$CachedDOMImageSizePool2>this.$CachedDOMImageSizePool3)this.$CachedDOMImageSizePool4();var m=this.$CachedDOMImageSizePool0;if(j&&!m[j]){var n={width:k,height:l,src:j,lastAccessTime:Date.now()};m[j]=n;this.$CachedDOMImageSizePool2++;}};i.prototype.$CachedDOMImageSizePool8=function(j,k,l){"use strict";this.set(l,j,k);var m=this.$CachedDOMImageSizePool6[l],n=this.$CachedDOMImageSizePool7[l];for(var o=0,p=m.length;o<p;o++)m[o].call(n[o],j,k,l);delete this.$CachedDOMImageSizePool6[l];delete this.$CachedDOMImageSizePool7[l];};i.prototype.$CachedDOMImageSizePool5=function(){"use strict";var j=Date.now(),k=this.$CachedDOMImageSizePool0,l=this.$CachedDOMImageSizePool2,m=this.$CachedDOMImageSizePool1;for(var n in k){var o=k[n];if((j-o.lastAccessTime)>m){delete k[n];l--;}}this.$CachedDOMImageSizePool2=l;};e.exports=i;},null);
__d("BackgroundImage.react",["CachedDOMImageSizePool","React","ReactPropTypes","XUISpinner.react","cx","invariant","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n='(-?(\\d+\\.)?\\d+(px|\\%))',o=new RegExp('^'+n+'?(\\s'+n+')?$','g'),p=new g(50,10*60*1000),q=h.createClass({displayName:'BackgroundImage',propTypes:{src:i.string,width:i.number.isRequired,height:i.number.isRequired,backgroundSize:i.oneOf(['contain','cover','containinside','coverinside']),loadingIndicatorStyle:i.oneOf(['none','large','small']),backgroundPosition:function(r,s,t){var u=r[s];if(u){l(typeof u==='string');l(u.match(o));}},onImageLoad:i.func,optimizeResizeSpeed:i.bool,onContextMenu:i.func},getInitialState:function(){return {imageWidth:null,imageHeight:null,imageSrc:this.props.src,loading:true};},getDefaultProps:function(){return {optimizeResizeSpeed:false,loadingIndicatorStyle:'none'};},componentDidMount:function(){this._resolveImageSize();},componentDidUpdate:function(r){if(this.props.src!==this.state.imageSrc)this.setState({imageWidth:0,imageHeight:0,imageSrc:this.props.src,loading:true},this._resolveImageSize);},_resolveImageSize:function(){var r=this.state.imageSrc;if(r)p.get(r,this._onImageSizeResolved,this);},render:function(){var r={width:this.props.width+'px',height:this.props.height+'px'},s=m(this.props.className,"_5f0d");return (h.createElement(h.DOM.div,Object.assign({},this.props,{className:m(this.props.className,s),style:Object.assign({},(this.props.style||{}),r),onContextMenu:this.props.onContextMenu}),this._renderImage(),this._renderContent(),this._renderLoadingIndicator()));},_renderLoadingIndicator:function(){if(!this.state.loading||this.props.loadingIndicatorStyle==='none')return null;return (h.createElement(h.DOM.div,{className:"_5laq _5lar"},h.createElement(h.DOM.div,{className:"_5las"},h.createElement(h.DOM.div,{className:"_5lat"},h.createElement(j,{size:this.props.loadingIndicatorStyle})))));},_renderContent:function(){if(this.props.children)return (h.createElement(h.DOM.div,{className:"_5laq"},h.createElement(h.DOM.div,{className:"_5las"},h.createElement(h.DOM.div,{className:"_5lat"},this.props.children))));},_renderImage:function(){if(!this.state.imageWidth||!this.state.imageHeight)return;var r=this.props.width,s=this.props.height,t,u;switch(this.props.backgroundSize){case 'cover':t='cover';u=false;break;case 'coverinside':t='cover';u=true;break;case 'contain':t='contain';u=false;break;case 'containinside':t='contain';u=true;}var v=this.state.imageWidth,w=this.state.imageHeight,x=r/s,y=v/w;if(t==='contain')if((v>r||!u)&&y>=x){v=r;w=v/y;}else if(w>s||!u){w=s;v=w*y;}if(t==='cover')if((v>r||!u)&&y>=x){w=s;v=w*y;}else if(w>s||!u){v=r;w=v/y;}var z=this._getImageStyle(v,w);return (h.createElement(h.DOM.img,{alt:"",className:(("_5i4g")+(this.props.optimizeResizeSpeed?' '+"_5sjv":'')),style:z,src:this.state.imageSrc}));},_getImageStyle:function(r,s){var t;if(this.props.backgroundPosition){t=this.props.backgroundPosition.split(' ');}else t=['50%','50%'];return {width:Math.round(r)+'px',height:Math.round(s)+'px',left:this._getBackgroundPositionPxValue('left',t[0],r,s),top:this._getBackgroundPositionPxValue('top',t[1]||t[0],r,s)};},_getBackgroundPositionPxValue:function(r,s,t,u){var v=parseFloat(s),w=s.substr(v.toString().length);if(w==='px')return s;if(r==='left'){return Math.round((this.props.width-t)*(v/100))+'px';}else return Math.round((this.props.height-u)*(v/100))+'px';},_onImageSizeResolved:function(r,s,t){if(!this.isMounted()||this.state.imageSrc!==t)return;var u=this.props.onImageLoad?this.props.onImageLoad.bind(null,r,s):null;this.setState({imageWidth:r,imageHeight:s,loading:false},u);}});e.exports=q;},null);
__d("TypeaheadViewItem",["React","SearchableEntry"],function(a,b,c,d,e,f,g,h){var i={entry:g.PropTypes.instanceOf(h).isRequired,highlighted:g.PropTypes.bool,selected:g.PropTypes.bool,onSelect:g.PropTypes.func.isRequired,onHighlight:g.PropTypes.func,onRenderHighlight:g.PropTypes.func},j={_onSelect:function(k){this.props.onSelect(this.props.entry,k);},_onHighlight:function(k){if(this.props.onHighlight)this.props.onHighlight(this.props.entry,k);},shouldComponentUpdate:function(k){return (this.props.entry.getUniqueID()!==k.entry.getUniqueID()||this.props.highlighted!==k.highlighted||this.props.selected!==k.selected);},componentDidMount:function(){if(this.props.highlighted&&this.props.onRenderHighlight)this.props.onRenderHighlight(this.getDOMNode());},componentDidUpdate:function(){if(this.props.highlighted&&this.props.onRenderHighlight)this.props.onRenderHighlight(this.getDOMNode());}};e.exports={propTypes:i,Mixin:j};},null);
__d("ContentRollTypeaheadView.react",["BackgroundImage.react","ImageBlock.react","LegacyScrollableArea.react","React","TypeaheadViewItem","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=j.createClass({displayName:'ContentRollTypeaheadViewItem',mixins:[k.Mixin],propTypes:k.propTypes,render:function(){var p=this.props.entry,q=p.getSubtitle()?j.createElement(j.DOM.div,{className:"_599q"},p.getSubtitle()):null;if(q&&p.getAuxiliaryData()&&p.getAuxiliaryData().icon)q=j.createElement(h,{spacing:"small"},j.createElement(g,{width:16,height:16,src:p.getAuxiliaryData().icon}),q);var r=p.getPhoto()?j.createElement(g,{width:32,height:32,backgroundSize:"cover",src:p.getPhoto()}):j.createElement(j.DOM.span,null),s=(("_5yww")+(!q?' '+"_5mne":'')+(this.props.highlighted?' '+"_599n":''));return (j.createElement(j.DOM.li,{className:s,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight},j.createElement(h,{spacing:"medium"},r,j.createElement(j.DOM.div,null,j.createElement(j.DOM.div,{className:"_599p"},p.getTitle()),q))));}}),o=j.createClass({displayName:'ContentRollTypeaheadView',propTypes:{highlightedEntry:j.PropTypes.object,entries:j.PropTypes.array.isRequired,onSelect:j.PropTypes.func.isRequired,onHighlight:j.PropTypes.func,onRenderHighlight:j.PropTypes.func,scrollableAreaHeight:j.PropTypes.number.isRequired,scrollableAreaWidth:j.PropTypes.number.isRequired},_renderItem:function(p){var q=p===this.props.highlightedEntry;return (j.createElement(n,{key:p.getUniqueID(),entry:p,highlighted:q,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight}));},render:function(){var p=(("_2072")+(!this.props.entries.length?' '+"_599s":'')),q=this.props.entries,r={};q.forEach(function(v){r[v.getType()]=r[v.getType()]||[];r[v.getType()].push(v);});var s=[];for(var t in r){var u=null;switch(t){case 'recent':u="Recently Viewed Links";break;case 'saved':u="Saved Links";break;case 'bing':u="Bing Results";break;}if(u)s.push(j.createElement(j.DOM.div,{className:"_1opo"},u));r[t].forEach(function(v){s.push(this._renderItem(v));},this);}return (j.createElement(j.DOM.div,{className:p},j.createElement(i,{height:this.props.scrollableAreaHeight,width:this.props.scrollableAreaWidth},j.createElement(j.DOM.ul,null,s))));}});e.exports=o;},null);
__d("ContentRollTypeahead.react",["AbstractTypeahead.react","React","ReactPropTypes","WebAsyncSearchSource","ContentRollTypeaheadView.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=20,o='/ajax/metacomposer/attachment/og/typeahead/content_roll',p=h.createClass({displayName:'ContentRollTypeahead',propTypes:{className:i.string,onSelection:i.func.isRequired,scrollableAreaHeight:h.PropTypes.number.isRequired,scrollableAreaWidth:h.PropTypes.number.isRequired,userID:i.string.isRequired,useLayer:i.bool},getInitialState:function(){return {query:''};},_handleChange:function(event){this.setState({query:event.target.value});},_handleSelectAttempt:function(q){this.setState({query:''});var r={object_id:q.getUniqueID(),url:q.getURI(),source:q.getType(),query:q.getAuxiliaryData().query,subindex:q.getAuxiliaryData().subindex,subtotal:q.getAuxiliaryData().subtotal,index:q.getAuxiliaryData().index,total:q.getAuxiliaryData().total};this.props.onSelection(r);},_getSearchSource:function(){if(!this._searchSource)this._searchSource=new j({bootstrapRequests:[{uri:o,data:{viewer:this.props.userID}}],queryRequests:[{uri:o,data:{viewer:this.props.userID}}],getAllForEmptyQuery:true});return this._searchSource;},_getPlaceholder:function(){if(!this._placeholder)this._placeholder="Search for articles, videos, music, and more";return this._placeholder;},focusInput:function(){this.refs.typeahead.focusInput();},render:function(){var q={ViewRenderer:k,maxEntries:n,useLayer:this.props.useLayer,extraRendererProps:{scrollableAreaHeight:this.props.scrollableAreaHeight,scrollableAreaWidth:this.props.scrollableAreaWidth}};return (h.createElement(g,{autoHighlight:true,className:this.props.className,focusedOnInit:true,inputClassName:"_55r1",onChange:this._handleChange,onSelectAttempt:this._handleSelectAttempt,placeholder:this._getPlaceholder(),presenter:q,queryString:this.state.query,ref:"typeahead",searchSource:this._getSearchSource(),showEntriesOnFocus:true}));}});e.exports=p;},null);
__d("ContentRollFlyout.react",["ContentRollTypeahead.react","Parent","React","ReactPropTypes","Toggler","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.createClass({displayName:'ContentRollFlyout',propTypes:{onSelection:j.func.isRequired,userID:j.string.isRequired},getInitialState:function(){return {showFlyout:false};},componentDidMount:function(){var n=this._getParentToggler();if(n)k.listen('show',n,function(){this.setState({showFlyout:true});}.bind(this));},_getParentToggler:function(){return h.byClass(this.getDOMNode(),'uiToggle');},_hideParentToggler:function(){var n=this._getParentToggler();if(n)k.hide(n);},_handleSelection:function(n){this._hideParentToggler();this.props.onSelection(n);},render:function(){if(!this.state.showFlyout)return i.createElement(i.DOM.div,null);return (i.createElement(g,{className:"_5j11",onSelection:this._handleSelection,scrollableAreaHeight:288,scrollableAreaWidth:256,userID:this.props.userID,useLayer:false}));}});e.exports=m;},null);
__d("XUIAmbientNUX.react",["HasLayerContextMixin","React","ReactLayer","ReactAbstractContextualDialog","XUIAmbientNUXTheme","XUICloseButton.react","XUIContextualDialogBody.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.PropTypes,p=300,q=380,r=i.createClass(j.createSpec({displayName:'XUIAmbientNUX',theme:k})),s=h.createClass({displayName:'XUIAmbientNUX',mixins:[g],propTypes:{context:o.object,contextRef:o.string,position:o.oneOf(['above','below','left','right']),alignment:o.oneOf(['left','center','right']),offsetX:o.number,offsetY:o.number,width:o.oneOf(['wide','normal','auto','custom']),customwidth:o.number,shown:o.bool,onCloseButtonClick:o.func},_getWidth:function(){switch(this.props.width){case 'wide':return q;case 'custom':return this.props.customwidth;case 'auto':return null;default:return p;}},render:function(){return (h.createElement(r,{alignment:this.props.alignment,autoFocus:false,context:this.getContextNode(),focusContextOnHide:false,offsetX:this.props.offsetX,offsetY:this.props.offsetY,position:this.props.position,shown:this.props.shown,width:this._getWidth(this.props)},h.createElement(h.DOM.div,{className:"_53iv"},h.createElement(m,null,h.createElement(l,{shade:"light",className:"_36gl",onClick:this.props.onCloseButtonClick}),h.createElement(h.DOM.div,{className:"_36gn"},this.props.children)))));}});e.exports=s;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b('WebMessengerWidthControl');function v(){}s(v,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(w){this.init=u;this.rootEl=w;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(w,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(x,y){var z=y.getActive();if(!n.contains(w,z))return;if(l.hasClass(z,'fbNub')){this.notifyNub(z,x);if(x==='show')this._resizeNubFlyout(z);}else{var aa=o.byClass(z,'fbNubFlyout');if(aa)l.conditionClass(aa,'menuOpened',x==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var w=n.scry(document,"div._4f7n")[0];if(w){var x=p.isFixed(w)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(w,x).y+r.getElementDimensions(w).y;}},toggle:function(w){var x=this._findFlyout(w);if(!x)return;this.subscribe('init',function(){q.toggle(w);});},show:function(w){this.subscribe('init',function(){q.show(w);});},showNub:function(w){l.show(w);},hide:function(w){this.subscribe('init',function(){var x=q.getInstance(w);n.contains(w,x.getActive())&&x.hide();});},hideNub:function(w){l.hide(w);this.hide(w);},setUseMaxHeight:function(w,x){l.conditionClass(w,'maxHeight',x!==false);this._resizeNubFlyout(w);},_resizeNubFlyout:function(w){var x=this._findFlyout(w);if(!x||!(l.hasClass(w,'openToggler')||l.hasClass(w,'opened')))return;var y=n.find(x,'div.fbNubFlyoutOuter'),z=n.find(y,'div.fbNubFlyoutInner'),aa=n.find(z,'div.fbNubFlyoutBody'),ba=aa.scrollTop,ca=aa.offsetHeight;p.set(aa,'height','auto');var da=r.getElementDimensions(x),ea=r.getElementDimensions(aa),fa=this.getMaxFlyoutHeight(w);p.set(x,'max-height',fa+'px');p.set(y,'max-height',fa+'px');da=r.getElementDimensions(x);var ga=r.getElementDimensions(z),ha=ga.y-ea.y,ia=da.y-ha,ja=parseInt(aa.style.height||aa.clientHeight,10),ka=ia!==ja;if(da.y>ha&&ka)p.set(aa,'height',ia+'px');l.removeClass(x,'swapDirection');var la=r.getElementPosition(x).x;l.conditionClass(x,'swapDirection',function(){if(la<0)return true;return (la+da.x>this.viewportDimensions.x);}.bind(this)());if(ka&&ba+ca>=ea.y){aa.scrollTop=aa.scrollHeight;}else aa.scrollTop=ba;this.notifyNub(w,'resize');},getMaxFlyoutHeight:function(w){var x=this._findFlyout(w),y=r.getElementPosition(x,'viewport'),z=r.getElementDimensions(x),aa=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-y.y-z.y);return Math.max(aa,0);},resizeAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this._resizeNubFlyout(w[x]);},hideAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this.hide(w[x]);},_getAllNubs:function(){var w=n.scry(this.rootEl,"div._50-v.openToggler");return w.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var w=event.getTarget(),x=o.byClass(w,'fbNub');if(x){if(o.byClass(w,'fbNubFlyoutTitlebar')){var y=o.byTag(w,'a'),z=w.nodeName=='INPUT'&&w.getAttribute('type')=='submit';if(!y&&!z){this.hide(x);return false;}}this.notifyNub(x,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(w){return l.hasClass(w,'fbNubFlyout')?w:n.scry(w,'div.fbNubFlyout')[0]||null;},registerNubController:function(w,x){m.set(w,'dock:nub:controller',x);x.subscribe('nub/button/content-changed',h(this.inform,this,'resize',w));x.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,w));},unregisterNubController:function(w){m.remove(w,'dock:nub:controller');},notifyNub:function(w,x,y){var z=m.get(w,'dock:nub:controller');z&&z.inform(x,y);}});e.exports=a.Dock||v;},null);
__d("NubController",["ArbiterMixin","Dock","copyProperties"],function(a,b,c,d,e,f,g,h,i){function j(){}i(j.prototype,g,{init:function(k){this.el=k;h.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){h.hide(this.el);},show:function(){h.show(this.el);}});e.exports=j;},null);
__d("arraySort",["invariant"],function(a,b,c,d,e,f,g){function h(i,j){g(Array.isArray(i));var k=i.slice();if(j)return k.sort(j);return k.sort();}e.exports=h;},null);
__d("checkRangeOverlap",["invariant"],function(a,b,c,d,e,f,g){function h(i,j,k,l){g(i<=j&&k<=l);return (i<l&&j>k);}e.exports=h;},null);
__d("fillArray",[],function(a,b,c,d,e,f){function g(h,i){var j=new Array(h);for(var k=0;k<h;k++)j[k]=i;return j;}e.exports=g;},null);
__d("DataViewPolyfill",["copyProperties"],function(a,b,c,d,e,f,g){"use strict";function h(i,j,k){if(j===undefined){this._ba=new Uint8Array(i);}else if(k===undefined){this._ba=new Uint8Array(i,j);}else this._ba=new Uint8Array(i,j,k);this.byteLength=this._ba.byteLength;}g(h,{isSupported:function(){return !!a.Uint8Array;}});g(h.prototype,{getUint8:function(i){if(i>=this._ba.length)throw new Error('Trying to read beyond bounds of DataViewPolyfill');return this._ba[i];},getUint16:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1);return j?(l*256)+k:(k*256)+l;},getUint32:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1),m=this.getUint8(i+2),n=this.getUint8(i+3);return j?(((n*256+m)*256+l)*256)+k:(((k*256+l)*256+m)*256)+n;}});e.exports=h;},null);
__d("DocumentCommands",["keyMirror"],function(a,b,c,d,e,f,g){var h=g({UNDO:true,REDO:true,DELETE:true,DELETE_WORD:true,DELETE_TO_END_OF_BLOCK:true,BACKSPACE:true,BACKSPACE_WORD:true,BACKSPACE_TO_END_OF_BLOCK:true,BOLD:true,ITALIC:true,UNDERLINE:true,CODE:true,INSERT_BLOCK_DELIMITER:true,TRANSPOSE_CHARACTERS:true,MOVE_SELECTION_TO_START_OF_BLOCK:true,MOVE_SELECTION_TO_END_OF_BLOCK:true});e.exports=h;},null);
__d("DocumentCharacters",[],function(a,b,c,d,e,f){var g={BLOCK_DELIMITER:'\u000D',SOFT_NEWLINE:'\u000A',PHOTO:'\ud83d\udcf7',VIDEO:'\ud83d\udcf9'};e.exports=g;},null);
__d("DocumentRemovalDirection",[],function(a,b,c,d,e,f){var g={BACKWARD:0,FORWARD:1};e.exports=g;},null);
__d("DocumentCompositeDecorator.Experimental",["fillArray"],function(a,b,c,d,e,f,g){function h(k){"use strict";this.$DocumentCompositeDecorator0=k.slice();}h.prototype.getDecorations=function(k){"use strict";var l=g(k.getText().length,null);this.$DocumentCompositeDecorator0.forEach(function(m,n){var o=m.getStrategy();o(k,function(p,q){if(i(l,p,q))j(l,p,q,n);});});return l;};h.prototype.getComponentForKey=function(k){"use strict";return this.$DocumentCompositeDecorator0[k].getComponent();};function i(k,l,m){for(var n=l;n<m;n++)if(k[n]!=null)return false;return true;}function j(k,l,m,n){for(var o=l;o<m;o++)k[o]=n;}e.exports=h;},null);
__d("DocumentDecorator",[],function(a,b,c,d,e,f){function g(h,i){"use strict";this.$DocumentDecorator0=h;this.$DocumentDecorator1=i;}g.prototype.getStrategy=function(){"use strict";return this.$DocumentDecorator0;};g.prototype.getComponent=function(){"use strict";return this.$DocumentDecorator1;};e.exports=g;},null);
__d("DocumentEntityInstance",["ComposedEntityMutability","ComposedEntityType","arrayContains","getObjectValues","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){var l=j(h),m=j(g);function n(o,p,q){"use strict";k(i(l,o));k(i(m,p));this.$DocumentEntityInstance0=o;this.$DocumentEntityInstance1=p;this.$DocumentEntityInstance2=q;}n.prototype.getType=function(){"use strict";return this.$DocumentEntityInstance0;};n.prototype.getMutability=function(){"use strict";return this.$DocumentEntityInstance1;};n.prototype.getData=function(){"use strict";return this.$DocumentEntityInstance2;};n.prototype.replaceData=function(o){"use strict";this.$DocumentEntityInstance2=o;};e.exports=n;},null);
__d("DocumentEntity",["DocumentEntityInstance","invariant"],function(a,b,c,d,e,f,g,h){var i={},j=0,k={create:function(l,m,n){return k.add(new g(l,m,n));},add:function(l){i[++j]=l;return j.toString();},get:function(l){var m=i[l];h(!!m);return m;}};e.exports=k;},null);
__d("DocumentEntitySegmentsExperimental",["DocumentRemovalDirection"],function(a,b,c,d,e,f,g){var h=g.FORWARD,i={getRemovalRange:function(j,k,l,m,n){var o=l.split(' ');o=o.map(function(y,z){if(n===h){if(z>0)return ' '+y;}else if(z<o.length-1)return y+' ';return y;});var p=m,q,r,s=null,t=null;for(var u=0;u<o.length;u++){r=o[u];q=p+r.length;if(j<q&&p<k){if(s!==null){t=q;}else{s=p;t=q;}}else if(s!==null)break;p=q;}var v=m+l.length,w=s===m,x=t===v;if((!w&&x)||(w&&!x))if(n===h){if(t!==v)t++;}else if(s!==m)s--;return {start:s,end:t};}};e.exports=i;},null);
__d("ContentBlock",["ImmutableObject","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=i({KEY:true,TYPE:true,TEXT:true,INLINE_STYLES:true,ENTITIES:true});k.create=function(m){return new k(new g(l(m)));};k.set=function(m,n){return new k(g.set(m.getImmutable(),l(n)));};k.prototype.getKey=function(){return this.$ContentBlock0[j.KEY];};k.prototype.getType=function(){return this.$ContentBlock0[j.TYPE];};k.prototype.getText=function(){return this.$ContentBlock0[j.TEXT];};k.prototype.getLength=function(){return this.getText().length;};k.prototype.getInlineStyles=function(){return this.$ContentBlock0[j.INLINE_STYLES];};k.prototype.getEntities=function(){return this.$ContentBlock0[j.ENTITIES];};function k(m){this.$ContentBlock0=m;}k.prototype.getImmutable=function(){return this.$ContentBlock0;};function l(m){var n=m,o=n.key,p=n.type,q=n.text,r=n.inlineStyles,s=n.entities,t={};if(o!==undefined){h(typeof o==='string');t[j.KEY]=o;}if(p!==undefined){h(typeof p==='number');t[j.TYPE]=p;}if(q!==undefined){h(typeof q==='string');t[j.TEXT]=q;}if(r!==undefined){h(Array.isArray(r));t[j.INLINE_STYLES]=r;}if(s!==undefined){h(Array.isArray(s));t[j.ENTITIES]=s;}return t;}e.exports=k;},null);
__d("ImmutableMap",["Immutable","emptyFunction","invariant","keyOf"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=j({_DONT_EVER_TYPE_THIS_SECRET_KEY:null}),l='__size_DoNotEverTouchThis',m='__keyByIndexDoNotEverTouchThis',n='__indexByKeyDoNotEverTouchThis';function o(v){var w=isNaN(+v)||(v.substring&&v.substring(0,1)==='.'),x=v===m||v===n||v===l;return !x&&typeof v==='string'&&v!==''&&w;}function p(v,w,x){i(typeof v==='number'&&typeof w==='number'&&w>=0&&v>=0&&v+w<=x);}function q(v){return v instanceof g&&v.hasOwnProperty(l);}function r(v){i(q(v));}function s(v){return v===l||v===m||v===n;}function t(v,w,x,y){var z={enumerable:false,configurable:true,writable:true,value:w},aa={enumerable:false,configurable:true,writable:true,value:x},ba={enumerable:false,configurable:true,writable:true,value:y};Object.defineProperty(v,l,z);Object.defineProperty(v,m,aa);Object.defineProperty(v,n,ba);}var u={create:function(){var v=new g(g[k]),w=u.mergeAndValidateAllPropertiesInto(v,arguments);t(v,w,[],{});v[m].areComputed=false;return v;},mergeAndValidateAllPropertiesInto:function(v,w){var x=w.length,y=0;for(var z=0;z<x;z++){var aa=w[z];for(var ba in aa){if(!aa.hasOwnProperty(ba)||q(aa)&&s(ba))continue;if(!v.hasOwnProperty(ba)){i(o(ba));y++;}var ca=aa[ba];i(ca!==undefined);v[ba]=ca;}}return y;},customDeepFreezeRootNode:function(v){r(v);Object.freeze(v);for(var w in v){if(!v.hasOwnProperty(w)||s(w))continue;g.recurseDeepFreeze(v[w]);}Object.seal(v);},set:function(v,w){r(v);i(w instanceof g||(typeof w==='object'&&w!==undefined&&!Array.isArray(w)));return u.create(v,w);},fromArray:function(v,w){var x=Array.isArray(v),y=typeof w==='function';i(x);i(y);var z=new g(g[k]),aa=[],ba={};t(z,v.length,aa,ba);for(var ca=0;ca<v.length;ca++){var da=v[ca],ea=w(da,ca);i(!z.hasOwnProperty(ea));i(o(ea));z[ea]=da;aa[ca]=''+ea;ba[ea]=ca;}aa.areComputed=true;return z;},size:function(v){r(v);u._computePositionsIfNeeded(v);return v[l];},has:function(v,w){i(o(w));r(v);return v.hasOwnProperty(w);},get:function(v,w){i(o(w));return v.hasOwnProperty(w)?v[w]:undefined;},map:function(v,w,x){r(v);u._computePositionsIfNeeded(v);return u.mapRange(v,w,0,u.size(v),x);},mapRange:function(v,w,x,y,z){r(v);u._computePositionsIfNeeded(v);var aa={},ba=0;p(x,y,u.size(v));var ca=x+y-1;for(var da in v)if(v.hasOwnProperty(da)){if(ba>=x){if(ba>ca)break;aa[da]=w.call(z,v[da],da,ba);}ba++;}return u.create(aa);},filter:function(v,w,x){return u.filterRange(v,w,0,u.size(v),x);},filterRange:function(v,w,x,y,z){var aa={};u.forEachRange(v,function(ba,ca,da){if(w.call(z,ba,ca,da))aa[ca]=ba;},x,y);return u.create(aa);},forEach:function(v,w,x){u.forEachRange(v,w,0,u.size(v),x);},forEachRange:function(v,w,x,y,z){r(v);p(x,y,u.size(v));var aa=0,ba=x+y-1;for(var ca in v)if(v.hasOwnProperty(ca)){if(aa>=x){if(aa>ba)break;w.call(z,v[ca],ca,aa);}aa++;}},mapKeyRange:function(v,w,x,y,z){var aa=u.indexOfKey(v,x),ba=u.indexOfKey(v,y);i(aa!=null&&ba!=null);i(ba>=aa);var ca=(ba-aa)+1;return u.mapRange(v,w,aa,ca,z);},forEachKeyRange:function(v,w,x,y,z){var aa=u.indexOfKey(v,x),ba=u.indexOfKey(v,y);i(aa!=null&&ba!=null);i(ba>=aa);var ca=(ba-aa)+1;u.forEachRange(v,w,aa,ca,z);},keyAtIndex:function(v,w){u._computePositionsIfNeeded(v);var x=v[m][w];return x?x:undefined;},valueAtIndex:function(v,w){var x=u.keyAtIndex(v,w);return x!==undefined?v[x]:undefined;},keyAfter:function(v,w){return u.nthKeyAfter(v,w,1);},keyBefore:function(v,w){return u.nthKeyBefore(v,w,1);},nthKeyAfter:function(v,w,x){var y=u.indexOfKey(v,w);i(y!==undefined);return u.keyAtIndex(v,y+x);},nthKeyBefore:function(v,w,x){return u.nthKeyAfter(v,w,-x);},indexOfKey:function(v,w){i(o(w));u._computePositionsIfNeeded(v);var x=v[n][w];return x===undefined?undefined:x;},slice:function(v,w,x){return u.mapRange(v,h.thatReturnsArgument,w,x);},sliceByKey:function(v,w,x){var y=u.indexOfKey(v,w),z=u.indexOfKey(v,x);i(y!=null&&z!=null);i(z>=y);var aa=(z-y)+1;return u.slice(v,y,aa);},toArray:function(v){var w=0,x=u.size(v),y=[];for(var z in v)if(v.hasOwnProperty(z)){if(w>x)break;y.push(v[z]);w++;}return y;},_computePositionsIfNeeded:function(v){if(v[m].areComputed===false)u._computePositionsFromDictionary(v);},_computePositionsFromDictionary:function(v){var w=v[m],x=v[n],y=0;for(var z in v)if(v.hasOwnProperty(z)){w[y]=z;x[z]=y;y++;}v[m].areComputed=true;}};e.exports=u;},null);
__d("SelectionState",["ImmutableObject","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=i({ANCHOR_KEY:true,ANCHOR_OFFSET:true,FOCUS_KEY:true,FOCUS_OFFSET:true,IS_BACKWARD:true,HAS_FOCUS:true});k.create=function(m){return new k(new g(l(m)));};k.set=function(m,n){return new k(g.set(m.getImmutable(),l(n)));};k.prototype.getAnchorKey=function(){return this.$SelectionState0[j.ANCHOR_KEY];};k.prototype.getAnchorOffset=function(){return this.$SelectionState0[j.ANCHOR_OFFSET];};k.prototype.getFocusKey=function(){return this.$SelectionState0[j.FOCUS_KEY];};k.prototype.getFocusOffset=function(){return this.$SelectionState0[j.FOCUS_OFFSET];};k.prototype.isBackward=function(){return this.$SelectionState0[j.IS_BACKWARD];};k.prototype.hasFocus=function(){return this.$SelectionState0[j.HAS_FOCUS];};k.prototype.hasEdgeWithin=function(m,n,o){var p=this.getAnchorKey(),q=this.getFocusKey();if(p===q&&p===m){var r=this.getStartOffset(),s=this.getEndOffset();return n<=s&&r<=o;}var t;if(m===p){t=this.getAnchorOffset();}else if(m===q){t=this.getFocusOffset();}else return false;return n<=t&&o>=t;};k.prototype.isCollapsed=function(){return (this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset());};k.prototype.getStartKey=function(){return this.isBackward()?this.getFocusKey():this.getAnchorKey();};k.prototype.getStartOffset=function(){return this.isBackward()?this.getFocusOffset():this.getAnchorOffset();};k.prototype.getEndKey=function(){return this.isBackward()?this.getAnchorKey():this.getFocusKey();};k.prototype.getEndOffset=function(){return this.isBackward()?this.getAnchorOffset():this.getFocusOffset();};function k(m){this.$SelectionState0=m;}k.prototype.getImmutable=function(){return this.$SelectionState0;};function l(m){var n=m,o=n.anchorKey,p=n.anchorOffset,q=n.focusKey,r=n.focusOffset,s=n.isBackward,t=n.hasFocus,u={};if(o!==undefined){h(typeof o==='string');u[j.ANCHOR_KEY]=o;}if(p!==undefined){h(typeof p==='number');u[j.ANCHOR_OFFSET]=p;}if(q!==undefined){h(typeof q==='string');u[j.FOCUS_KEY]=q;}if(r!==undefined){h(typeof r==='number');u[j.FOCUS_OFFSET]=r;}if(s!==undefined){h(typeof s==='boolean');u[j.IS_BACKWARD]=s;}if(t!==undefined){h(typeof t==='boolean');u[j.HAS_FOCUS]=t;}return u;}e.exports=k;},null);
__d("ContentState",["DocumentCharacters","Immutable","ImmutableMap","ImmutableObject","SelectionState","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";var n=g.SOFT_NEWLINE,o=m({BLOCK_MAP:true,TREE_MAP:true,SELECTION_BEFORE:true,SELECTION_AFTER:true});p.create=function(r){return new p(new j(q(r)));};p.set=function(r,s){return new p(j.set(r.getImmutable(),q(s)));};p.prototype.getBlockMap=function(){return this.$ContentState0[o.BLOCK_MAP];};p.prototype.getTreeMap=function(){return this.$ContentState0[o.TREE_MAP];};p.prototype.getSelectionBefore=function(){return this.$ContentState0[o.SELECTION_BEFORE];};p.prototype.getSelectionAfter=function(){return this.$ContentState0[o.SELECTION_AFTER];};p.prototype.getBlockForKey=function(r){return i.get(this.getBlockMap(),r)||null;};p.prototype.getKeyBefore=function(r){return i.keyBefore(this.getBlockMap(),r)||null;};p.prototype.getKeyAfter=function(r){return i.keyAfter(this.getBlockMap(),r)||null;};p.prototype.getBlockAfter=function(r){var s=this.getKeyAfter(r);return s?i.get(this.getBlockMap(),s):null;};p.prototype.getBlockBefore=function(r){var s=this.getKeyBefore(r);return s?i.get(this.getBlockMap(),s):null;};p.prototype.getBlocksAsArray=function(){return i.toArray(this.getBlockMap());};p.prototype.getLastBlock=function(){var r=this.getBlockMap(),s=i.size(r);return i.valueAtIndex(r,s-1);};p.prototype.getPlainText=function(){return i.toArray(i.map(this.getBlockMap(),function(r,s){return r.getText();})).join(n);};p.prototype.hasText=function(){var r=this.getBlockMap(),s=i.valueAtIndex(r,0);return !(i.size(r)===1&&s.getText().length===0);};function p(r){this.$ContentState0=r;}p.prototype.getImmutable=function(){return this.$ContentState0;};function q(r){var s=r,t=s.blockMap,u=s.treeMap,v=s.selectionBefore,w=s.selectionAfter,x={};if(t!==undefined){l(t instanceof h);x[o.BLOCK_MAP]=t;}if(u!==undefined){l(u instanceof h);x[o.TREE_MAP]=u;}if(v!==undefined){l(v instanceof k);x[o.SELECTION_BEFORE]=v;}if(w!==undefined){l(w instanceof k);x[o.SELECTION_AFTER]=w;}return x;}e.exports=p;},null);
__d("ContentStateInlineStyle",["ContentBlock","ContentState","ImmutableMap","areEqual"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={add:function(m,n,o){return l(m,n,o,true);},remove:function(m,n,o){return l(m,n,o,false);}};function l(m,n,o,p){var q=m.getBlockMap(),r=n.getStartKey(),s=n.getStartOffset(),t=n.getEndKey(),u=n.getEndOffset(),v=i.mapKeyRange(q,function(w,x){var y,z;if(r===t){y=s;z=u;}else{y=x===r?s:0;z=x===t?0:w.getLength();}var aa=w.getInlineStyles(),ba=aa.slice(y,z),ca=ba.map(function(ea){return (p?ea|o:ea&(~o));});if(j(ca,ba))return w;var da=aa.slice(0,y).concat(ca,aa.slice(z,w.getLength()));return g.set(w,{inlineStyles:da});},r,t);return h.set(m,{blockMap:i.set(q,v),selectionBefore:n,selectionAfter:n});}e.exports=k;},null);
__d("applyEntityToContentState",["ContentState","ImmutableMap","applyEntityToContentBlock"],function(a,b,c,d,e,f,g,h,i){function j(k,l,m){var n=k.getBlockMap(),o=l.getStartKey(),p=l.getStartOffset(),q=l.getEndKey(),r=l.getEndOffset(),s=h.mapKeyRange(n,function(t,u){var v,w;if(o===q){v=p;w=r;}else{v=u===o?p:0;w=u===q?0:t.getLength();}return i(t,v,w,m);},o,q);return g.set(k,{blockMap:h.set(n,s),selectionBefore:l,selectionAfter:l});}e.exports=j;},null);
__d("findRanges",[],function(a,b,c,d,e,f){function g(h,i,j){var k=0,l=0,m;for(var n=0;n<h.length;n++){l++;m=h[n];if(m!==h[n+1]){if(i(m))j(k,l);k=l;}}}e.exports=g;},null);
__d("getRangesForDocumentEntityExperimental",["findRanges","invariant"],function(a,b,c,d,e,f,g,h){function i(j,k){var l=[];g(j,function(m){return m===k;},function(m,n){l.push({start:m,end:n});});h(!!l.length);return l;}e.exports=i;},null);
__d("getCharacterRemovalRangeExperimental",["ComposedEntityMutability","DocumentEntity","DocumentEntitySegmentsExperimental","SelectionState","checkRangeOverlap","getRangesForDocumentEntityExperimental","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=g.MUTABLE,o=g.IMMUTABLE;function p(q,r,s){var t=r.getStartOffset(),u=r.getEndOffset(),v=q.getEntities(),w=v[t];if(!w)return r;var x=h.get(w),y=x.getMutability();if(y===n)return r;var z=l(v,w).filter(function(ca){return k(t,u,ca.start,ca.end);});m(z.length==1);var aa=z[0];if(y===o)return j.set(r,{anchorOffset:aa.start,focusOffset:aa.end,isBackward:false});var ba=i.getRemovalRange(t,u,q.getText().slice(aa.start,aa.end),aa.start,s);return j.set(r,{anchorOffset:ba.start,focusOffset:ba.end,isBackward:false});}e.exports=p;},null);
__d("generateBlockKey",[],function(a,b,c,d,e,f){var g={},h=Math.pow(2,24);function i(){var j;while(j===undefined||g.hasOwnProperty(j)||!isNaN(+j))j=Math.floor(Math.random()*h).toString(32);g[j]=true;return j;}e.exports=i;},null);
__d("insertFragmentIntoContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","generateBlockKey","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(n,o,p){l(o.isCollapsed());var q=o.getStartKey(),r=o.getStartOffset(),s=n.getBlockMap(),t=i.size(p),u,v;if(t===1){var w=i.get(s,q),x=i.valueAtIndex(p,0),y=w.getText(),z=w.getInlineStyles(),aa=w.getEntities(),ba=g.set(w,{text:(y.slice(0,r)+x.getText()+y.slice(r)),inlineStyles:(z.slice(0,r).concat(x.getInlineStyles(),z.slice(r))),entities:(aa.slice(0,r).concat(x.getEntities(),aa.slice(r)))}),ca={};ca[q]=ba;u=q;v=r+x.getText().length;return h.set(n,{blockMap:i.set(s,ca),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:u,anchorOffset:v,focusKey:u,focusOffset:v,isBackward:false})});}var da=[];i.forEach(n.getBlockMap(),function(fa,ga){if(ga!==q){da.push(fa);return;}var ha=fa.getText(),ia=fa.getInlineStyles(),ja=fa.getEntities(),ka=ha.length,la=ha.slice(0,r),ma=ia.slice(0,r),na=ja.slice(0,r),oa=i.valueAtIndex(p,0),pa=g.set(fa,{text:la+oa.getText(),inlineStyles:ma.concat(oa.getInlineStyles()),entities:na.concat(oa.getEntities())});da.push(pa);i.forEach(i.slice(p,1,t-2),function(va){da.push(g.set(va,{key:k()}));});var qa=ha.slice(r,ka),ra=ia.slice(r,ka),sa=ja.slice(r,ka),ta=i.valueAtIndex(p,t-1);u=k();var ua=g.set(ta,{key:u,text:ta.getText()+qa,inlineStyles:ta.getInlineStyles().concat(ra),entities:ta.getEntities().concat(sa)});da.push(ua);});var ea=i.valueAtIndex(p,t-1);v=ea.getText().length;return h.set(n,{blockMap:i.fromArray(da,function(fa){return fa.getKey();}),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:u,anchorOffset:v,focusKey:u,focusOffset:v,isBackward:false})});}e.exports=m;},null);
__d("insertTextIntoContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(m,n,o,p,q){k(n.isCollapsed());var r=o.length;k(r===p.length&&r===q.length);if(!o.length)return m;var s=m.getBlockMap(),t=n.getStartKey(),u=n.getStartOffset(),v=i.get(s,t),w=v.getText(),x=v.getInlineStyles(),y=v.getEntities(),z=w.length,aa=g.set(v,{text:(w.slice(0,u)+o+w.slice(u,z)),inlineStyles:x.slice(0,u).concat(p,x.slice(u,z)),entities:y.slice(0,u).concat(q,y.slice(u,z))}),ba={};ba[t]=aa;var ca=u+r;return h.set(m,{blockMap:i.set(s,ba),selectionAfter:j.set(n,{anchorOffset:ca,focusOffset:ca})});}e.exports=l;},null);
__d("removeEntitiesAtEdges",["ContentBlock","ContentState","ComposedEntityMutability","DocumentEntity","ImmutableMap","fillArray","findRanges","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=i.MUTABLE;function p(s,t){var u=s.getBlockMap(),v={},w=t.getStartKey(),x=t.getStartOffset(),y=k.get(u,w),z=r(y,x);if(z)v[w]=z;var aa=t.getEndKey(),ba=t.getEndOffset(),ca=k.get(u,aa);if(w===aa&&z)ca=z;var da=r(ca,ba);if(da)v[aa]=da;if(n(v))return h.set(s,{selectionAfter:t});return h.set(s,{blockMap:k.set(u,v),selectionAfter:t});}function q(s,t,u){var v;m(s,function(w){return w===t;},function(w,x){if(w<=u&&x>=u)v={start:w,end:x};});return v;}function r(s,t){var u=s.getEntities(),v=u[t-1],w=u[t];if(w&&w===v){var x=j.get(w);if(x.getMutability()!==o){var y=q(u,w,t);return g.set(s,{entities:u.slice(0,y.start).concat(l(y.end-y.start,null),u.slice(y.end))});}}return null;}e.exports=p;},null);
__d("removeRangeFromContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){if(m.isCollapsed())return l;var n=l.getBlockMap(),o=m.getStartKey(),p=m.getStartOffset(),q=i.indexOfKey(n,o),r=m.getEndKey(),s=m.getEndOffset(),t=i.indexOfKey(n,r),u=i.map(n,function(v,w,x){if(x<q||x>t)return v;if(x>q&&x<=t)return null;var y=i.get(n,r),z=y.getText(),aa=y.getInlineStyles(),ba=y.getEntities(),ca=z.length,da=v.getText(),ea=v.getInlineStyles(),fa=v.getEntities();return g.set(v,{text:(da.slice(0,p)+z.slice(s,ca)),inlineStyles:ea.slice(0,p).concat(aa.slice(s,ca)),entities:fa.slice(0,p).concat(ba.slice(s,ca))});});return h.set(l,{blockMap:i.filter(u,function(v){return !!v;}),selectionBefore:m,selectionAfter:j.set(m,{anchorKey:o,anchorOffset:p,focusKey:o,focusOffset:p,isBackward:false})});}e.exports=k;},null);
__d("setBlockTypeForContentState",["ContentBlock","ContentState","ImmutableMap"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(k,l,m){var n=k.getBlockMap(),o=i.mapKeyRange(n,function(p,q){return g.set(p,{type:m});},l.getStartKey(),l.getEndKey());return h.set(k,{blockMap:i.set(n,o),selectionBefore:l,selectionAfter:l});}e.exports=j;},null);
__d("splitBlockInContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","generateBlockKey","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(n,o){l(o.isCollapsed());var p=o.getAnchorKey(),q=o.getAnchorOffset(),r=n.getBlockMap(),s=i.get(r,p),t=s.getText(),u=s.getInlineStyles(),v=s.getEntities(),w=g.set(s,{text:t.slice(0,q),inlineStyles:u.slice(0,q),entities:v.slice(0,q)}),x=k(),y=g.set(w,{key:x,text:t.slice(q),inlineStyles:u.slice(q),entities:v.slice(q)}),z=[];i.forEach(r,function(aa,ba){if(ba===p){z.push(w);z.push(y);}else z.push(aa);});return h.set(n,{blockMap:i.fromArray(z,function(aa){return aa.getKey();}),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:x,anchorOffset:0,focusKey:x,focusOffset:0,isBackward:false})});}e.exports=m;},null);
__d("DocumentModifierExperimental",["ContentStateInlineStyle","applyEntityToContentState","fillArray","getCharacterRemovalRangeExperimental","insertFragmentIntoContentState","insertTextIntoContentState","invariant","removeEntitiesAtEdges","removeRangeFromContentState","setBlockTypeForContentState","splitBlockInContentState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";var r={replaceText:function(s,t,u,v,w){var x=n(s,t),y=o(x,t);return l(y,y.getSelectionAfter(),u,i(u.length,v),i(u.length,w));},insertText:function(s,t,u,v,w){m(t.isCollapsed());var x=n(s,t);return l(x,x.getSelectionAfter(),u,i(u.length,v),i(u.length,w));},replaceWithFragment:function(s,t,u){var v=n(s,t),w=o(v,t);return k(w,w.getSelectionAfter(),u);},removeRange:function(s,t,u){if(t.getAnchorKey()===t.getFocusKey()){var v=t.getAnchorKey(),w=t.getStartOffset(),x=t.getEndOffset(),y=s.getBlockForKey(v),z=y.getEntities(),aa=z[w],ba=z[x-1];if(aa&&aa===ba){var ca=j(y,t,u);return o(s,ca);}}var da=n(s,t);return o(da,t);},splitBlock:function(s,t){var u=n(s,t),v=o(u,t);return q(v,v.getSelectionAfter());},applyInlineStyle:function(s,t,u){return g.add(s,t,u);},removeInlineStyle:function(s,t,u){return g.remove(s,t,u);},setBlockType:function(s,t,u){return p(s,t,u);},applyEntity:function(s,t,u){var v=n(s,t);return h(v,t,u);}};e.exports=r;},null);
__d("DocumentOffsetKey",[],function(a,b,c,d,e,f){var g='-',h={encode:function(i,j,k){return i+g+j+g+k;},decode:function(i){var j=i.split(g),k=j[0],l=j[1],m=j[2];return {blockKey:k,decoratorKey:l,leafKey:m};}};e.exports=h;},null);
__d("BlockTree",["emptyFunction","fillArray","findRanges"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=g.thatReturnsTrue,k='-',l={generate:function(n,o){var p=n.getText().length;if(!p)return [{start:0,end:0,decoratorKey:null,leaves:[{start:0,end:0}]}];var q=[],r=o?o.getDecorations(n):h(p,null),s=n.getInlineStyles();i(r,j,function(t,u){q.push({start:t,end:u,decoratorKey:r[t],leaves:m(s.slice(t,u),t)});});return q;},getFingerprint:function(n){return n.map(function(o){var p=o.decoratorKey,q=p!==null?p+'.'+(o.end-o.start):'';return ''+q+'.'+o.leaves.length;}).join(k);}};function m(n,o){var p=[];i(n,j,function(q,r){p.push({start:q+o,end:r+o});});return p;}e.exports=l;},null);
__d("createEmptySelectionState",["SelectionState"],function(a,b,c,d,e,f,g){"use strict";function h(i){return g.create({anchorKey:i,anchorOffset:0,focusKey:i,focusOffset:0,isBackward:false,hasFocus:false});}e.exports=h;},null);
__d("createContentStateFromBlocks",["BlockTree","ContentState","ImmutableMap","createEmptySelectionState"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){var n=i.fromArray(l,function(q){return q.getKey();}),o=i.keyAtIndex(n,0),p=j(o);return h.create({blockMap:n,treeMap:i.map(n,function(q){return g.generate(q,m);}),selectionBefore:p,selectionAfter:p});}e.exports=k;},null);
__d("EditorChangeType",["keyMirror"],function(a,b,c,d,e,f,g){"use strict";var h=g({UNDO:true,REDO:true,CHANGE_SELECTION:true,INSERT_CHARACTERS:true,BACKSPACE_CHARACTER:true,DELETE_CHARACTER:true,REMOVE_RANGE:true,SPLIT_BLOCK:true,INSERT_FRAGMENT:true,CHANGE_INLINE_STYLE:true,CHANGE_BLOCK_TYPE:true,APPLY_ENTITY:true});e.exports=h;},null);
__d("generateContentStateKey",[],function(a,b,c,d,e,f){var g=0;function h(){return 'state-'+(++g);}e.exports=h;},null);
__d("EditorState",["BlockTree","ComposedInlineStyle","ContentState","DocumentCompositeDecorator.Experimental","EditorChangeType","Immutable","ImmutableMap","ImmutableObject","SelectionState","generateContentStateKey","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=r({CURRENT_KEY:true,BOUNDARY_KEY:true,DECORATOR:true,STACK:true,SELECTION:true,FORCE_SELECTION:true,LAST_CHANGE_TYPE:true,NATIVELY_RENDERED_KEY:true,IN_COMPOSITION_MODE:true,INLINE_STYLE_OVERRIDE:true});t.create=function(y){return new t(new n(u(y)));};t.set=function(y,z){return new t(n.set(y.getImmutable(),u(z)));};t.prototype.getCurrentKey=function(){return this.$EditorState0[s.CURRENT_KEY];};t.prototype.getBoundaryKey=function(){return this.$EditorState0[s.BOUNDARY_KEY];};t.prototype.getStack=function(){return this.$EditorState0[s.STACK];};t.prototype.getSelection=function(){return this.$EditorState0[s.SELECTION];};t.prototype.getDecorator=function(){return this.$EditorState0[s.DECORATOR];};t.prototype.isInCompositionMode=function(){return this.$EditorState0[s.IN_COMPOSITION_MODE];};t.prototype.mustForceSelection=function(){return this.$EditorState0[s.FORCE_SELECTION];};t.prototype.getNativelyRenderedKey=function(){return this.$EditorState0[s.NATIVELY_RENDERED_KEY];};t.prototype.getLastChangeType=function(){return this.$EditorState0[s.LAST_CHANGE_TYPE];};t.prototype.getCurrentContent=function(){return m.get(this.getStack(),this.getCurrentKey());};t.prototype.getInlineStyleOverride=function(){return this.$EditorState0[s.INLINE_STYLE_OVERRIDE];};t.prototype.getCurrentInlineStyle=function(){var y=this.getInlineStyleOverride();if(y!==null)return y;var z=this.getSelection(),aa=this.getCurrentContent();if(z.isCollapsed()){var ba=z.getStartOffset(),ca=aa.getBlockForKey(z.getStartKey()),da=ca.getInlineStyles();if(ba>0)return da[ba-1];if(ca.getLength())return da[0];}return x(aa,z);};t.prototype.isAtDocumentStart=function(){var y=this.getSelection(),z=this.getCurrentContent(),aa=z.getBlockMap(),ba=m.keyAtIndex(aa,0);return y.hasEdgeWithin(ba,0,0);};t.prototype.isAtDocumentEnd=function(){var y=this.getSelection(),z=this.getCurrentContent(),aa=z.getBlockMap(),ba=m.keyAtIndex(aa,m.size(aa)-1),ca=m.get(aa,ba),da=ca.getText().length;return y.hasEdgeWithin(ba,da,da);};t.updateSelection=function(y,z,aa){return t.set(y,{selection:z,forceSelection:aa,nativelyRenderedKey:null,inlineStyleOverride:null});};t.moveFocusToEnd=function(y){var z=y.getCurrentContent(),aa=z.getLastBlock(),ba=aa.getKey(),ca=aa.getLength();return t.updateSelection(y,o.create({anchorKey:ba,anchorOffset:ca,focusKey:ba,focusOffset:ca,isBackward:false,hasFocus:true}),true);};t.push=function(y,z,aa){if(y.getCurrentContent()===z)return y;var ba=y.getStack(),ca=y.getBoundaryKey(),da=y.getCurrentKey(),ea=y.getCurrentContent(),fa=y.getSelection(),ga=aa!==k.INSERT_CHARACTERS;if(fa!==ea.getSelectionAfter()||w(y,aa)){ca=da;z=i.set(z,{selectionBefore:fa});}else if(aa===k.INSERT_CHARACTERS||aa===k.BACKSPACE_CHARACTER||aa===k.DELETE_CHARACTER)z=i.set(z,{selectionBefore:ea.getSelectionBefore()});var ha=m.indexOfKey(ba,ca)+1,ia=m.slice(ba,0,ha),ja=p(),ka={};ka[ja]=v(ea,z,y.getDecorator());var la=m.set(ia,ka);return t.set(y,{stack:la,boundaryKey:ca,currentKey:ja,lastChangeType:aa,selection:z.getSelectionAfter(),forceSelection:ga,inlineStyleOverride:null});};t.undo=function(y){var z=y.getBoundaryKey(),aa=y.getCurrentKey(),ba=y.getStack(),ca=y.getCurrentContent();if(z===aa){var da=m.nthKeyBefore(ba,z,1);if(da===undefined)return y;return t.set(y,{boundaryKey:da,currentKey:da,selection:ca.getSelectionBefore(),lastChangeType:k.UNDO,forceSelection:true,nativelyRenderedKey:null,inlineStyleOverride:null});}return t.set(y,{stack:ba,currentKey:z,selection:ca.getSelectionBefore(),lastChangeType:k.UNDO,forceSelection:true,nativelyRenderedKey:null,inlineStyleOverride:null});};t.redo=function(y){var z=y.getStack(),aa=m.nthKeyAfter(z,y.getBoundaryKey(),1);if(aa===undefined)return y;var ba=m.get(z,aa);return t.set(y,{boundaryKey:aa,currentKey:aa,selection:ba.getSelectionAfter(),lastChangeType:k.REDO,forceSelection:true,nativelyRenderedKey:null,inlineStyleOverride:null});};function t(y){this.$EditorState0=y;}t.prototype.getImmutable=function(){return this.$EditorState0;};function u(y){var z=y,aa=z.stack,ba=z.currentKey,ca=z.boundaryKey,da=z.decorator,ea=z.selection,fa=z.forceSelection,ga=z.lastChangeType,ha=z.nativelyRenderedKey,ia=z.inCompositionMode,ja=z.inlineStyleOverride,ka={};if(aa!==undefined){q(aa instanceof l);ka[s.STACK]=aa;}if(ba!==undefined){q(typeof ba==='string');ka[s.CURRENT_KEY]=ba;}if(ca!==undefined){q(typeof ca==='string');ka[s.BOUNDARY_KEY]=ca;}if(da!==undefined){q(da instanceof j);ka[s.DECORATOR]=da;}if(ea!==undefined){q(ea instanceof o);ka[s.SELECTION]=ea;}if(fa!==undefined){q(typeof fa==='boolean');ka[s.FORCE_SELECTION]=fa;}if(ga!==undefined){q(typeof ga==='string'||ga===null);ka[s.LAST_CHANGE_TYPE]=ga;}if(ha!==undefined){q(typeof ha==='string'||ha===null);ka[s.NATIVELY_RENDERED_KEY]=ha;}if(ia!==undefined){q(typeof ia==='boolean');ka[s.IN_COMPOSITION_MODE]=ia;}if(ja!==undefined){q(typeof ja==='number'||ja===null);ka[s.INLINE_STYLE_OVERRIDE]=ja;}return ka;}function v(y,z,aa){var ba=y.getBlockMap(),ca=z.getBlockMap(),da=m.map(ca,function(ea,fa){if(m.get(ca,fa)===m.get(ba,fa))return m.get(y.getTreeMap(),fa);return g.generate(m.get(ca,fa),aa);});return i.set(z,{treeMap:da});}function w(y,z){var aa=y.getLastChangeType();return (z!==aa||(z!==k.INSERT_CHARACTERS&&z!==k.BACKSPACE_CHARACTER&&z!==k.DELETE_CHARACTER));}function x(y,z){var aa=z.getStartKey(),ba=z.getStartOffset();if(ba>0){var ca=y.getBlockForKey(aa);return ca.getInlineStyles()[ba];}var da=y.getBlockBefore(aa),ea;while(da){ea=da.getLength();if(ea)return da.getInlineStyles()[ea-1];da=y.getBlockBefore(da.getKey());}return h.NONE;}e.exports=t;},null);
__d("createInitialEditorState",["EditorState","ImmutableMap","createEmptySelectionState","generateContentStateKey"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){var n=h.fromArray([l],function(){return j();}),o=h.keyAtIndex(n,0),p=l.getBlockMap(),q=h.keyAtIndex(p,0);return g.create({stack:n,currentKey:o,boundaryKey:o,decorator:m,selection:i(q),forceSelection:false,lastChangeType:null,nativelyRenderedKey:null,inCompositionMode:false});}e.exports=k;},null);
__d("createPlainBlocksFromText",["ComposedBlockType","ComposedInlineStyle","ContentBlock","fillArray","generateBlockKey"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){return m.map(function(n){var o=n.length;return i.create({key:k(),text:n,type:g.UNSTYLED,inlineStyles:j(o,h.NONE),entities:j(o,null)});});}e.exports=l;},null);
__d("isSelectionAtLeafStartExperimental",[],function(a,b,c,d,e,f){"use strict";function g(h){var i=h.getCurrentContent(),j=h.getSelection(),k=j.getAnchorKey(),l=i.getTreeMap()[k],m=j.getStartOffset(),n,o,p;for(var q=0;q<l.length;q++){n=l[q];if(m===n.start)return true;if(m<n.end){o=n.leaves;for(var r=0;r<o.length;r++){p=o[r].start;if(m===p)return true;if(m<p)return false;}}}return false;}e.exports=g;},null);
__d("DocumentRemovableWord",["TokenizeUtil"],function(a,b,c,d,e,f,g){var h=g.getPunctuation();h=h.replace("\'","").slice(1,-1);var i='\\s'+h,j='^('+'['+i+']*'+'[^'+i+']+'+'|['+i+']+'+')',k=new RegExp(j),l='('+'[^'+i+']+'+'['+i+']*'+'|['+i+']+'+')$',m=new RegExp(l);function n(p,q){var r=q?m.exec(p):k.exec(p);return r?r[0]:null;}var o={getBackward:function(p){return n(p,true);},getForward:function(p){return n(p,false);}};e.exports=o;},null);
__d("DocumentSelectionState",["mixInEventEmitter"],function(a,b,c,d,e,f,g){function h(i,j){"use strict";this.$DocumentSelectionState0=i;this.$DocumentSelectionState1=j;this.$DocumentSelectionState2=false;}h.prototype.update=function(i,j){"use strict";if(this.$DocumentSelectionState0!==i||this.$DocumentSelectionState1!==j){this.$DocumentSelectionState0=i;this.$DocumentSelectionState1=j;this.emit('update');}};h.prototype.constrainLength=function(i){"use strict";this.update(Math.min(this.$DocumentSelectionState0,i),Math.min(this.$DocumentSelectionState1,i));};h.prototype.focus=function(){"use strict";if(!this.$DocumentSelectionState2){this.$DocumentSelectionState2=true;this.emit('focus');}};h.prototype.blur=function(){"use strict";if(this.$DocumentSelectionState2){this.$DocumentSelectionState2=false;this.emit('blur');}};h.prototype.hasFocus=function(){"use strict";return this.$DocumentSelectionState2;};h.prototype.isCollapsed=function(){"use strict";return this.$DocumentSelectionState0===this.$DocumentSelectionState1;};h.prototype.isBackward=function(){"use strict";return this.$DocumentSelectionState0>this.$DocumentSelectionState1;};h.prototype.getAnchorOffset=function(){"use strict";return this.$DocumentSelectionState2?this.$DocumentSelectionState0:null;};h.prototype.getFocusOffset=function(){"use strict";return this.$DocumentSelectionState2?this.$DocumentSelectionState1:null;};h.prototype.getStartOffset=function(){"use strict";return (this.$DocumentSelectionState2?Math.min(this.$DocumentSelectionState0,this.$DocumentSelectionState1):null);};h.prototype.getEndOffset=function(){"use strict";return (this.$DocumentSelectionState2?Math.max(this.$DocumentSelectionState0,this.$DocumentSelectionState1):null);};h.prototype.overlaps=function(i,j){"use strict";return (this.hasFocus()&&this.getStartOffset()<=j&&i<=this.getEndOffset());};g(h,{blur:true,focus:true,update:true});e.exports=h;},null);
__d("getSelectionOffsetKeyForNode",[],function(a,b,c,d,e,f){function g(h){return h.getAttribute&&h.getAttribute('data-offset-key');}e.exports=g;},null);
__d("findAncestorOffsetKey",["getSelectionOffsetKeyForNode"],function(a,b,c,d,e,f,g){function h(i){while(i&&i!==document.documentElement){var j=g(i);if(j!=null)return j;i=i.parentNode;}return null;}e.exports=h;},null);
__d("getDocumentSelectionExperimental",["DocumentOffsetKey","ImmutableMap","SelectionState","findAncestorOffsetKey","getSelectionOffsetKeyForNode","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(r,s){var t=a.getSelection();if(t.rangeCount===0)return {selectionState:i.set(r.getSelection(),{hasFocus:false}),needsRecovery:false};var u=t.anchorNode,v=t.focusNode,w=t.anchorOffset,x=t.focusOffset,y=u.nodeType===Node.TEXT_NODE,z=v.nodeType===Node.TEXT_NODE;if(y&&z)return {selectionState:q(r,j(u),w,j(v),x),needsRecovery:false};var aa=null,ba=null;if(y){aa={key:j(u),offset:w};ba=p(s,v,x);}else if(z){ba={key:j(v),offset:x};aa=p(s,u,w);}else{aa=p(s,u,w);ba=p(s,v,x);}return {selectionState:q(r,aa.key,aa.offset,ba.key,ba.offset),needsRecovery:true};}function n(r){while(r.firstChild&&k(r.firstChild))r=r.firstChild;return r;}function o(r){while(r.lastChild&&k(r.lastChild))r=r.lastChild;return r;}function p(r,s,t){var u=j(s);l(u!=null||r===s);if(t===0)return {key:u||k(n(s)),offset:0};var v=s.childNodes[t-1],w,x;if(!k(v)){w=u;x=v.textContent.length;}else{var y=o(v);w=k(y);x=y.textContent.length;}return {key:w,offset:x};}function q(r,s,t,u,v){var w=r.getSelection(),x=r.getCurrentContent(),y=x.getTreeMap(),z=g.decode(s),aa=z.blockKey,ba=y[aa],ca=ba[z.decoratorKey].leaves,da=ca[z.leafKey],ea=g.decode(u),fa=ea.blockKey,ga=y[fa],ha=ga[ea.decoratorKey].leaves,ia=ha[ea.leafKey],ja=da?da.start+t:null,ka=ia?ia.start+v:null,la=(w.getAnchorKey()===aa&&w.getAnchorOffset()===ja&&w.getFocusKey()===fa&&w.getFocusOffset()===ka);if(la)return w;var ma=false;if(aa===fa){if(ia===da){ma=v<t;}else ma=ia.start<da.start;}else{var na=h.indexOfKey(y,aa),oa=h.indexOfKey(y,fa);ma=oa<na;}return i.set(w,{anchorKey:aa,anchorOffset:ja,focusKey:fa,focusOffset:ka,isBackward:ma});}e.exports=m;},null);
__d("setDocumentSelectionExperimental",[],function(a,b,c,d,e,f){"use strict";function g(j,k,l,m,n){var o=a.getSelection(),p=j.getAnchorKey(),q=j.getAnchorOffset(),r=j.getFocusKey(),s=j.getFocusOffset();if(!o.extend&&j.isBackward()){var t=p,u=q;p=r;q=s;r=t;s=u;}var v=(p===l&&m<=q&&n>=q),w=(r===l&&m<=s&&n>=s);if(v&&w){o.removeAllRanges();i(o,k,q-m);h(o,k,s-m);return;}if(!j.isBackward()){if(v){o.removeAllRanges();i(o,k,q-m);}if(w)h(o,k,s-m);}else{if(w){o.removeAllRanges();i(o,k,s-m);}if(v){var x=o.focusNode,y=o.focusOffset;o.removeAllRanges();i(o,k,q-m);h(o,x,y);}}}function h(j,k,l){if(j.extend){j.extend(k,l);}else{var m=j.getRangeAt(0);m.setEnd(k,l);j.addRange(m.cloneRange());}}function i(j,k,l){var m=document.createRange();m.setStart(k,l);j.addRange(m);}e.exports=g;},null);
__d("getContentStateFragment",["ContentBlock","ImmutableMap","generateBlockKey","removeEntitiesAtEdges"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){var n=m.getStartKey(),o=m.getStartOffset(),p=m.getEndKey(),q=m.getEndOffset(),r=j(l,m),s=r.getBlockMap();return h.mapKeyRange(s,function(t,u){var v=i(),w=t.getText(),x=t.getInlineStyles(),y=t.getEntities();if(n===p)return g.set(t,{key:v,text:w.slice(o,q),inlineStyles:x.slice(o,q),entities:y.slice(o,q)});if(u===n)return g.set(t,{key:v,text:w.slice(o),inlineStyles:x.slice(o),entities:y.slice(o)});if(u===p)return g.set(t,{key:v,text:w.slice(0,q),inlineStyles:x.slice(0,q),entities:y.slice(0,q)});return g.set(t,{key:v});},n,p);}e.exports=k;},null);
__d("DocumentIterator",["DocumentCharacters"],function(a,b,c,d,e,f,g){var h=g.BLOCK_DELIMITER;function i(j,k){"use strict";this.$DocumentIterator0=j;this.$DocumentIterator1=k;}i.prototype.process=function(j,k,l){"use strict";this.$DocumentIterator2=j;this.$DocumentIterator3=k;this.$DocumentIterator4=l;this.$DocumentIterator5=this.$DocumentIterator0.getText();this.$DocumentIterator6=this.$DocumentIterator0.getInlineStyles();this.$DocumentIterator7=this.$DocumentIterator1.getDecorations(this.$DocumentIterator0);this.$DocumentIterator8();};i.prototype.$DocumentIterator8=function(){"use strict";var j=this.$DocumentIterator5.split(h),k=0,l;for(var m=0;m<j.length;m++){l=k+j[m].length;this.$DocumentIterator9(k,l);k=l+h.length;}};i.prototype.$DocumentIterator9=function(j,k){"use strict";this.$DocumentIterator2.call(null,j,k);this.$DocumentIteratora(this.$DocumentIterator7,j,k,this.$DocumentIteratorb.bind(this));};i.prototype.$DocumentIteratorb=function(j,k,l){"use strict";this.$DocumentIterator3.call(null,j,k,l);this.$DocumentIteratora(this.$DocumentIterator6,j,k,this.$DocumentIteratorc.bind(this));};i.prototype.$DocumentIteratorc=function(j,k,l){"use strict";this.$DocumentIterator4.call(null,j,k,l);};i.prototype.$DocumentIteratora=function(j,k,l,m){"use strict";var n=k;for(var o=k;o<l;o++)if(j[o]!==j[o+1]){m(n,o+1,j[n]);n=o+1;}if(k===l){m(k,l,null);}else if(n!==l)m(n,l,j[n]);};e.exports=i;},null);
__d("DocumentOffsetCache",[],function(a,b,c,d,e,f){function g(i){return i<0?0:i;}function h(){"use strict";this.reset();}h.prototype.reset=function(){"use strict";this.$DocumentOffsetCache0=-1;this.$DocumentOffsetCache1=-1;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache3={};};h.prototype.nextBlock=function(i){"use strict";this.$DocumentOffsetCache0++;this.$DocumentOffsetCache1=-1;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache4(i);};h.prototype.nextDecoration=function(i){"use strict";this.$DocumentOffsetCache1++;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache4(i);};h.prototype.nextLeaf=function(i){"use strict";this.$DocumentOffsetCache2++;this.$DocumentOffsetCache4(i);};h.prototype.getCurrentKey=function(){"use strict";return (g(this.$DocumentOffsetCache0)+'.'+g(this.$DocumentOffsetCache1)+'.'+g(this.$DocumentOffsetCache2));};h.prototype.getOffset=function(i){"use strict";return this.$DocumentOffsetCache3[i];};h.prototype.getKey=function(i){"use strict";var j=null,k=null;for(var l in this.$DocumentOffsetCache3){var m=this.$DocumentOffsetCache3[l],n=i-m;if(n<0){continue;}else if(n===0){return l;}else if(n<j||j===null){j=n;k=l;}}return k;};h.prototype.$DocumentOffsetCache4=function(i){"use strict";this.$DocumentOffsetCache3[this.getCurrentKey()]=i;};e.exports=h;},null);
__d("DocumentView",["DocumentIterator","DocumentOffsetCache","UnicodeBidi","createArrayFrom","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n){"use strict";this.$DocumentView0=m;this.$DocumentView1=n;this.$DocumentView2=[];this.$DocumentView3=null;this.$DocumentView4=[];this.$DocumentView5=new g(this.$DocumentView0,this.$DocumentView1);this.$DocumentView6=new h(this.$DocumentView5);}l.prototype.getContent=function(){"use strict";return this.$DocumentView0;};l.prototype.getText=function(){"use strict";return this.$DocumentView0.getText();};l.prototype.getEntities=function(){"use strict";return this.$DocumentView0.getEntities();};l.prototype.getFragment=function(m,n){"use strict";return this.$DocumentView0.getFragment(m,n);};l.prototype.getVersion=function(){"use strict";return this.$DocumentView0.getVersion();};l.prototype.getBlockDirections=function(){"use strict";this.$DocumentView7();return this.$DocumentView4;};l.prototype.getFingerprint=function(){"use strict";this.$DocumentView7();return this.$DocumentView2.join(':');};l.prototype.getOffset=function(m){"use strict";this.$DocumentView7();return this.$DocumentView6.getOffset(m);};l.prototype.getKey=function(m){"use strict";this.$DocumentView7();return this.$DocumentView6.getKey(m);};l.prototype.iterate=function(m,n,o){"use strict";this.$DocumentView3=this.getVersion();this.$DocumentView2.length=0;this.$DocumentView4.length=0;this.$DocumentView6.reset();var p=this.$DocumentView6,q=this.$DocumentView1,r=0,s=this.$DocumentView0.getBlockStyles(),t=this.$DocumentView8.bind(this),u=this.$DocumentView9.bind(this);function v(y,z){p.nextBlock(y);u(y,z);m(p.getCurrentKey(),y,z,s[r++]);}function w(y,z,aa){var ba=null;p.nextDecoration(y);if(aa!==null){t("D",aa,z-y);ba=q.getComponentForKey(aa);}n(p.getCurrentKey(),y,z,ba);}function x(y,z,aa){p.nextLeaf(y);t("L",aa);o(p.getCurrentKey(),y,z,aa);}this.$DocumentView5.process(v,w,x);};l.prototype.$DocumentView7=function(){"use strict";if(this.$DocumentView3!==this.getVersion())this.iterate(k,k,k);};l.prototype.$DocumentView8=function(){"use strict";this.$DocumentView2.push(j(arguments).join('-'));};l.prototype.$DocumentView9=function(m,n){"use strict";var o=this.$DocumentView0.getText().slice(m,n),p=this.$DocumentView4,q=i.getDirection(o,p[p.length-1]);this.$DocumentView4.push(q);};e.exports=l;},null);
__d("OrderedMap",["invariant","mixInto"],function(a,b,c,d,e,f,g,h){"use strict";var i='key:';function j(q,r){var s={};for(var t=0;t<q.length;t++){var u=q[t],v=r(u);l(v);var w=i+v;g(!(w in s));s[w]=u;}return s;}function k(q,r){this._normalizedObj=q;this._computedPositions=null;this.length=r;}function l(q){g(q!==''&&(typeof q==='string'||typeof q==='number'));}function m(q,r,s){g(typeof q==='number'&&typeof r==='number'&&r>=0&&q>=0&&q+r<=s);}function n(q,r){g(q&&q.constructor===Object&&(!r||r.constructor===Object));var s={},t=0,u;for(u in q)if(q.hasOwnProperty(u)){s[u]=q[u];t++;}for(u in r)if(r.hasOwnProperty(u)){if(!(u in s))t++;s[u]=r[u];}return new k(s,t);}var o={has:function(q){l(q);var r=i+q;return r in this._normalizedObj;},get:function(q){l(q);var r=i+q;return this.has(q)?this._normalizedObj[r]:undefined;},merge:function(q){g(q instanceof k);return n(this._normalizedObj,q._normalizedObj);},map:function(q,r){return this.mapRange(q,0,this.length,r);},mapRange:function(q,r,s,t){var u=this._normalizedObj,v={},w=0;m(r,s,this.length);var x=r+s-1;for(var y in u)if(u.hasOwnProperty(y)){if(w>=r){if(w>x)break;var z=u[y];v[y]=q.call(t,z,y.substr(i.length),w);}w++;}return new k(v,s);},filter:function(q,r){return this.filterRange(q,0,this.length,r);},filterRange:function(q,r,s,t){var u={},v=0;this.forEachRange(function(w,x,y){if(q.call(t,w,x,y)){var z=i+x;u[z]=w;v++;}},r,s);return new k(u,v);},forEach:function(q,r){this.forEachRange(q,0,this.length,r);},forEachRange:function(q,r,s,t){m(r,s,this.length);var u=this._normalizedObj,v=0,w=r+s-1;for(var x in u)if(u.hasOwnProperty(x)){if(v>=r){if(v>w)break;var y=u[x];q.call(t,y,x.substr(i.length),v);}v++;}},mapKeyRange:function(q,r,s,t){var u=this.indexOfKey(r),v=this.indexOfKey(s);g(u!==undefined&&v!==undefined);g(v>=u);return this.mapRange(q,u,(v-u)+1,t);},forEachKeyRange:function(q,r,s,t){var u=this.indexOfKey(r),v=this.indexOfKey(s);g(u!==undefined&&v!==undefined);g(v>=u);this.forEachRange(q,u,(v-u)+1,t);},keyAtIndex:function(q){var r=this._getOrComputePositions(),s=r.keyByIndex[q];return s?s.substr(i.length):undefined;},keyAfter:function(q){return this.nthKeyAfter(q,1);},keyBefore:function(q){return this.nthKeyBefore(q,1);},nthKeyAfter:function(q,r){var s=this.indexOfKey(q);g(s!==undefined);return this.keyAtIndex(s+r);},nthKeyBefore:function(q,r){return this.nthKeyAfter(q,-r);},indexOfKey:function(q){l(q);var r=i+q,s=this._getOrComputePositions(),t=s.indexByKey[r];return t===undefined?undefined:t;},toArray:function(){var q=[],r=this._normalizedObj;for(var s in r)if(r.hasOwnProperty(s))q.push(r[s]);return q;},_getOrComputePositions:function(){var q=this._computedPositions;if(!q)this._computePositions();return this._computedPositions;},_computePositions:function(){this._computedPositions={keyByIndex:{},indexByKey:{}};var q=this._computedPositions.keyByIndex,r=this._computedPositions.indexByKey,s=0,t=this._normalizedObj;for(var u in t)if(t.hasOwnProperty(u)){q[s]=u;r[u]=s;s++;}}};h(k,o);var p={from:function(q){g(q instanceof k);return n(q._normalizedObj,null);},fromArray:function(q,r){g(Array.isArray(q));g(typeof r==='function');return new k(j(q,r),q.length);}};e.exports=p;},null);
__d("AbstractTextEditorPlaceholder.Experimental.react",["EditorState","React","cx"],function(a,b,c,d,e,f,g,h,i){var j=h.PropTypes,k=h.createClass({displayName:'AbstractTextEditorPlaceholder',propTypes:{editorState:j.instanceOf(g).isRequired,text:j.string.isRequired},shouldComponentUpdate:function(l,m){if(this.props.text!==l.text)return true;var n=this.props.editorState,o=l.editorState,p=n.getSelection(),q=o.getSelection();return (p.hasFocus()!==q.hasFocus());},render:function(){var l=this.props.editorState.getSelection().hasFocus(),m=(("_5ywb")+(l?' '+"_5ywc":''));return (h.createElement(h.DOM.div,{className:m},this.props.text));}});e.exports=k;},null);
__d("AbstractTextEditorProps",["DocumentSelectionState","DocumentView","ReactPropTypes"],function(a,b,c,d,e,f,g,h,i){var j={propTypes:{documentView:i.instanceOf(h).isRequired,selectionState:i.instanceOf(g).isRequired,placeholder:i.string,blockStyleFn:i.func.isRequired,inlineStyleFn:i.func.isRequired,keyBindingFn:i.func.isRequired,spellCheck:i.bool,onReturn:i.func.isRequired,onEscape:i.func,onTab:i.func,onUpArrow:i.func,onDownArrow:i.func,onCharacters:i.func.isRequired,onAlter:i.func.isRequired,onCut:i.func.isRequired,onPasteFragment:i.func.isRequired,onPasteFiles:i.func,onDelete:i.func.isRequired,onDropSelection:i.func.isRequired,onDropText:i.func.isRequired,onDropFiles:i.func,onSelect:i.func.isRequired,onBlur:i.func.isRequired,onFocus:i.func.isRequired,disabled:i.bool},getDefaultProps:function(){return {spellCheck:false,disabled:false};}};e.exports=j;},null);
__d("ElementForBlockType",["ComposedBlockType","React"],function(a,b,c,d,e,f,g,h){var i={getElement:function(j){switch(j){case g.HEADER_ONE:return h.DOM.h2;case g.HEADER_TWO:return h.DOM.h3;case g.UNORDERED_LIST_ITEM:case g.ORDERED_LIST_ITEM:return h.DOM.li;case g.BLOCKQUOTE:return h.DOM.blockquote;case g.MEDIA:return h.DOM.figure;default:return h.DOM.div;}},getWrapperElement:function(j){switch(j){case g.UNORDERED_LIST_ITEM:return h.DOM.ul;case g.ORDERED_LIST_ITEM:return h.DOM.ol;case g.CODE:return h.DOM.pre;default:return null;}}};e.exports=i;},null);
__d("TextEditorTextNode.react",["DOMPropertyOperations","ReactBrowserComponentMixin","ReactComponent","ReactDescriptor","UserAgent_DEPRECATED","escapeTextForBrowser","getTextContentAccessor","mixInto"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o=k.ie()<=11,p=i.BackendIDOperations,q=m();function r(z){return o?z[q]==='\n':z.tagName==='BR';}function s(z){p.dangerouslyReplaceNodeWithMarkupByID(z,o?v(z):u(z));}function t(z,aa){if(o){p.updateTextContentByID(z,aa);}else p.dangerouslyReplaceNodeWithMarkupByID(z,w(z,aa));}function u(z){return '<br '+g.createMarkupForID(z)+' />';}function v(z){return w(z,'\n');}function w(z,aa){return ('<span '+g.createMarkupForID(z)+'>'+l(aa)+'</span>');}var x=function(z){};n(x,i.Mixin);n(x,h);n(x,{mountComponent:function(z,aa,ba){i.Mixin.mountComponent.call(this,z,aa,ba);if(this.props==='')return (o?v(z):u(z));return w(z,this.props);},receiveComponent:function(z,aa){var ba=this._rootNodeID,ca=z.props,da=this.getDOMNode();if(r(da)){if(ca!==''){this.props=ca;t(ba,ca);}return;}if(ca===''){this.props=ca;s(ba);return;}var ea=this.getDOMNode()[q];if(ca!==ea)p.updateTextContentByID(ba,ca);},type:x});var y=function(z){return new j(x,null,null,null,null,z);};y.type=x;e.exports=y;},null);
__d("TextEditorLeaf.Experimental.react",["DocumentCharacters","React","SelectionState","TextEditorTextNode.react","endsWith","setDocumentSelectionExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=h.PropTypes,n=g.SOFT_NEWLINE,o=3,p=h.createClass({displayName:'TextEditorLeaf',propTypes:{selection:m.instanceOf(i),start:m.number.isRequired,blockKey:m.string.isRequired,text:m.string.isRequired,style:m.number,inlineStyleFn:m.func.isRequired,isLast:m.bool.isRequired},_setSelection:function(){var q=this.props.selection;if(q==null||!q.hasFocus())return;var r=this.props.start,s=r+this.props.text.length,t=this.props.blockKey;if(!q.hasEdgeWithin(t,r,s))return;var u=this.getDOMNode(),v=u.firstChild,w;if(v.nodeType===o){w=v;}else if(v.tagName==='BR'){w=u;}else w=v.firstChild;l(q,w,t,r,s);},shouldComponentUpdate:function(q){return (this.refs.leaf.getDOMNode().textContent!==q.text||q.forceSelection);},componentDidUpdate:function(){this._setSelection();},componentDidMount:function(){this._setSelection();},render:function(){var q=this.props.text;if(k(q,n)&&this.props.isLast)q+=n;var r;if(this.props.style)r=this.props.inlineStyleFn(this.props.style);return (h.createElement(h.DOM.span,{'data-offset-key':this.props.offsetKey,className:r,ref:"leaf"},j(q)));}});e.exports=p;},null);
__d("TextEditorBlock.Experimental.react",["ContentBlock","DocumentCompositeDecorator.Experimental","DocumentOffsetKey","React","SelectionState","TextEditorLeaf.Experimental.react","UnicodeBidiDirection","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=j.PropTypes,q=m.LTR,r=m.RTL,s=j.createClass({displayName:'TextEditorBlock',propTypes:{block:p.instanceOf(g).isRequired,tree:p.array.isRequired,selection:p.instanceOf(k).isRequired,decorator:p.instanceOf(h),forceSelection:p.bool.isRequired,direction:p.string.isRequired,blockPropTypes:p.object,blockStyleFn:p.func.isRequired,inlineStyleFn:p.func.isRequired},shouldComponentUpdate:function(u){return (this.props.block!==u.block||this.props.tree!==u.tree||this.props.direction!==u.direction||(t(u.selection,u.block.getKey())&&u.forceSelection));},_renderChildren:function(){var u=this.props.block,v=u.getKey(),w=u.getText(),x=u.getInlineStyles(),y=this.props.tree.length-1,z=t(this.props.selection,v);return this.props.tree.map(function(aa,ba){var ca=aa.leaves.map(function(fa,ga){var ha=i.encode(v,ba,ga);return (j.createElement(l,{key:ha,offsetKey:ha,blockKey:v,start:fa.start,selection:z?this.props.selection:null,forceSelection:this.props.forceSelection,text:w.slice(fa.start,fa.end),style:x[fa.start],inlineStyleFn:this.props.inlineStyleFn,isLast:ba===y}));}.bind(this));if(aa.decoratorKey===null)return ca;var da=this.props.decorator.getComponentForKey(aa.decoratorKey),ea=i.encode(v,ba,0);return (j.createElement(da,{key:ea,offsetKey:ea},ca));}.bind(this));},render:function(){var u=this.props.block,v=u.getKey(),w=o(this.props.blockStyleFn(u.getType()),((this.props.direction===q?"_2vxa":'')+(this.props.direction===r?' '+"_2vxb":'')));return (j.createElement(j.DOM.div,Object.assign({style:{position:'relative'},'data-offset-key':i.encode(v,0,0),className:w},this.props.blockProps),this._renderChildren()));}});function t(u,v){return (u.getAnchorKey()===v||u.getFocusKey()===v);}e.exports=s;},null);
__d("TextEditorCompositionHandler.Experimental",["ComposedInlineStyle","DocumentModifierExperimental","EditorChangeType","EditorState","Keys","isSelectionAtLeafStartExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.NONE,n={onBeforeInput:function(o){this._textInputData=(this._textInputData||'')+o.data;},onCompositionStart:function(){this._stillComposing=true;},onCompositionEnd:function(o){this._stillComposing=false;setTimeout(n.resolveComposition.bind(this),0);},onKeyDown:function(o){if(o.which===k.RIGHT||o.which===k.LEFT)o.preventDefault();},onKeyPress:function(o){if(o.which===k.RETURN)o.preventDefault();},resolveComposition:function(){if(this._stillComposing)return;var o=this._textInputData;this._textInputData='';var p=j.set(this.props.editorState,{inCompositionMode:false}),q=!o||l(p);if(q)this.restoreEditorDOM();this.exitCurrentMode();this.removeRenderGuard();if(o){var r=h.replaceText(p.getCurrentContent(),p.getSelection(),o,m,null);this.update(j.push(p,r,i.INSERT_CHARACTERS));return;}if(q)this.update(j.set(p,{nativelyRenderedKey:null,forceSelection:true}));}};e.exports=n;},null);
__d("TextEditorModes",[],function(a,b,c,d,e,f){var g={EDIT:0,COMPOSITE:1,DRAG:2,RENDER:3,CUT:4};e.exports=g;},null);
__d("TextEditorPasteHandler",["ComposedBlockType","ComposedInlineStyle","ContentBlock","DocumentCharacters","arrayContains","fillArray","generateBlockKey","getSafeBodyFromHTML"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.BOLD,p=h.ITALIC,q=h.UNDERLINE,r=h.NONE,s=j.BLOCK_DELIMITER,t='&nbsp;',u=j.SOFT_NEWLINE,v=' ',w=g.UNSTYLED,x=['p','h1','h2','h3','li','blockquote'],y={strong:o,b:o,em:p,i:p,u:q};function z(){return {text:'',inlines:[],blocks:[]};}function aa(){return {text:v,inlines:[r],blocks:[]};}function ba(){return {text:u,inlines:[r],blocks:[]};}function ca(ka){return {text:s,inlines:[r],blocks:[ka]};}function da(ka,la){switch(ka){case 'h1':return g.HEADER_ONE;case 'h2':return g.HEADER_TWO;case 'li':if(la==='ol')return g.ORDERED_LIST_ITEM;return g.UNORDERED_LIST_ITEM;case 'blockquote':return g.BLOCKQUOTE;case 'pre':return g.CODE;default:return g.UNSTYLED;}}function ea(ka,la,ma){var na=y[ka];if(na){ma|=na;}else if(la.style){ma|=la.style.fontWeight==='bold'?o:0;ma|=la.style.fontStyle==='italic'?p:0;ma|=la.style.textDecoration==='underline'?q:0;}return ma;}function fa(ka,la){if(ka.text.slice(-1)===s&&la.text.slice(0,1)===s){ka.text=ka.text.slice(0,-1);ka.inlines.pop();ka.blocks.pop();}if(ka.text.slice(-1)===s&&(la.text===v||la.text===u))return ka;return {text:ka.text+la.text,inlines:ka.inlines.concat(la.inlines),blocks:ka.blocks.concat(la.blocks)};}function ga(ka){return x.some(function(la){return ka.indexOf('<'+la)!==-1;});}function ha(ka,la,ma,na,oa){var pa=ka.nodeName.toLowerCase(),qa=false;if(pa==="#text"){var ra=ka.textContent;if(ra.trim()==='')return aa();return {text:ra,inlines:l(ra.length,la),blocks:[]};}if(pa==="br")return ba();var sa=z(),ta;la=ea(pa,ka,la);if(pa==="ul"||pa==="ol")ma=pa;if(!na&&k(oa,pa)){sa=ca(da(pa,ma));na=true;qa=true;}ka=ka.firstChild;while(ka){ta=ha(ka,la,ma,na,oa);sa=fa(sa,ta);ka=ka.nextSibling;}if(qa)sa=fa(sa,ca(w));return sa;}function ia(ka){ka=ka.trim().replace(s,'').replace(u,v).replace(t,v);var la=n(ka);if(!la)return null;var ma=ga(ka)?x:['div'],na=ha(la,0,'ul',false,ma);if(na.text.indexOf(s)===0)na={text:na.text.slice(1),inlines:na.inlines.slice(1),blocks:na.blocks};if(na.text.slice(-1)===s){na.text=na.text.slice(0,-1);na.inlines=na.inlines.slice(0,-1);na.blocks.pop();}if(na.blocks.length===0)na.blocks.push(w);if(na.text.split(s).length===na.blocks.length+1)na.blocks.unshift(w);return na;}var ja={processHTML:function(ka){return ia(ka);},processHTMLAsImmutable:function(ka){var la=ia(ka);if(!la)return null;var ma=0;return la.text.split(s).map(function(na,oa){var pa=ma+na.length,qa=i.create({key:m(),type:la.blocks[oa],text:na,inlineStyles:la.inlines.slice(ma,pa),entities:l(na.length,null)});ma=pa+1;return qa;});},processText:function(ka){return {text:ka,inlines:l(ka.length,r),blocks:l(ka.split(s).length,w)};},processTextAsImmutable:function(ka){return ka.map(function(la){return i.create({key:m(),type:w,text:la,inlineStyles:l(la.length,r),entities:l(la.length,null)});});}};e.exports=ja;},null);
__d("TextEditorEditHandler.Experimental",["BlockTree","ContentState","DataTransfer","DocumentCharacters","DocumentCommands","DocumentModifierExperimental","DocumentOffsetKey","DocumentRemovableWord","DocumentRemovalDirection","EditorChangeType","EditorState","ImmutableMap","Keys","SelectionState","TextEditorModes","TextEditorPasteHandler","UnicodeUtils","UserAgent_DEPRECATED","areEqual","findAncestorOffsetKey","getActiveElement","getContentStateFragment","getDocumentSelectionExperimental","isSelectionAtLeafStartExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){"use strict";var ea=j.SOFT_NEWLINE,fa={onFocus:function(gb){var hb=this.props.editorState,ib=hb.getSelection();if(ib.hasFocus())return;var jb=t.set(ib,{hasFocus:true});this.props.onFocus&&this.props.onFocus(gb);this.update(q.updateSelection(hb,jb,false));},onBlur:function(gb){if(a.getSelection&&aa()===document.body)a.getSelection().removeAllRanges();var hb=this.props.editorState,ib=hb.getSelection();if(!ib.hasFocus())return;var jb=t.set(ib,{hasFocus:false});this.props.onBlur&&this.props.onBlur(gb);this.update(q.updateSelection(hb,jb,false));},onBeforeInput:function(gb){var hb=gb.data;if(!hb)return;var ib=this.props.editorState,jb=ib.getSelection(),kb=ib.getCurrentContent();if(!jb.isCollapsed()){gb.preventDefault();this.update(ja(ib,hb,ib.getCurrentInlineStyle(),null));return;}var lb=!da(ib),mb=ja(ib,hb,ib.getCurrentInlineStyle(),null);if(!lb){gb.preventDefault();this.update(mb);return;}var nb=jb.getAnchorKey(),ob=r.get(kb.getTreeMap(),nb),pb=mb.getCurrentContent(),qb=g.getFingerprint(ob),rb=g.getFingerprint(r.get(pb.getTreeMap(),nb));if(fb(hb)||qb!==rb){gb.preventDefault();}else mb=q.set(mb,{nativelyRenderedKey:mb.getCurrentKey()});this.update(mb);},onSelect:function(gb){var hb=this.props.editorState,ib=ca(hb,this.refs.editorContainer.getDOMNode().firstChild),jb=ib.selectionState;if(jb!==hb.getSelection())this.update(q.updateSelection(hb,jb,!!ib.needsRecovery));},onKeyDown:function(gb){var hb=gb.which,ib=this.props.editorState;switch(hb){case s.RETURN:gb.preventDefault();if(this.props.handleReturn&&this.props.handleReturn(gb))return;if(gb.shiftKey){this.update(ta(ib));}else this.update(ua(ib));return;case s.ESC:gb.preventDefault();this.props.onEscape&&this.props.onEscape(gb);return;case s.TAB:this.props.onTab&&this.props.onTab(gb);return;case s.UP:this.props.onUpArrow&&this.props.onUpArrow(gb);return;case s.DOWN:this.props.onDownArrow&&this.props.onDownArrow(gb);return;}var jb=this.props.keyBindingFn(gb);if(!jb)return;gb.preventDefault();if(this.props.handleKeyCommand&&this.props.handleKeyCommand(jb))return;if(jb===k.UNDO){ha(ib,this.update);return;}var kb=ga(jb,ib);if(kb!==ib)this.update(kb);},onCharacterData:function(gb){var hb=z(gb),ib=this.props.editorState,jb=ib.getSelection(),kb=ib.getCurrentContent(),lb=kb.getTreeMap(),mb=m.decode(hb),nb=mb.blockKey,ob=r.get(lb,nb),pb=ob[mb.decoratorKey].leaves[mb.leafKey],qb=kb.getBlockForKey(nb);if(qb.getText().slice(pb.start,pb.end)===gb.textContent)return;var rb=t.set(ib.getSelection(),{anchorOffset:pb.start,focusOffset:pb.end,isBackward:false}),sb=l.replaceText(kb,rb,gb.textContent,qb.getInlineStyles()[pb.start],null),tb=ca(this.props.editorState,this.refs.editorContainer.getDOMNode().firstChild),ub=h.set(sb,{selectionBefore:jb,selectionAfter:tb.selectionState});this.update(q.push(ib,ub,p.INSERT_CHARACTERS));},onDragStart:function(gb){this._internalDrag=true;this.setMode(u.DRAG);},onDragOver:function(gb){this._internalDrag=false;this.setMode(u.DRAG);gb.preventDefault();},onCompositionStart:function(gb){this.setRenderGuard();this.captureEditorDOM();this.setMode(u.COMPOSITE);this.update(q.set(this.props.editorState,{inCompositionMode:true}));},onCut:function(gb){var hb=this.props.editorState,ib=hb.getSelection();if(ib.isCollapsed()){gb.preventDefault();return;}this.setRenderGuard();this.captureEditorDOM();bb(hb,function(jb){this._clipboard=jb;this.setMode(u.CUT);setTimeout(function(){this.restoreEditorDOM();this.removeRenderGuard();this.exitCurrentMode();this.update(ab(hb));}.bind(this),0);}.bind(this));},onCopy:function(){bb(this.props.editorState,function(gb){this._clipboard=gb;}.bind(this));},onPaste:function(gb){gb.preventDefault();var hb=new i(gb.clipboardData);if(!hb.isRichText()){var ib=hb.getFiles();if(ib.length>0){this.props.onPasteFiles&&this.props.onPasteFiles(ib);return;}}var jb,kb=hb.getText();if(kb)jb=kb.split(ea);if(this._clipboard){var lb=jb.filter(ya),mb=r.toArray(r.map(this._clipboard,function(rb){return rb.getText();})).filter(ya),nb=y(lb,mb);if(nb){this.update(za(this.props.editorState,this._clipboard));return;}}var ob=hb.getHTML();if(ob){var pb=v.processHTMLAsImmutable(ob);if(pb){this.update(za(this.props.editorState,r.fromArray(pb,function(rb){return rb.getKey();})));return;}}this._clipboard=null;if(jb){var qb=v.processTextAsImmutable(jb);this.update(za(this.props.editorState,r.fromArray(qb,function(rb){return rb.getKey();})));}}};function ga(gb,hb){switch(gb){case k.UNDO:return ha(hb);case k.REDO:return ia(hb);case k.DELETE:return la(hb);case k.DELETE_WORD:return ma(hb);case k.DELETE_TO_END_OF_BLOCK:return na(hb);case k.BACKSPACE:return oa(hb);case k.BACKSPACE_WORD:return ra(hb);case k.BACKSPACE_TO_END_OF_BLOCK:return sa(hb);case k.INSERT_BLOCK_DELIMITER:return ua(hb);case k.TRANSPOSE_CHARACTERS:return va(hb);case k.MOVE_SELECTION_TO_START_OF_BLOCK:return wa(hb);case k.MOVE_SELECTION_TO_END_OF_BLOCK:return xa(hb);default:return hb;}}function ha(gb,hb){var ib=q.undo(gb);if(!gb.getNativelyRenderedKey()){hb(ib);return;}hb(q.set(gb,{nativelyRenderedKey:null}));setTimeout(function(){hb(ib);});}function ia(gb){return q.redo(gb);}function ja(gb,hb,ib,jb){var kb=l.replaceText(gb.getCurrentContent(),gb.getSelection(),hb,ib,jb||null);return q.push(gb,kb,p.INSERT_CHARACTERS);}function ka(gb,hb,ib){var jb=gb.getSelection(),kb=gb.getCurrentContent(),lb=jb;if(jb.isCollapsed()){if(ib===o.FORWARD){if(gb.isAtDocumentEnd())return kb;}else if(gb.isAtDocumentStart())return kb;lb=hb(gb);if(lb===jb)return kb;}return l.removeRange(kb,lb,ib);}function la(gb){var hb=ka(gb,function(jb){var kb=jb.getSelection(),lb=jb.getCurrentContent(),mb=kb.getAnchorKey(),nb=kb.getAnchorOffset(),ob=lb.getBlockForKey(mb).getText()[nb];return qa(jb,ob?w.getUTF16Length(ob,0):1);},o.FORWARD);if(hb===gb.getCurrentContent())return gb;hb=h.set(hb,{selectionBefore:gb.getSelection()});var ib=gb.getSelection().isCollapsed()?p.DELETE_CHARACTER:p.REMOVE_RANGE;return q.push(gb,hb,ib);}function ma(gb){var hb=ka(gb,function(ib){var jb=ib.getSelection(),kb=jb.getStartOffset(),lb=jb.getStartKey(),mb=ib.getCurrentContent(),nb=mb.getBlockForKey(lb).getText().slice(kb),ob=n.getForward(nb)||'';return qa(ib,ob.length||1);},o.FORWARD);if(hb===gb.getCurrentContent())return gb;return q.push(gb,hb,p.REMOVE_RANGE);}function na(gb){var hb=ka(gb,function(ib){var jb=ib.getSelection(),kb=jb.getStartOffset(),lb=jb.getStartKey(),mb=ib.getCurrentContent(),nb=mb.getBlockForKey(lb).getText();if(kb===nb.length)return qa(ib,1);return t.set(jb,{focusOffset:nb.length});},o.FORWARD);if(hb===gb.getCurrentContent())return gb;return q.push(gb,hb,p.REMOVE_RANGE);}function oa(gb){var hb=ka(gb,function(jb){var kb=jb.getSelection(),lb=jb.getCurrentContent(),mb=kb.getAnchorKey(),nb=kb.getAnchorOffset(),ob=lb.getBlockForKey(mb).getText()[nb-1];return pa(jb,ob?w.getUTF16Length(ob,0):1);},o.BACKWARD);if(hb===gb.getCurrentContent())return gb;hb=h.set(hb,{selectionBefore:gb.getSelection()});var ib=gb.getSelection().isCollapsed()?p.BACKSPACE_CHARACTER:p.REMOVE_RANGE;return q.push(gb,hb,ib);}function pa(gb,hb){var ib=gb.getSelection(),jb=gb.getCurrentContent(),kb=ib.getStartKey(),lb=ib.getStartOffset(),mb=kb,nb;if(hb>lb){var ob=jb.getKeyBefore(kb);mb=ob;var pb=jb.getBlockForKey(ob);nb=pb.getText().length;}else nb=lb-hb;return t.set(ib,{focusKey:mb,focusOffset:nb,isBackward:true});}function qa(gb,hb){var ib=gb.getSelection(),jb=ib.getStartKey(),kb=ib.getStartOffset(),lb=gb.getCurrentContent(),mb=jb,nb,ob=lb.getBlockForKey(jb);if(hb>(ob.getText().length-kb)){mb=lb.getKeyAfter(jb);nb=0;}else nb=kb+hb;return t.set(ib,{focusKey:mb,focusOffset:nb});}function ra(gb){var hb=ka(gb,function(ib){var jb=ib.getSelection(),kb=jb.getStartOffset();if(kb===0)return pa(ib,1);var lb=jb.getStartKey(),mb=ib.getCurrentContent(),nb=mb.getBlockForKey(lb).getText().slice(0,kb),ob=n.getBackward(nb)||'';return pa(ib,ob.length||1);},o.BACKWARD);if(hb===gb.getCurrentContent())return gb;return q.push(gb,hb,p.REMOVE_RANGE);}function sa(gb){var hb=ka(gb,function(ib){var jb=ib.getSelection();if(jb.getStartOffset()===0)return pa(ib,1);return t.set(jb,{focusOffset:0,isBackward:true});},o.BACKWARD);if(hb===gb.getCurrentContent())return gb;return q.push(gb,hb,p.REMOVE_RANGE);}function ta(gb){var hb=l.insertText(gb.getCurrentContent(),gb.getSelection(),ea,gb.getCurrentInlineStyle(),null);return q.push(gb,hb,p.INSERT_CHARACTERS);}function ua(gb){var hb=l.splitBlock(gb.getCurrentContent(),gb.getSelection());return q.push(gb,hb,p.SPLIT_BLOCK);}function va(gb){return gb;}function wa(gb){var hb=gb.getSelection(),ib=hb.getStartKey(),jb=t.set(hb,{anchorKey:ib,anchorOffset:0,focusKey:ib,focusOffset:0,isBackward:false});return q.set(gb,{selection:jb,forceSelection:true});}function xa(gb){var hb=gb.getSelection(),ib=hb.getEndKey(),jb=gb.getCurrentContent(),kb=jb.getBlockForKey(ib),lb=kb.getText().length,mb=t.set(hb,{anchorKey:ib,anchorOffset:lb,focusKey:ib,focusOffset:lb,isBackward:false});return q.set(gb,{selection:mb,forceSelection:true});}function ya(gb){return gb.length>0;}function za(gb,hb){var ib=l.replaceWithFragment(gb.getCurrentContent(),gb.getSelection(),hb);return q.push(gb,ib,p.INSERT_FRAGMENT);}function ab(gb){var hb=l.removeRange(gb.getCurrentContent(),gb.getSelection(),o.FORWARD);return q.push(gb,hb,p.REMOVE_RANGE);}function bb(gb,hb){var ib=gb.getSelection();if(!ib.isCollapsed())hb(ba(gb.getCurrentContent(),ib));}var cb='\'',db='\/',eb=!!x.firefox();function fb(gb){return (eb&&(gb==cb||gb==db));}e.exports=fa;},null);
__d("TextEditorDragHandler",["DataTransfer"],function(a,b,c,d,e,f,g){function h(j,event){var k,l;if(document.caretRangeFromPoint){var m=document.caretRangeFromPoint(event.x,event.y);k=m.startContainer;l=m.startOffset;}else if(event.rangeParent){k=event.rangeParent;l=event.rangeOffset;}if(k){var n=document.createRange();n.setStart(j,0);n.setEnd(k,l);var o=n.toString().length;n.detach();return o;}}var i={onDragEnd:function(){this.exitCurrentMode();},onDrop:function(j){var k=new g(j.nativeEvent.dataTransfer),l=h(this.refs.editorContainer.getDOMNode(),j.nativeEvent);if(l!=null){var m=k.getFiles();if(this.props.onDropFiles&&m.length>0){this.props.onDropFiles(l,m);}else if(this._internalDrag){this.props.onDropSelection(l);}else this.props.onDropText(l,k.getText());}j.preventDefault();this.exitCurrentMode();}};e.exports=i;},null);
__d("UnicodeBidiService",["Locale","UnicodeBidi","UnicodeBidiDirection","invariant"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l){if(!l)l=g.getDirection();j(i.isStrong(l));this.defaultDir=l;this.reset();}k.prototype.reset=function(){this.lastDir=this.defaultDir;};k.prototype.getDirection=function(l){this.lastDir=h.getDirection(l,this.lastDir);return this.lastDir;};e.exports=k;},null);
__d("AbstractTextEditor.Experimental.react",["AbstractTextEditorPlaceholder.Experimental.react","AbstractTextEditorProps","DocumentOffsetKey","DOMVector","EditorState","ElementForBlockType","React","TextEditorBlock.Experimental.react","TextEditorCompositionHandler.Experimental","TextEditorEditHandler.Experimental","TextEditorDragHandler","TextEditorModes","UnicodeBidiService","cx","extendArray","requestAnimationFrame","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){"use strict";var x=a.MutationObserver||a.WebKitMutationObserver;function y(ba){return function(ca){var da=this._handler&&this._handler[ba];da&&da.call(this,ca);};}function z(ba){switch(ba){case r.EDIT:return p;case r.COMPOSITE:return o;case r.DRAG:return q;case r.CUT:case r.RENDER:return null;}}var aa=m.createClass({displayName:'AbstractTextEditor',getDefaultProps:h.getDefaultProps,_onBlur:y('onBlur'),_onFocus:y('onFocus'),_onSelect:y('onSelect'),_onKeyDown:y('onKeyDown'),_onKeyUp:y('onKeyUp'),_onKeyPress:y('onKeyPress'),_onMouseDown:y('onMouseDown'),_onMouseUp:y('onMouseUp'),_onCharacterData:y('onCharacterData'),_onCompositionStart:y('onCompositionStart'),_onCompositionEnd:y('onCompositionEnd'),_onDragStart:y('onDragStart'),_onDragOver:y('onDragOver'),_onDragEnd:y('onDragEnd'),_onDrop:y('onDrop'),_onCut:y('onCut'),_onCopy:y('onCopy'),_onPaste:y('onPaste'),_onBeforeInput:y('onBeforeInput'),_renderContents:function(){var ba=this.props.editorState,ca=this.props.blockComponent||n,da=ba.getCurrentContent(),ea=ba.getSelection(),fa=ba.getCurrentKey(),ga=ba.mustForceSelection(),ha=da.getBlocksAsArray(),ia=[],ja=null,ka=null,la,ma,na,oa,pa,qa,ra;for(var sa=0;sa<ha.length;sa++){ma=ha[sa];na=ma.getKey();oa=ma.getText();pa=ma.getType();qa=m.createElement(ca,{currentEditorState:fa,key:na,tree:da.getTreeMap()[na],decorator:ba.getDecorator(),block:ma,selection:ea,forceSelection:ga,direction:this._bidiService.getDirection(oa),blockProps:this.props.blockProps,blockStyleFn:this.props.blockStyleFn,inlineStyleFn:this.props.inlineStyleFn});ra=l.getWrapperElement(pa);if(ra){if(ka!==pa){la=[];ja=m.createElement(ra,{className:"_4noe",key:na+'-wrap','data-offset-key':i.encode(na,0,0)},la);ka=pa;ia.push(ja);}la.push(qa);}else{la=null;ja=null;ka=null;ia.push(qa);}}return ia;},_attachMutationObserver:function(){if(!x)return;var ba=[],ca=function(){if(ba.length>1){var da=ba[0],ea=da.target;w(function(){this._onCharacterData(ea);}.bind(this));}ba.length=0;}.bind(this);this._mutationObserver=new x(function(da){if(!this._guardAgainstRender){if(ba.length===0)v(ca);u(ba,da);}}.bind(this));this._mutationObserver.observe(this.refs.editorContainer.getDOMNode(),{characterDataOldValue:true,characterData:true,subtree:true});},_renderPlaceholder:function(){var ba=this.props.editorState.getCurrentContent(),ca=(this.props.placeholder&&!this.props.editorState.isInCompositionMode()&&!ba.hasText());if(ca)return (m.createElement(g,{text:this.props.placeholder,editorState:this.props.editorState}));},render:function(){return (m.createElement(m.DOM.div,{className:"_5yw9"},this._renderPlaceholder(),m.createElement(m.DOM.div,{className:"_5ywa",ref:"editorContainer"},m.createElement(m.DOM.div,{ref:"editor",role:"textbox",className:"_54-z",onBlur:this._onBlur,onFocus:this._onFocus,onSelect:this._onSelect,onMouseUp:this._onMouseUp,onKeyDown:this._onKeyDown,onKeyUp:this._onKeyUp,onKeyPress:this._onKeyPress,onCut:this._onCut,onCopy:this._onCopy,onPaste:this._onPaste,onDragStart:this._onDragStart,onDragOver:this._onDragOver,onDragEnd:this._onDragEnd,onDrop:this._onDrop,onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onBeforeInput:this._onBeforeInput,spellCheck:this.props.spellCheck,contentEditable:true},this._renderContents()))));},focus:function(){var ba=this.props.editorState,ca=ba.getSelection().hasFocus(),da=j.getScrollPosition();this.refs.editor.getDOMNode().focus();window.scrollTo(da.x,da.y);if(ca)return;this.update(k.moveFocusToEnd(ba));},blur:function(){this.refs.editor.getDOMNode().blur();},componentDidMount:function(){this._renderedVersion=null;this._clipboard=null;this._clonedEditor=null;this._guardAgainstRender=false;this._handler=p;this._attachMutationObserver();},shouldComponentUpdate:function(ba){var ca=this.props.editorState,da=ba.editorState,ea=da.getNativelyRenderedKey(),fa=ca.isInCompositionMode(),ga=da.isInCompositionMode();if(ca===da||(ea&&da.getCurrentKey()===ea)||(fa&&ga))return false;var ha=ca.getCurrentContent(),ia=da.getCurrentContent();return (fa!==ga||ha!==ia||da.mustForceSelection());},componentWillUpdate:function(ba){this._blockSelectEvents=true;this._bidiService.reset();},componentDidUpdate:function(){this._blockSelectEvents=false;},componentWillMount:function(){this._bidiService=new s();},componentWillUnmount:function(){if(this._mutationObserver){this._mutationObserver.disconnect();this._mutationObserver=null;}},setMode:function(ba){this._handler=z(ba);},exitCurrentMode:function(){this.setMode(r.EDIT);},captureEditorDOM:function(){this._clonedEditor=this.refs.editor.getDOMNode().cloneNode(true);},restoreEditorDOM:function(){var ba=this.refs.editorContainer.getDOMNode();ba.innerHTML='';ba.appendChild(this._clonedEditor);this.focus();this._clonedEditor=null;},setRenderGuard:function(){this._guardAgainstRender=true;},removeRenderGuard:function(){this._guardAgainstRender=false;},update:function(ba){this.props.onChange(ba);}});e.exports=aa;},null);
__d("getDefaultKeyBinding",["DocumentCommands","Keys","UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g,h,i){var j=i.osx(),k=i.windows(),l=i.firefox(),m=j&&l&&l<29;function n(u){return u.ctrlKey&&!u.altKey;}function o(u){return j?(u.metaKey&&!u.altKey):n(u);}function p(u){return (j&&u.altKey)||n(u);}function q(u){if(o(u))return u.shiftKey?g.REDO:g.UNDO;}function r(u){if(k&&u.shiftKey)return null;return p(u)?g.DELETE_WORD:g.DELETE;}function s(u){if(o(u)&&j)return g.BACKSPACE_TO_END_OF_BLOCK;return p(u)?g.BACKSPACE_WORD:g.BACKSPACE;}function t(u){switch(u.keyCode){case 66:return o(u)?g.BOLD:null;case 68:return n(u)?g.DELETE:null;case 72:return n(u)?g.BACKSPACE:null;case 73:return o(u)?g.ITALIC:null;case 74:return o(u)?g.CODE:null;case 75:return n(u)?g.DELETE_TO_END_OF_BLOCK:null;case 79:return n(u)?g.INSERT_BLOCK_DELIMITER:null;case 84:return n(u)?g.TRANSPOSE_CHARACTERS:null;case 85:return o(u)?g.UNDERLINE:null;case 90:return q(u)||null;case h.DELETE:return r(u);case h.BACKSPACE:return s(u);case h.LEFT:return (m&&o(u)?g.MOVE_SELECTION_TO_START_OF_BLOCK:null);case h.RIGHT:return (m&&o(u)?g.MOVE_SELECTION_TO_END_OF_BLOCK:null);default:return null;}}e.exports=t;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areJSONRepresentationsEqual","copyProperties","csx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=175,v=269,w=0;function x(){return u;}function y(){return v;}function z(aa){this._root=aa;var ba=this._recalculateWidth.bind(this);m.listen(window,'resize',ba);j.subscribe('resize',ba);g.subscribeOnce('sidebar/initialized',ba,g.SUBSCRIBE_NEW);i.subscribe('chat/tabs-changed',t(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}r(z.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var aa=z._getAvailableDockWidth(this._root),ba=Math.max(1,Math.floor(aa/y())),ca=ba!=this._maxShown;if(!this._viewState||ca||aa<=this._viewState.usedWidth||aa>this._viewState.widthToShowNext){this._availableWidth=aa;this._maxShown=ba;this._viewState=null;this._recalculateTabs(ca);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(aa){var ba=z._getTabsToShow(i.get(),this._availableWidth);if(aa||!q(this._viewState,ba)){this._viewState=ba;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>y();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var aa=i.get(),ba=this._viewState.tabsToShow;return aa.tabs.filter(function(ca){return ba[ca.id];});},getRightmostHiddenTab:function(){var aa=i.get(),ba=this._viewState.tabsToShow,ca=aa.tabs.filter(function(ea){return !ba[ea.id];}),da=ca.shift();return da?da.id:null;},getLeftmostVisibleTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.pop();return ba?ba.id:null;},getRightmostRaisedTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(i.getTab(aa[ca].id).raised)return aa[ca].id;return null;},getRaisedVisibleTabs:function(){var aa=[],ba=this.getShowingTabsOrder(),ca=ba.length;for(var da=0;da<ca;da++)if(i.getTab(ba[da].id).raised)aa.push(ba[da].id);return aa;},shouldPromoteOnRaise:function(aa){if(!this._viewState.tabsToShow[aa])return true;if(this._viewState.nextToHide!=aa)return false;var ba=i.getTab(aa),ca=ba&&ba.raised;return !ca&&(this._availableWidth-this._viewState.usedWidth<y()-x());}});r(z,{_getAvailableDockWidth:function(aa){var ba=l.getViewportWithoutScrollbarDimensions().width;ba-=p.getLeft()+p.getRight();ba-=50;var ca=n.byClass(aa,'fbDock'),da=k.find(ca,"._56ox"),ea=o.getElementDimensions(da).x;ba-=ea;var fa=k.scry(ca,"._56oy");ea+=o.getElementDimensions(fa.pop()).x;var ga=o.getElementDimensions(ca),ha=ga.x-ea;if(ha>w)w=ha;ba-=w;ba-=15;return Math.max(ba,0);},_getTabsToShow:function(aa,ba){ba=Math.max(ba,y()+1);function ca(sa,ta){return (sa.raised||!ta)?y():x();}var da=JSON.parse(JSON.stringify(aa.tabs)),ea=-1,fa=null;if(aa.promoted)da.forEach(function(sa,ta){if(sa.id===aa.promoted){ea=ta;fa=sa;}});var ga=0,ha=false,ia=0,ja=!fa;da.forEach(function(sa,ta){var ua=ca(sa,ha);ha=ha||!sa.raised;sa.leftmostOffset=ga+ua;ga+=ua;if(sa.leftmostOffset<ba)ia++;ja|=ta==ea;sa.alreadyPlacedPromoted=ja;});function ka(sa,ta,ua){var va={};for(var wa=0;wa<ta;wa++){var xa=sa[wa];if(!xa.alreadyPlacedPromoted&&wa==ta-1){va[ua]=true;}else va[xa.id]=true;}return va;}var la=ka(da,ia,aa.promoted),ma=ka(da,ia-1,aa.promoted),na=null;for(var oa in la)if(!ma[oa])na=oa;var pa=da[ia-1],qa=pa?pa.leftmostOffset:0,ra=Infinity;if(ia<da.length)ra=da[ia].leftmostOffset;return {nextToHide:na,tabsToShow:la,usedWidth:qa,widthToShowNext:ra};}});e.exports=z;},null);
__d("ChatTabPresence",["AvailableList","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={};function k(l){var m=i.getCanonicalUserInThread(l);if(m)g.updateForID(m);}h.subscribe('chat/tabs-changed',function(event,l){l.tabs.forEach(function(m){if(m.raised&&!j[m.id])k(m.id);});j={};l.tabs.forEach(function(m){if(m.raised)j[m.id]=true;});});e.exports={};},null);
__d("ChatMentionsNotifications",["fbt","CurrentUser","MercuryParticipants"],function(a,b,c,d,e,f,g,h,i){var j={notifyIfMessageToMe:function(k){var l='fbid:'+h.getID(),m=k.body;i.get(l,function(n){var o=new RegExp(n.short_name,"i");if(o.test(m))j._notify(k);});},_notify:function(k){var l=48,m=k.body;if(m.length>l)m=m.substr(0,l-3)+"...";new Notification("\"You were tagged in a message!\"",{body:m,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};e.exports=j;},null);
__d("VideoCallPromo",["ArbiterMixin","AsyncRequest","ChatConfig","ChatVisibility","LegacyContextualDialog","CSS","MercuryParticipants","ChatTabTemplates","VideoCallCore","VideoCallSupport","copyProperties","emptyFunction","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=b('MercuryThreads').get();function t(){this._dialog=null;}function u(w){if(!(p.isVideoCallSupported()&&i.get('video.show_promo')))return false;var x=s.getCanonicalUserInThread(w);if(!x)return false;return j.isOnline()&&o.availableForCall(x);}function v(w){new h().setURI('/ajax/chat/video/log_promo.php').setData({viewedUserID:w}).setAllowCrossPageTransition(true).setErrorHandler(r).send();}q(t.prototype,g);q(t.prototype,{render:function(w,x){var y=u(x);if(!y)return;var z=s.getCanonicalUserInThread(x);m.get('fbid:'+z,function(aa){if(!aa.call_promo)return;var ba=n[':fb:mercury:call:promo'].build();this._dialog=new k();this._dialog.init(ba.getRoot()).setWidth(250).setAlignH('center').setContext(w).show();l.addClass(this._dialog.getRoot(),'uiContextualDialogWithFooterArrowBottom');l.addClass(w,'video_call_promo');v(s.getCanonicalUserInThread(x));this.inform('chat/dialog-rendered',{dialog:this,thread_id:x});}.bind(this));},updatePosition:function(){if(this._dialog&&this._dialog.isShown())this._dialog.updatePosition();},hide:function(){if(this._dialog&&this._dialog.isShown()){this._dialog.hide();this._dialog=null;}}});e.exports=t;},null);
__d("VideoCallTourDialog",["ArbiterMixin","LegacyContextualDialog","CSS","ChatTabTemplates","VideoCallCore","VideoCallingTour","copyProperties","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=b('MercuryThreads').get();function o(){this._dialog=null;}m(o.prototype,g);m(o.prototype,{render:function(p,q){var r=n.getCanonicalUserInThread(q);if(!r||!k.availableForCall(r))return;var s=j[':fb:mercury:call:tour'].build();this._dialog=new h();this._dialog.init(s.getRoot()).setWidth(250).setAlignH('center').setContext(p).show();i.addClass(this._dialog.getRoot(),'uiContextualDialogWithFooterArrowBottom');i.addClass(p,'video_call_tour');this.inform('chat/dialog-rendered',{dialog:this,thread_id:q});l.inform('videocallingtour/end');},updatePosition:function(){if(this._dialog&&this._dialog.isShown())this._dialog.updatePosition();},hide:function(){if(this._dialog&&this._dialog.isShown()){this._dialog.hide();this._dialog=null;}}});e.exports=o;},null);
__d("ChatContextualDialogController",["Event","ArbiterMixin","ChatTabModel","VideoCallingTour","VideoCallPromo","VideoCallTourDialog","copyProperties","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=60000,p=false,q=false,r=function(y,z){this._videoCallPromo=new k();this._videoCallTour=new l();this._threadID=y;this._tabMainElement=z;this._openDialog=null;this._subscriptionTokens=[];this._scrollListener=null;this._timeout=null;};function s(y,event,z){if(y._openDialog)y._openDialog.updatePosition();}function t(y){if(y._openDialog)y._openDialog.updatePosition();}function u(y){if(y._openDialog){y._openDialog.hide();y._openDialog=null;}if(y._timeout){clearTimeout(y._timeout);y._timeout=null;}while(y._subscriptionTokens.length)y._subscriptionTokens.pop().unsubscribe();if(y._scrollListener){y._scrollListener.remove();y._scrollListener=null;}}function v(y,event,z){if(z.thread_id===y._threadID){y._openDialog=z.dialog;p=true;x(y);y._timeout=n(y.destroy.bind(y,y._threadID),o);y._scrollListener=g.listen(window,'scroll',t.bind(null,y));}}function w(y,z){if(!y._openDialog){y._subscriptionTokens.push(z.subscribe('chat/dialog-rendered',v.bind(null,y)));z.render(y._tabMainElement,y._threadID);}}function x(y){y._subscriptionTokens.push(i.subscribe('chat/tabs-changed',s.bind(null,y)),r.subscribe('dialog/close-all',u.bind(null,y)));}m(r,h);m(r.prototype,{destroy:function(){u(this);},tabFocused:function(){if(q){w(this,this._videoCallTour);return;}if(!p)w(this,this._videoCallPromo);},tabNotActive:function(){u(this);},hideVideoCallouts:function(){u(this);}});j.subscribe('videocallingtour/start',function(){q=true;r.inform('dialog/close-all');});j.subscribe('videocallingtour/end',function(){q=false;});e.exports=r;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){var i={propTypes:{attachmentsShelf:h.PropTypes.object,onFileUploaderMounted:h.PropTypes.func,onUploadFinished:h.PropTypes.func,onUpdateAttachmentsShelf:h.PropTypes.func,onSubmit:h.PropTypes.func},setUpSubscriptionsHandler:function(j){this._uploader=j;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=i;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","MercuryFileUploader","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=k.createClass({displayName:'ChatFileUploader',mixins:[g],shouldComponentUpdate:function(){return false;},componentDidMount:function(){var o=new j(this.props.attachmentsShelf,this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this.setUpSubscriptionsHandler(o);},render:function(){return (k.createElement(k.DOM.form,{ref:"form",action:i.upload_url,method:"post"},k.createElement(k.DOM.input,{type:"hidden",ref:"attachID",name:"attach_id"}),k.createElement(h,{className:"_m _4q60 itemLabel"},k.createElement(k.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),k.createElement(k.DOM.span,{className:"_4q61 itemAnchor"},"Add Files..."))));}});e.exports=n;},null);
__d("ChatInput.react",["AbstractTextEditor.Experimental.react","DocumentCompositeDecorator.Experimental","DocumentDecorator","EditorState","StickerTriggerHighlightSpan.react","React","StickerSearch","createContentStateFromBlocks","createPlainBlocksFromText","createInitialEditorState","emptyFunction","getDefaultKeyBinding"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=q.thatReturnsNull,t=l.createClass({displayName:'ChatInput',propTypes:{blockStyleFn:l.PropTypes.func,getTriggeredWordFn:l.PropTypes.func,initializeThingsWithInputFn:l.PropTypes.func,inlineStyleFn:l.PropTypes.func,inputChanged:l.PropTypes.func,inputKeyDown:l.PropTypes.func,isTriggerValid:l.PropTypes.func,keyBindingFn:l.PropTypes.func,onBlur:l.PropTypes.func,onEscape:l.PropTypes.func,onFocus:l.PropTypes.func,onTab:l.PropTypes.func,resizeFn:l.PropTypes.func},getDefaultProps:function(){return {blockStyleFn:s,inlineStyleFn:s,keyBindingFn:r};},componentDidMount:function(){this.props.resizeFn();this._oldHeight=this.getDOMNode().getBoundingClientRect().height;this.props.initializeThingsWithInputFn(this.refs.input.getDOMNode(),this.getValue.bind(this));},componentDidUpdate:function(){var u=this.getDOMNode().getBoundingClientRect().height;if(this._oldHeight!==u)this.props.resizeFn();this._oldHeight=u;},getInitialState:function(){var u=o(['']),v=p(n(u),this._getStickerTagDecorator());return {editorState:j.moveFocusToEnd(v)};},resetState:function(){this.setState(this.getInitialState());},_getStickerTagDecorator:function(){var u=function(v,w){var x=v.getText(),y=m.findTriggeredWord(x);if(y===null||!this.props.isTriggerValid())return;var z,aa,ba;if(y.match(/\W/)){ba=new RegExp(y.replace(/(\W)/g,'\\$1'),'gi');}else ba=new RegExp('\\b'+y+'\\b','gi');while((z=ba.exec(x))!==null){aa=z.index;w(aa,aa+y.length);}}.bind(this);return new h([new i(u,k)]);},onChange:function(u){if(u.getCurrentContent()!==this.state.editorState.getCurrentContent())this.props.inputChanged(this.getValueFromEditorState(u));this.setState({editorState:u});},onReturn:function(event){this.props.inputKeyDown(event,this.getValue());this.resetState();return true;},getValueFromEditorState:function(u){return u.getCurrentContent().getPlainText();},getValue:function(){return this.getValueFromEditorState(this.state.editorState);},focus:function(){this.refs.input.focus();},_onPasteFiles:function(u){var v=/^image\//,w=u.filter(function(x){return v.test(x.type);});if(w.length)this.props.uploadPhotoFn(w[0]);},render:function(){return (l.createElement(g,Object.assign({ref:"input"},this.props,{editorState:this.state.editorState,onChange:this.onChange,onPasteFiles:this._onPasteFiles,handleReturn:this.onReturn})));}});e.exports=t;},null);
__d("getImageSize",["DataViewPolyfill"],function(a,b,c,d,e,f,g){var h=a.DataView||g;function i(m){return {width:m.getUint16(6,true),height:m.getUint16(8,true)};}function j(m){return {width:m.getUint32(16,false),height:m.getUint32(20,false)};}function k(m){var n=m.byteLength,o=2;while(o<n){var p=m.getUint16(o,false);o+=2;if(p==65472||p==65474){return {width:m.getUint16(o+5,false),height:m.getUint16(o+3,false)};}else o+=m.getUint16(o,false);}return null;}function l(m){var n=new h(m);if(n.getUint8(0)==255&&n.getUint8(1)==216)return k(n);if(n.getUint8(0)==71&&n.getUint8(1)==73&&n.getUint8(2)==70)return i(n);if(n.getUint8(0)==137&&n.getUint8(1)==80&&n.getUint8(2)==78&&n.getUint8(3)==71)return j(n);return null;}e.exports=l;l.gif=i;l.png=j;l.jpeg=k;},null);
__d("ChatAutoSendPhotoUploader",["ArbiterMixin","AsyncUploadRequest","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","JpegResizer","MercuryAttachmentType","PhotosMimeType","PhotosUploadID","SubscriptionsHandler","arrayContains","csx","getImageSize","getObjectValues","invariant","isEmpty","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){"use strict";function aa(){return 'upload_'+r.getNewID();}var ba=z(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(fa,ga,ha){this.$ChatAutoSendPhotoUploader0=ha;this.$ChatAutoSendPhotoUploader1=ga;this.$ChatAutoSendPhotoUploader2=new s();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};this.$ChatAutoSendPhotoUploader5=fa.getAttribute('action');this.$ChatAutoSendPhotoUploader6=new k(fa,[n,l]);this.$ChatAutoSendPhotoUploader6.setAllowCrossOrigin(true);this.$ChatAutoSendPhotoUploader6.setUploadInParallel(true);var ia=i.find(fa,"._4q60"),ja=i.find(ia,"._4q61");new m(ia,ja,ga);this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.$ChatAutoSendPhotoUploader6.subscribe('submit',this.$ChatAutoSendPhotoUploader7.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('success',this.$ChatAutoSendPhotoUploader8.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('progress',this.$ChatAutoSendPhotoUploadera.bind(this)),j.listen(ja,'click',function(){if(this.$ChatAutoSendPhotoUploaderb)if(o.prepareResource)o.prepareResource();this.inform('open');}.bind(this)));this.$ChatAutoSendPhotoUploaderb=o.isSupported();if(this.$ChatAutoSendPhotoUploaderb)this.$ChatAutoSendPhotoUploader6.setPreprocessHandler(this.$ChatAutoSendPhotoUploaderc.bind(this));}ea.prototype.isUploading=function(){return !y(this.$ChatAutoSendPhotoUploader3);};ea.prototype.destroy=function(){this.$ChatAutoSendPhotoUploader2.release();this.$ChatAutoSendPhotoUploader6.destroy();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};};ea.prototype.$ChatAutoSendPhotoUploaderd=function(fa,ga){var ha=this.$ChatAutoSendPhotoUploadere(fa);if(ga){ha.preview_width=ga.width;ha.preview_height=ga.height;}return ha;};ea.prototype.$ChatAutoSendPhotoUploadere=function(fa){var ga={upload_id:fa,on_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('progress',ha));}.bind(this),on_resizing_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('resize_progress',ha));}.bind(this),on_success:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('success',ha));}.bind(this),upload_canceled:this.$ChatAutoSendPhotoUploaderf.bind(this),attach_type:p.PHOTO,preview_uploading:true};return ga;};ea.prototype.$ChatAutoSendPhotoUploaderc=function(fa,ga){var ha=fa.getFile();if(!q(ha.type).isJpeg())return ga(fa);o.getSingleton().resizeBlob(ha,function(ia,ja,ka){if(ja)fa.setFile(ja);ga(fa);},this.$ChatAutoSendPhotoUploaderg.bind(this,fa));};ea.prototype.$ChatAutoSendPhotoUploader7=function(){var fa=aa();this.$ChatAutoSendPhotoUploaderh(fa,this.$ChatAutoSendPhotoUploader1.files);};ea.prototype.$ChatAutoSendPhotoUploaderh=function(fa,ga){var ha={};if(typeof FileReader!=='undefined'&&FileReader.prototype.readAsArrayBuffer&&ga&&ga.length===1){this.$ChatAutoSendPhotoUploader3[fa]=fa;ha[fa]=ga[0];var ia=new FileReader();ia.onload=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploaderd(fa,v(ia.result))]});}.bind(this);ia.onerror=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploadere(fa)]});}.bind(this);ia.readAsArrayBuffer(ga[0]);}else{var ja=[];if(!ga){this.$ChatAutoSendPhotoUploader3[fa]=fa;this.$ChatAutoSendPhotoUploader0.value=fa;ja.push(this.$ChatAutoSendPhotoUploadere(fa));}else for(var ka=0;ka<ga.length;++ka){var la=aa();ha[la]=ga[ka];this.$ChatAutoSendPhotoUploader3[la]=fa;ja.push(this.$ChatAutoSendPhotoUploadere(la));}this.inform('submit',{upload_id:fa,preview_attachments:ja});}if(Object.keys(ha).length>0)this.$ChatAutoSendPhotoUploader6.setFiles(ha);};ea.prototype.$ChatAutoSendPhotoUploader8=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);if(this.$ChatAutoSendPhotoUploader3[ga]){var ha=this.$ChatAutoSendPhotoUploader3[ga];delete this.$ChatAutoSendPhotoUploader3[ga];var ia=fa.response.getPayload();if(!this.$ChatAutoSendPhotoUploader4[ha])this.$ChatAutoSendPhotoUploader4[ha]=[];this.$ChatAutoSendPhotoUploader4[ha].push({id:ga,fbid:ia.metadata[0].image_id});this.inform('success',{upload_id:ga});if(!this.$ChatAutoSendPhotoUploaderj(ha))this.$ChatAutoSendPhotoUploaderk(ha);}};ea.prototype.$ChatAutoSendPhotoUploaderk=function(fa){x(!this.$ChatAutoSendPhotoUploaderj(fa));this.$ChatAutoSendPhotoUploader4[fa].sort(function(ha,ia){return ha.id<ia.id?-1:1;});var ga=this.$ChatAutoSendPhotoUploader4[fa].map(function(ha){return ha.fbid;});this.inform('all-uploads-completed',{upload_id:fa,image_ids:ga});delete this.$ChatAutoSendPhotoUploader4[fa];};ea.prototype.$ChatAutoSendPhotoUploadera=function(event,fa){this.inform('progress',{upload_id:fa.upload.getName(),event:fa.event});};ea.prototype.$ChatAutoSendPhotoUploaderg=function(fa,event){this.inform('resize_progress',{upload_id:fa.getName(),event:event});};ea.prototype.$ChatAutoSendPhotoUploaderj=function(fa){return t(w(this.$ChatAutoSendPhotoUploader3),fa);};ea.prototype.$ChatAutoSendPhotoUploader9=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);this.$ChatAutoSendPhotoUploaderl(ga,'last-upload-failed');return false;};ea.prototype.$ChatAutoSendPhotoUploaderf=function(fa){this.$ChatAutoSendPhotoUploaderl(fa,'last-upload-canceled');};ea.prototype.$ChatAutoSendPhotoUploaderl=function(fa,ga){if(!this.$ChatAutoSendPhotoUploader3[fa])return;var ha=this.$ChatAutoSendPhotoUploader3[fa];delete this.$ChatAutoSendPhotoUploader3[fa];if(!this.$ChatAutoSendPhotoUploaderj(ha))if(this.$ChatAutoSendPhotoUploader4[ha]){this.$ChatAutoSendPhotoUploaderk(ha);}else this.inform(ga,{upload_id:ha});};ea.prototype.$ChatAutoSendPhotoUploaderi=function(fa){if(fa.upload){return fa.upload.getName();}else return fa.response.getPayload().uploadID;};ea.prototype.uploadFile=function(fa){var ga=aa(),ha={};ha[ga]=fa;var ia=new h(this.$ChatAutoSendPhotoUploader5).setAllowCrossOrigin(true).setRelativeTo(this.$ChatAutoSendPhotoUploader6.getRoot()).setFiles(ha);this.$ChatAutoSendPhotoUploader2.addSubscriptions(ia.subscribe('success',function(event,ja){this.$ChatAutoSendPhotoUploader8(event,{upload:ja,response:ja.getResponse()});}.bind(this)),ia.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)));ia.send();this.$ChatAutoSendPhotoUploaderh(ga,[fa]);};e.exports=ea;},null);
__d("ChatPhotoUploader.react",["ChatAutoSendPhotoUploader","Image.react","InlineBlock.react","Link.react","MercuryConfig","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r=l.createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:l.PropTypes.string,onSubmit:l.PropTypes.func,onAllUploadsComplete:l.PropTypes.func,onLastUploadFail:l.PropTypes.func,onLastUploadCancel:l.PropTypes.func},getDefaultProps:function(){return {actionURI:k.upload_url,onSubmit:o,onAllUploadsComplete:o,onLastUploadFail:o,onLastUploadCancel:o};},componentDidMount:function(){this._uploader=new g(this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this._subscriptions=new m();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled));},shouldComponentUpdate:function(s,t){return s.actionURI!=this.props.actionURI;},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},render:function(){return (l.createElement(l.DOM.form,{action:this.props.actionURI,method:"post",ref:"form"},l.createElement(l.DOM.input,{type:"hidden",name:"attach_id",ref:"attachID"}),l.createElement(l.DOM.input,{type:"hidden",name:"images_only",value:true}),l.createElement(i,{className:"_m _4q60 _3rzn"},l.createElement(j,{className:"_4q61 _509v"},l.createElement(h,{className:"_509w",src:q('/images/chat/chat_camera_icon.png'),alt:"Camera"})),l.createElement(l.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:"image/*",ref:"input"}))));},_handleSubmit:function(s,t){this.props.onSubmit(s,t);},_handleAllUploadsCompleted:function(s,t){this.props.onAllUploadsComplete(s,t);},_handleLastUploadFailed:function(s,t){this.props.onLastUploadFail(s,t);},_handleLastUploadCanceled:function(s,t){this.props.onLastUploadCancel(s,t);},isUploading:function(){return this._uploader&&this._uploader.isUploading();},uploadFile:function(s){this._uploader.uploadFile(s);}});e.exports=r;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){var k=function(l,m){this._userID=l;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case k.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var n=function(){m&&m(this._getState());}.bind(this);n();this._subscribeToken=i.subscribe('privacy-changed',n);}.bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';j(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){i.unsubscribe(this._subscribeToken);}});e.exports=k;},null);
__d("ChatShareLinkUploader",["AsyncRequest","CSS","DOM","URLScraper","MercuryShareLinkUploader","MercuryAttachmentTemplates","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in k)if(k.hasOwnProperty(n))p[n]=k[n];var o=k===null?null:k.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=k;function p(q,r,s,t){"use strict";this.$ChatShareLinkUploader0=q;this.$ChatShareLinkUploader1=r;this.$ChatShareLinkUploader2=s;this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader6=t;m.listen(r,'keyup',function(){var u=t?t():r.value;!u.length&&this.$ChatShareLinkUploader7.enable();}.bind(this));this.$ChatShareLinkUploader7=new j(r,t);this.$ChatShareLinkUploader7.subscribe('match',function(u,v){this.loadShare(v&&v.url);}.bind(this));this.$ChatShareLinkUploader8=null;}p.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$ChatShareLinkUploader3,this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader1,this.$ChatShareLinkUploader6);};p.prototype.close=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.disable();this.inform('closed');};p.prototype.clear=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.enable();};p.prototype.$ChatShareLinkUploader9=function(){"use strict";var q=this.$ChatShareLinkUploader8;delete this.$ChatShareLinkUploader8;if(q){i.remove(q);this.inform('dom-updated');}this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader7&&this.$ChatShareLinkUploader7.reset();};p.prototype.loadShare=function(q,r){"use strict";this.$ChatShareLinkUploader4=q;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();var s=l[':fb:mercury:share-link-row'].build();if(this.$ChatShareLinkUploader8)i.remove(this.$ChatShareLinkUploader8);this.$ChatShareLinkUploader8=s.getRoot();m.listen(s.getNode('closeFileUpload'),'click',function(event){this.close();event.kill();}.bind(this));i.appendContent(this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader8);h.show(this.$ChatShareLinkUploader0);this.inform('dom-updated');var t={u:q,chat:true,extra_params:JSON.stringify(r)};this.$ChatShareLinkUploader5=new g().setMethod('POST').setURI('/ajax/share_scrape.php').setData(t).setHandler(this.$ChatShareLinkUploadera.bind(this).bind(null,q));this.$ChatShareLinkUploader5.send();this.inform('link-detected');};p.prototype.$ChatShareLinkUploadera=function(q,r){"use strict";if(this.$ChatShareLinkUploader4!==q)return;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;i.appendContent(this.$ChatShareLinkUploader8,r.payload);this.$ChatShareLinkUploader2();this.$ChatShareLinkUploader3=true;if(!this.getAttachData()){this.close();return;}h.addClass(this.$ChatShareLinkUploader8,'done');};e.exports=p;},null);
__d("StickerContextualDialog.react",["ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=47,k=h.createClass(g.createSpec({displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:j,length:16}}}));k.WIDTH={NORMAL:312,WIDE:400};e.exports=k;},null);
__d("ChatStickerButton.react",["BanzaiODS","React","ReactLayeredComponentMixin","StickerContextualDialog.react","StickersFlyout.react","StickerState","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p=278,q=h.createClass({displayName:'ChatStickerButton',propTypes:{onStickerSelect:h.PropTypes.func,onEmoticonSelect:h.PropTypes.func,onFlyoutShown:h.PropTypes.func,onFlyoutHidden:h.PropTypes.func,packID:h.PropTypes.string},getInitialState:function(){return {shown:false};},mixins:[i],getDefaultProps:function(){return {onStickerSelect:n,onEmoticonSelect:n};},componentDidMount:function(){g.bumpEntityKey('chat.web','sticker_button.mounted');this._subscription=l.addListener(l.PACK_SELECTED,function(r){return this.setProps({packID:r});}.bind(this));},shouldComponentUpdate:function(r,s){return (r.packID!=this.props.packID||s.shown!=this.state.shown);},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){return (h.createElement(h.DOM.a,{className:"_4vuh",onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:"Choose a sticker or emoticon",ref:"link"},h.createElement(h.DOM.div,{className:(("_4vui")+(this.state.shown?' '+"open":''))})));},renderLayers:function(){return {contextualDialog:h.createElement(j,{alignment:"left",className:"_5e-r",contextRef:"link",onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:p},h.createElement(h.DOM.div,null,h.createElement(k,{onShown:function(r){return this.props.onFlyoutShown&&this.props.onFlyoutShown(r);}.bind(this),onHidden:function(){return this.props.onFlyoutHidden&&this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,packID:this.props.packID,shown:this.state.shown})))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(){!this._clickGuard&&this.setState({shown:true});},_hideFlyout:function(){this.setState({shown:false});},_handleStickerSelected:function(r){this.props.onStickerSelect(r);},_handleEmoticonSelected:function(r){this._hideFlyout();this.props.onEmoticonSelect(r);}});e.exports=q;},null);
__d("ChatTabMenu.react",["ChatFileUploader.react","ChatPrivacyActionController","ChatConfig","MercuryConfig","MercuryThreadMuter","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Toggler","TrackingNodes","WebMessengerThreadPermalinks","cx","fbt","goURI","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';var v=b('MercuryThreads').get(),w=n.Item,x=l.createClass({displayName:'ChatTabMenu',propTypes:{onFileUploaderMounted:l.PropTypes.func,updatePrivacyLinkFunc:l.PropTypes.func,nameConversationFunc:l.PropTypes.func,leaveConversationFunc:l.PropTypes.func,showParticipantsFunc:l.PropTypes.func,clearHistoryFunc:l.PropTypes.func,reportSpamFunc:l.PropTypes.func,createGroupFunc:l.PropTypes.func,isMultichat:l.PropTypes.bool,showAddFriend:l.PropTypes.func,threadID:l.PropTypes.string,attachmentsShelf:l.PropTypes.object,onUploadFinished:l.PropTypes.func,onUpdateAttachmentsShelf:l.PropTypes.func,onSubmit:l.PropTypes.func,enableDesktopNotif:l.PropTypes.func},getDefaultProps:function(){return {show:true};},componentWillMount:function(){if(!this.props.isMultiChat)this._privacyActionController=new h(v.getCanonicalUserInThread(this.props.threadID),this.props.updatePrivacyLinkFunc);},componentDidMount:function(){if(!this.props.fullURL){var y=this;r.getThreadURI(this.props.threadID,function(z){y.setProps({fullURL:z});});}},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();},_unmuteThread:function(){v.updateThreadMuteSetting(this.props.threadID,0);p.hide();},_renderFileUploader:function(){return (l.createElement(w,{className:"_37_x"},l.createElement(g,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.props.fullURL)return (l.createElement(w,{onclick:function(){return u(this.props.fullURL);}.bind(this)},"See Full Conversation"));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (l.createElement(w,{onclick:this.props.showAddFriend},"Add Friends to Chat..."));},_renderTogglePrivacy:function(){if(!this.props.isMultichat){var y=this._privacyActionController.togglePrivacy.bind(this._privacyActionController);return (l.createElement(w,{onclick:y},this.props.privacyText));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var y=k.showMuteChangeDialog.bind(null,this.props.threadID);return (l.createElement(w,{onclick:y},"Mute Conversation..."));}else return (l.createElement(w,{onclick:this._unmuteThread},"Unmute Conversation"));},_renderClearConversation:function(){if(!this.props.isMultichat)return (l.createElement(w,{onclick:this.props.clearHistoryFunc},"Clear Window"));return null;},_renderReportSpam:function(){if(!this.props.isMultichat)return (l.createElement(w,{onclick:this.props.reportSpamFunc},"Report as Spam or Abuse..."));return null;},_renderCreateGroup:function(){if(this.props.isMultichat&&i.get('group_create_multichat_dock'))return (l.createElement(w,{onclick:this.props.createGroupFunc},"Create Group"));return null;},_renderConversationName:function(){if(this.props.isMultichat&&this.props.fullURL)return (l.createElement(w,{onclick:this.props.nameConversationFunc},"Edit Conversation Name"));return null;},_renderLeaveConversation:function(){if(this.props.isMultichat)return (l.createElement(w,{onclick:this.props.leaveConversationFunc},"Leave Conversation..."));return null;},_renderEnableDesktopNotifications:function(){if(j.DesktopNotificationsGK&&"Notification" in window&&Notification.permission!=="granted")return (l.createElement(w,{onclick:this.props.enableDesktopNotif},"Enable Desktop Notifications"));return null;},_renderPeopleList:function(){if(this.props.isMultichat&&this.props.fullURL&&i.get('chat_remove_participants'))return (l.createElement(w,{onclick:this.props.showParticipantsFunc},"Edit Participants..."));return null;},render:function(){var y=this._renderReportSpam(),z=this._renderCreateGroup(),aa=l.createElement(n,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),l.createElement(o,null),this._renderMuteConversation(),this._renderClearConversation(),this._renderLeaveConversation(),y?(l.createElement(o,null)):null,y,z?(l.createElement(o,null)):null,z,this._renderEnableDesktopNotifications()),ba="Options",ca=q.getTrackingInfo(q.types.DROPDOWN_BUTTON);return (l.createElement(m,{menu:aa},l.createElement(l.DOM.a,{'data-ft':ca,'data-hover':"tooltip",'aria-label':ba,'data-tooltip-alignh':"center",className:"button"})));}});e.exports=x;},null);
__d("ChatDateBreak.react",["React","ReactPropTypes","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'ChatDateBreak',propTypes:{date:h.instanceOf(Date).isRequired},shouldComponentUpdate:function(n){return this.props.date.getTime()!==n.date.getTime();},render:function(){var n=this.props.date,o=k(n,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'}),p=Math.round(n.getTime()/1000);return (g.createElement(g.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5w-5")}),g.createElement(g.DOM.div,{className:"_5w-6"},g.createElement(i,{time:p,verbose:o,text:o}))));}});e.exports=m;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","ReactPropTypes","React","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=86400000,n=i.createClass({displayName:'ChatAuthorPhotoBlock',propTypes:{authorID:h.string.isRequired,hideName:h.bool,hidePhoto:h.bool,timestamp:h.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(o){if(o.authorID!=this.state.author.id)this.updateAuthor(o.authorID);},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (i.createElement(i.DOM.div,{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var o=null;if(this.props.timestamp){var p=(Date.now()-this.props.timestamp>m)?'M jS, g:ia':'g:ia';o=k(new Date(this.props.timestamp),p);}return (i.createElement(i.DOM.a,{'aria-label':o,className:"_5ys_",'data-hover':"tooltip",'data-tooltip-position':"left",href:this.state.author.href,ref:"link"},i.createElement(i.DOM.img,{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(o){g.get(o,function(p){this.isMounted()&&this.setState({author:p});}.bind(this));}});e.exports=n;},null);
__d("ChatBubble.react",["DOM","DOMDimensions","MercuryMessageRenderer","ReactPropTypes","React","cx","fbt","startsWith","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=null,q=k.createClass({displayName:'ChatBubble',propTypes:{attachments:j.renderable,body:j.string,maxWidth:j.number.isRequired},getInitialState:function(){return {bubbleWidth:this.props.maxWidth};},componentDidMount:function(){this.renderDOMBody();this.shrinkBubble();},componentWillReceiveProps:function(r){if(r.body!=this.props.body)this.setState({bubbleWidth:this.props.maxWidth});},componentDidUpdate:function(r,s){this.renderDOMBody();if(r.body!=this.props.body)this.shrinkBubble();},render:function(){return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:o(this.props.className,"_5w1r"),ref:"bubble",style:Object.assign({},(this.props.style||{}),{maxWidth:this.state.bubbleWidth})}),k.createElement(k.DOM.div,null,k.createElement(k.DOM.span,{className:"_5yl5",ref:"content"},this.renderBody())),this.props.attachments));},renderBody:function(){var r=this.props.body||'';if(n(r,'?OTR'))return (k.createElement(k.DOM.span,{className:"_89h"},"[encrypted message]"));return r;},renderDOMBody:function(){var r=this.props.body||'';if(!n(r,'?OTR'))g.setContent(this.refs.content.getDOMNode(),i.formatMessageBody(r));},shrinkBubble:function(){var r=this.refs.bubble.getDOMNode(),s=this.refs.content.getDOMNode(),t=h.getElementDimensions(r).width,u=h.getElementDimensions(s).width;if(this.contentWraps()&&u>0&&u<this.props.maxWidth&&t-u-this.getBoxWidth()>0&&u!=this.state.bubbleWidth)this.setState({bubbleWidth:u});},contentWraps:function(){var r=this.refs.content.getDOMNode(),s=r.getClientRects(),t=h.getElementDimensions(r).height;return (s&&s.length>1&&s[0].height<t);},getBoxWidth:function(){if(!p)p=h.measureElementBox(this.refs.bubble.getDOMNode(),'width',true,true,false);return p;}});e.exports=q;},null);
__d("MercuryAttachments.react",["MercuryAttachmentRenderer","DOM","Event","ImmutableObject","React","SubscriptionsHandler","arraySort","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=176,r=4,s=k.createClass({displayName:'MercuryAttachments',propTypes:{message:k.PropTypes.instanceOf(j).isRequired,attachments:k.PropTypes.array.isRequired,isChat:k.PropTypes.bool,onImageLoad:k.PropTypes.func,onStickerClick:k.PropTypes.func},getDefaultProps:function(){return {isChat:false,onImageLoad:o,onStickerClick:o};},componentDidMount:function(){this._subscriptionsHandler=new l();this.renderAttachments();},componentDidUpdate:function(){this.renderAttachments();},componentWillUnmount:function(){this._subscriptionsHandler.release();},render:function(){var t=this.props.attachments.filter(g.isPhotoAttachment).length>0;return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:p(this.props.className,(("_5h9y")+(t?' '+"_zl6":'')))})));},renderAttachments:function(){var t=this.getDOMNode();h.empty(t);var u=this.props.message,v=m(this.props.attachments,g.booleanLexicographicComparator([g.isPhotoAttachment,g.isShareAttachment,g.isFileAttachment,g.isErrorAttachment])),w=g.renderPhotoAttachments(v.filter(g.isPhotoAttachment),u,q,r);w&&h.appendContent(t,w);for(var x=0;x<v.length;x++){var y=v[x];if(g.isPhotoAttachment(y))continue;var z=g.renderAttachment(this.props.isChat,y,u,null,null,this.props.onStickerClick);z.error&&h.appendContent(t,z.error);z.content&&h.appendContent(t,z.content);}h.scry(t,'img').forEach(function(aa){this._subscriptionsHandler.addSubscriptions(i.listen(aa,'load',function(){this.props.onImageLoad(aa);}.bind(this)));}.bind(this));}});e.exports=s;},null);
__d("MercurySpoofWarning.react",["MercuryParticipants","ReactPropTypes","React","fbt"],function(a,b,c,d,e,f,g,h,i,j){var k=i.createClass({displayName:'MercurySpoofWarning',propTypes:{authorID:h.string.isRequired},getInitialState:function(){return {author:{name:''}};},componentWillMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(l){g.get(l.authorID,function(m){return this.setState({author:m});}.bind(this));},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props),j._("Unable to confirm {name_or_email} as the sender.",[j.param("name_or_email",this.state.author.name)])));}});e.exports=k;},null);
__d("ChatMessage.react",["ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","ChatConfig","CSS","ImmutableObject","MercuryAttachment","MercuryAttachments.react","MercuryAttachmentRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercurySpoofWarning.react","React","ReactPropTypes","cx","fbt","formatDate","isRTL","joinClasses","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){'use strict';var aa=b('MercuryMessages').get(),ba=t.createClass({displayName:'ChatMessage',propTypes:{message:u.instanceOf(l).isRequired,maxBubbleWidth:u.number.isRequired,onImageLoad:u.func,onStickerClick:u.func},componentDidMount:function(){k.conditionClass(this.getDOMNode(),"_2cnu",this.isOneLine());},isOneLine:function(){var ca=this.props.message;return aa.isInbound(ca)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps();},shouldComponentUpdate:function(ca,da){return ca.message!==this.props.message;},render:function(){var ca=this.props.message,da=aa.isInbound(ca),ea=q.isMultichat(ca.thread_id),fa=y(ca.body),ga=j.get('chat_fading_bubbles')&&!da&&aa.isSending(ca),ha=p.hasErrorStatus(ca),ia=(("_5wd4")+(da?' '+"_1nc7":'')+(!da?' '+"_1nc6":'')+(da&&ea?' '+"_5ysy":'')+(ga?' '+"_4oe5":'')+(ha?' '+"_1zcs":'')+(fa?' '+"direction_rtl":'')+(!fa?' '+"direction_ltr":'')),ja=new Date(ca.timestamp);return (t.createElement(h,Object.assign({},this.props,{authorID:ca.author,className:z(this.props.className,ia),hideName:!da||!ea,hidePhoto:!da,timestamp:ca.timestamp,title:da?null:x(ja,'g:ia')}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){if(this.props.message.is_filtered_content)return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderFilteredContent()));return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (t.createElement(t.DOM.div,{className:"_3ry4",ref:"undertext"},t.createElement(r,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?t.createElement(s,{authorID:this.props.message.author,className:"_5wdb"}):null);},_renderFilteredContent:function(){return t.createElement(t.DOM.div,{className:"_5wdc uiBoxYellow clearfix"},"This message is no longer available because it was identified as abusive or marked as spam.");},_renderAttachments:function(ca){var da=this.props.message,ea=ca=='inside'?'attachmentsInside':'attachmentsOutside',fa=m.get(da).filter(function(ga){var ha=o.isBubblePreferred(ga);return (ha&&ca==='inside')||(!ha&&ca==='outside');});if(fa.length>0)return t.createElement(n,{className:"_5wdd clearfix",isChat:true,message:da,attachments:fa,ref:ea,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick});},_renderBubble:function(){var ca=this.props.message,da=ca.body,ea=this._renderAttachments('inside');if(g.shouldHideBody(ca))da='';if(da||ea)return (t.createElement(t.DOM.div,{className:"_5wde"},t.createElement(i,{attachments:ea,body:da,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ref:"bubble"})));}});e.exports=ba;},null);
__d("ChatVideoCallLink.react",["Arbiter","ChatVisibility","MercuryParticipants","PresencePrivacy","React","ReactPropTypes","SubscriptionsHandler","VideoCallCore","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=k.createClass({displayName:'ChatVideoCallLink',propTypes:{message:l.object.isRequired,onClick:l.func.isRequired},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(g.subscribe(['buddylist/availability-changed'],this.availabilityChanged),j.subscribe(['privacy-changed','privacy-availability-changed'],this.availabilityChanged));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){return (k.createElement(k.DOM.a,{className:(("callBackLink")+(this.shouldHideLink()?' '+"hidden_elem":'')),'data-gt':JSON.stringify({videochat:'clicked_callback_link'}),href:"#",onClick:this.linkClicked},this.renderLinkText()));},renderLinkText:function(){if(this.props.message.log_message_data.event_name=='install_canceled'){return ("Retry setup and call back.");}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)return ("Call back.");},shouldHideLink:function(){return !h.isOnline()||!n.availableForCall(this.props.message.log_message_data.to);},linkClicked:function(){var r;if(this.props.message.log_message_data.event_name=='install_canceled'){r='callback_cancelinstall_link';}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)r='callback_link';this.props.onClick(this.props.message.log_message_data.to,this.props.message.thread_id,r);},availabilityChanged:function(){this.forceUpdate();}});e.exports=q;},null);
__d("MercuryLogMessage.react",["DOM","Event","ChatVideoCallLink.react","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","React","ReactPropTypes","VideoCallSupport","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';var t=m.createClass({displayName:'MercuryLogMessage',propTypes:{message:n.instanceOf(j).isRequired,onImageLoad:n.func,onVideoCallLinkClick:n.func},getDefaultProps:function(){return {onImageLoad:q};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(u){k.renderText(u.message,function(v){this.setState({messageText:v});}.bind(this));},shouldComponentUpdate:function(u,v){return this.state.messageText!=v.messageText;},componentDidUpdate:function(){var u=this.refs.attachment.getDOMNode();k.renderAttachmentLegacy(u,this.props.message);g.scry(u,'img').forEach(function(v){var w=h.listen(v,'load',function(){this.props.onImageLoad(v);w.remove();}.bind(this));}.bind(this));},render:function(){return (m.createElement(m.DOM.div,Object.assign({},this.props,{className:s(this.props.className,"_5ye6"),title:r(new Date(this.props.message.timestamp),'g:ia')}),k.renderIcon(this.props.message),m.createElement(m.DOM.div,{className:"_5ye7"},this.state.messageText,this.renderVideoCallLink()),m.createElement(m.DOM.div,{className:"_5ye8",ref:"attachment"})));},renderVideoCallLink:function(){if(this.props.message.log_message_type!==l.VIDEO_CALL||!this.props.onVideoCallLinkClick||!o.isVideoCallSupported())return null;return (m.createElement(i,{message:this.props.message,onClick:this.props.onVideoCallLinkClick}));}});e.exports=t;},null);
__d("ChatConversation.react",["ChatConfig","ChatDateBreak.react","ChatMessage.react","CurrentUser","MercuryConstants","ImmutableObject","MercuryActionTypeConstants","MercuryLogMessage.react","React","cx","invariant","OrionMercuryReceiverNUX"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r=b('OrionMercuryReceiverNUX').module,s=k.MercurySupportedShareType,t=1000*60*60,u=o.createClass({displayName:'ChatConversation',propTypes:{maxBubbleWidth:o.PropTypes.number.isRequired,messages:o.PropTypes.arrayOf(o.PropTypes.instanceOf(l)).isRequired,onCallLinkClick:o.PropTypes.func,onImageLoad:o.PropTypes.func,onStickerClick:o.PropTypes.func},componentWillReceiveProps:function(v){q(v.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){var v=this.props.messages,w=[];for(var x=0;x<v.length;x++){var y=v[x],z=(x>0)?v[x-1]:null;if(y.is_cleared)continue;if(!z||z.is_cleared||y.timestamp-z.timestamp>t)w.push(o.createElement(h,{date:new Date(y.timestamp),key:'db:'+y.message_id}));if(y.action_type==m.LOG_MESSAGE){w.push(o.createElement(n,{className:"_5w0o",key:y.message_id,message:y,onImageLoad:this.props.onImageLoad,onCallLinkClick:this.props.onCallLinkClick}));}else w.push(o.createElement(i,{key:y.message_id,message:y,maxBubbleWidth:this.props.maxBubbleWidth,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick}));if(r&&!g.get('orion_receiver_nux_completed')&&y.attachments&&y.attachments.length&&y.attachments[0].share_data_type===s.FB_ORION&&y.attachments[0].metadata&&y.attachments[0].metadata.receiver&&y.attachments[0].metadata.receiver.id===j.getID()){var aa=y.attachments[0],ba=aa.metadata;w.push(o.createElement(r,{key:'omrn:'+y.message_id,amount:ba.amount,currency:ba.currency,creationTime:ba.creationTime,onImageLoad:this.props.onImageLoad,sender:ba.sender}));}}return o.createElement(o.DOM.div,null,w);}});e.exports=u;},null);
__d("ChatTypingIndicators.react",["ChatAuthorPhotoBlock.react","DOM","MercuryIDs","MercuryParticipants","ReactPropTypes","React","SubscriptionsHandler","Tooltip","MercuryTypingReceiver","arraySort","createObjectFrom","cx","emptyFunction","fbt","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b('MercuryThreadInformer').get(),v=l.createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorsWillShow:k.func,indicatorsDidShow:k.func,threadID:k.string.isRequired},getDefaultProps:function(){return {indicatorsWillShow:s,indicatorsDidShow:s};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(o.addRetroactiveListener('state-changed',this.typingStateChanged),u.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(w){if(w.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(w,x){if(x.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();j.getMulti(this.state.typingUserIDs,function(w){if(this.isMounted())this.state.typingUserIDs.forEach(function(x){var y=w[x];n.set(this.refs[x].getDOMNode(),this.renderTooltip(y.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var w=i.isMultichat(this.props.threadID);return (l.createElement(l.DOM.div,{className:"_2fsr"},this.state.typingUserIDs.map(function(x){return l.createElement(g,{authorID:x,className:(("_gfq")+(w?' '+"_52fu":'')),hideName:!w,key:x},l.createElement(l.DOM.div,{className:"_52ft"},l.createElement(l.DOM.div,{className:"_gfp",ref:x})));})));},renderTooltip:function(w){var x=h.create('span');l.renderComponent(l.createElement(l.DOM.span,null,t._("{name} is typing...",[t.param("name",w)])),x);return x;},typingStateChanged:function(w){if(this.props.threadID in w)this.setState({typingUserIDs:p(w[this.props.threadID])});},messagesReceived:function(w,x){if(this.props.threadID in x){var y=x[this.props.threadID],z=q(y.map(function(aa){return aa.author;}));this.setState({typingUserIDs:p(this.state.typingUserIDs.filter(function(aa){return !z[aa];}))});}}});e.exports=v;},null);
__d("MercuryTypingAnimation.react",["React","cx"],function(a,b,c,d,e,f,g,h){'use strict';var i=g.createClass({displayName:'MercuryTypingAnimation',propTypes:{color:g.PropTypes.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var j=(("_4a0v")+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":''));return (g.createElement(g.DOM.div,{className:j},g.createElement(g.DOM.div,{className:"_4a0y"}),g.createElement(g.DOM.div,{className:"_4a0y"}),g.createElement(g.DOM.div,{className:"_4a0y"})));}});e.exports=i;},null);
__d("MercuryTypingIndicator",["Animation","ChatConfig","CSS","DOM","MercuryTypingAnimation.react","MercuryTypingReceiver","MercuryParticipants","React","Style","ChatTabTemplates","Tooltip","copyProperties","cx","csx","tx","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=b('MercuryThreadInformer').get(),w=[];v.subscribe('messages-received',function(z,aa){w.forEach(function(ba){var ca=aa[ba._threadID];ca&&ba.receivedMessages(ca);});});l.addRetroactiveListener('state-changed',function(z){w.forEach(function(aa){var ba=z[aa._threadID];ba&&aa._handleStateChanged(ba);});});function x(z){var aa=p[':fb:chat:conversation:message-group'].build(),ba=p[':fb:mercury:typing-indicator:typing'].build();i.addClass(aa.getRoot(),"_50kd");var ca=aa.getNode('profileLink');q.set(ca,z.name,'left');ca.href=z.href;aa.setNodeContent('profileName',z.name);aa.setNodeProperty('profilePhoto','src',z.image_src);var da=u._("{name} is typing...",{name:z.short_name});q.set(ba.getRoot(),da,'above');j.appendContent(aa.getNode('messages'),ba.getRoot());return aa;}function y(z,aa,ba){this._animations={};this._activeUsers={};this._typingIndicator=aa;this._messagesView=ba;this._threadID=z;this._subscription=l.addRetroactiveListener('state-changed',function(ca){var da=ca[this._threadID];da&&this._handleStateChanged(da);}.bind(this));w.push(this);}r(y.prototype,{destroy:function(){Object.keys(this._activeUsers).forEach(this._removeUserBubble.bind(this));this._controller.destroy();w.remove(this);},receivedMessages:function(z){z.forEach(function(aa){if(!m.isAuthor(aa.author))this._removeUserBubble(aa.author);}.bind(this));},_handleStateChanged:function(z){for(var aa in this._activeUsers)if(z.indexOf(aa)===-1){this._slideOutUserBubble(aa);delete this._activeUsers[aa];}if(z.length)m.getMulti(z,function(ba){var ca=this._messagesView.isScrolledToBottom(),da={};for(var ea in ba){var fa=this._activeUsers[ea];da[ea]=fa||x(ba[ea]).getRoot();if(!fa){j.appendContent(this._typingIndicator,da[ea]);if(h.get('chat_thread_typing_indicator_animated')){var ga=j.find(this._typingIndicator,"._510u");n.renderComponent(n.createElement(k,null),ga);i.addClass(ga,"_3e2s");}}}var ha=Object.keys(da).length>0;ca&&this._messagesView.scrollToBottom(ha);this._activeUsers=da;}.bind(this));},_removeUserBubble:function(z,aa){var ba=this._getCurrentAnimation(z,aa);if(ba){ba.animation.stop();j.remove(ba.elem);delete this._animations[z];}if(z in this._activeUsers){j.remove(this._activeUsers[z]);delete this._activeUsers[z];}aa&&j.remove(aa);},_slideOutUserBubble:function(z){var aa=this._activeUsers[z];if(this._getCurrentAnimation(z,aa)){return;}else if(aa){o.set(aa,'overflow','hidden');var ba=(new g(aa)).from('opacity',1).from('height',aa.offsetHeight).to('height',0).to('opacity',0).ease(g.ease.end).duration(250).ondone(this._removeUserBubble.bind(this,z,aa)).go();this._animations[z]={animation:ba,elem:aa};}},_getCurrentAnimation:function(z,aa){if(this._animations[z]&&(!aa||this._animations[z].elem===aa))return this._animations[z];}});e.exports=y;},null);
__d("MercuryMessageList",["ImmutableObject","LogHistory","OrderedMap","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=h.getInstance('mercury_message_list');function l(q){this.$MercuryMessageList0=n(q?m(q):[]);}l.prototype.append=function(q){this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(q)));p('append',q);};l.prototype.prepend=function(q){this.$MercuryMessageList0=n(m(q)).merge(this.$MercuryMessageList0);p('prepend',q);};l.prototype.update=function(q){this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(q.filter(function(r){return this.contains(r);}.bind(this)))));p('update',q);};l.prototype.reorder=function(q){this.$MercuryMessageList0=n(q.map(function(r){var s=this.$MercuryMessageList0.get(r.message_id);if(!s||s.timestamp!=r.timestamp||s.is_cleared!=r.is_cleared)return new g(r);return s;}.bind(this)));p('reorder',q);};l.prototype.hasReachedClearedMessages=function(){var q=this.messageAt(0);return !!(q&&q.is_cleared);};l.prototype.messageAt=function(q){var r=this.$MercuryMessageList0.keyAtIndex(q);return r?this.$MercuryMessageList0.get(r):undefined;};l.prototype.contains=function(q){return this.$MercuryMessageList0.indexOfKey(o(q))!==undefined;};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toOrderedMap=function(){return this.$MercuryMessageList0;};function m(q){return q.map(function(r){return new g(r);});}function n(q){return i.fromArray(q,o);}function o(q){return q.message_id;}function p(event,q){j(function(){k.debug(event,{messageIDs:q.map(function(r){return r.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryMessageList","MercuryParticipants","SubscriptionsHandler","MercuryThreadlistConstants","copyProperties","merge","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreads","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=b('MercuryMessages').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadInformer').get(),t=h.getInstance('mercury_message_store');function u(w){this.$MercuryMessageStore0=w;this.$MercuryMessageStore1=new i();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=new k();this.$MercuryMessageStore5.addSubscriptions(s.subscribe('messages-received',function(x,y){return this.$MercuryMessageStore7(y);}.bind(this)),s.subscribe('messages-updated',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore8(y[this.$MercuryMessageStore0]);}.bind(this)),s.subscribe('messages-reordered',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9();}.bind(this)));this.$MercuryMessageStorea();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStoreb=w;};u.prototype.destroy=function(){this.$MercuryMessageStore5&&this.$MercuryMessageStore5.release();};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(q.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&q.hasLoadedAllMessages(this.$MercuryMessageStore0))return false;if(r.isNewEmptyLocalThread(this.$MercuryMessageStore0))return false;if(this.$MercuryMessageStore1.hasReachedClearedMessages())return false;return this.$MercuryMessageStorea();};u.prototype.$MercuryMessageStorea=function(){var w=this.$MercuryMessageStore4+l.RECENT_MESSAGES_LIMIT*this.$MercuryMessageStore2;q.getThreadMessagesRange(this.$MercuryMessageStore0,0,w,this.$MercuryMessageStorec.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(q.hasLoadedNMessages(this.$MercuryMessageStore0,w)){this.$MercuryMessageStore9();return false;}return true;};u.prototype.$MercuryMessageStorec=function(w){if(w&&w.length){this.$MercuryMessageStore3=w[0].timestamp;this.$MercuryMessageStore4=w.length;}};u.prototype.$MercuryMessageStore7=function(w){var x=[],y=w[this.$MercuryMessageStore0];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStoreb){var z=w[this.$MercuryMessageStoreb];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStoreb=null;}}if(x.length){this.$MercuryMessageStore1.append(x);this.$MercuryMessageStore4+=x.length;var aa=x.every(function(ba){return ba.author!=j.user;});this.$MercuryMessageStored(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore8=function(w){this.$MercuryMessageStore1.update(q.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStore9=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(q.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStored=function(w,x){var y=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',n({messages:y,eventType:w},x));v(this.$MercuryMessageStore0,w,y);};u.prototype.$MercuryMessageStoree=function(){var w=this.$MercuryMessageStore1.messageAt(0);if(w)this.$MercuryMessageStore3=w.timestamp;};function v(w,x,y){p(function(){t.debug('updated',{threadID:w,eventType:x,messageIDs:y.map(function(z){return z.message_id;})});},0);}m(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered'});o(u,{updated:true});e.exports=u;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","ArbiterMixin","BanzaiLogger","ChatConfig","ChatConversation.react","ChatTypingIndicators.react","CSS","DOM","Event","MercuryLastMessageIndicator.react","LiveTimer","MercuryTypingIndicator","MercuryMessageStore","MercuryParticipants","React","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","copyProperties","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){'use strict';var ha=70,ia=null,ja=20;function ka(ma){if(ia===null){var na=ma.childNodes[0];aa.set(ma,'overflow','scroll');ia=na.clientWidth-ha;aa.set(ma,'overflow','');}return ia;}function la(ma,na,oa,pa,qa,ra,sa,ta){this.loadingIcon=qa;this.threadID=ma;this.sheetController=na;this.scrollContainer=oa;this.conversationElem=pa;this.tabView=ta;r.restart(w.get()/1000);this._loadingMoreMessages=false;function ua(){la.inform('interaction-with-tab',ma);}this._subscriptions=new ba();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),p.listen(this.scrollContainer,'mousedown',ua));if(ca.firefox()){var va=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(va,ua,false);}else this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'mousewheel',ua));this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'scroll',ga(this.scrolling,50,this)));if(k.get('chat_react')){var wa;v.renderComponent(v.createElement(m,{threadID:this.threadID,indicatorsWillShow:function(){return wa=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return wa&&this.scrollToBottom(true);}.bind(this)}),sa);}else this.typingIndicator=new s(this.threadID,sa,this);var xa;this.lastMessageIndicatorNode=ra;this.lastMessageIndicator=v.renderComponent(v.createElement(q,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return xa=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return xa&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}ea(la,i);ea(la.prototype,{initializeConversation:function(){this._store=new t(this.threadID);this._conversation=v.renderComponent(v.createElement(l,{maxBubbleWidth:ka(this.scrollContainer),messages:[],onImageLoad:function(ma){var na=this.scrollContainer,oa=na.scrollTop+na.clientHeight;if(oa+ma.offsetHeight>=na.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this),onCallLinkClick:function(ma,na,oa){la.inform('video-call-clicked',{userID:ma,threadID:na,clickSource:oa});}}),this.conversationElem);this._subscriptions.addSubscriptions(this._store.subscribe(function(ma){if(ma.eventType==t.MESSAGES_RECEIVED&&ma.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(ma.eventType==t.MESSAGES_REORDERED){this._loadingMoreMessages=false;n.hide(this.loadingIcon);}var na=this.isScrolledToBottom(),oa=this._getLoadingHeight(),pa=this.scrollContainer.scrollHeight,qa=this.scrollContainer.scrollTop,ra=ma.messages;this._conversation.setProps({messages:ra},function(){if(na){this.scrollToBottom();}else if(ma.eventType==t.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-pa-oa+qa);}.bind(this));this.lastMessageIndicator.setProps({lastMessage:ra.length>0?ra[ra.length-1]:null});if(ma.eventType==t.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(ra)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();}.bind(this)));},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){n.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&this.scrollContainer.scrollTop;},destroy:function(){o.scry(this.conversationElem,'.stickerContainer').forEach(function(ma){return v.unmountComponentAtNode(ma);});v.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();v.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(ma){if(!y.shouldShowStickerReplyNUX()||!ma.length)return false;var na=ma[ma.length-1];if(na.author===u.user)return false;if(na.has_attachment)return na.attachments.some(function(oa){return oa.attach_type==='sticker';});return false;},isScrolledToBottom:function(ma){var na=this.scrollContainer;ma=ma||ja;return na.scrollTop+na.clientHeight>=na.scrollHeight-ma;},isScrolledNearTop:function(){return this.scrollContainer.scrollTop<this.scrollContainer.clientHeight;},scrollToBottom:function(ma){this.scrollToPosition(this.scrollContainer.scrollHeight,ma);},scrollToPosition:function(ma,na){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(na===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',ma).ease(g.ease.end).duration(400).go();}else this.scrollContainer.scrollTop=ma;},_onStickerClick:function(ma,na){if(!ma)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:ma,stickerid:na});var oa=this.tabView;y.onTrayDataReady(function(){if(da(y.getPackIDsInTray(),ma)){var pa=y.getPack(ma);if(pa&&pa.isPromoted)x.addPack(ma);oa.setStickersFlyoutPackID(ma);}else z.showStore(ma);});},_checkToAnimateSticker:function(){var ma=fa(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:this.scrollContainer.scrollTop,top:ma.y,viewHeight:ma.height});},setNewThreadID:function(ma){this._store.setNewThreadID(ma);}});e.exports=la;},null);
__d("ChatAddFriendsTabSheetRawRenderer",["ContextualTypeaheadView","DOM","Event","MercuryDataSourceWrapper","MercuryTypeahead","ChatTabTemplates","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o={render:function(p,q,r,s,t,u){var v=u?l[':fb:mercury:chat:tab-sheet:add-friends-empty-tab'].build():l[':fb:mercury:chat:tab-sheet:add-friends'].build(),w=j.source;if(!u&&j.add_people_source)w=j.add_people_source;var x=new k(w,g);x.setExcludedParticipantsFromThreadMeta(s);if(!u)x.setPlaceholder("Add friends to this chat");x.build();h.replace(v.getNode('participantsTypeahead'),x.getElement());h.setContent(r,v.getRoot());x.getTokenizer().adjustWidth();var y=v.getNode('participantsTypeahead').getAttribute('data-labelid'),z=h.scry(x.getElement(),'input[type="text"]')[0];if(z)if(y){z.setAttribute('aria-labelledby',y);}else z.setAttribute('aria-label',"To");x.focus();if(!u){var aa=function(){var ba=x.getSelectedParticipantIDs();if(ba.length)t(ba);q.close(p);};i.listen(v.getNode('doneButton'),'click',aa);x.subscribe('tokens-return',function(){if(x.getTokens().length)aa();});}return x;}};e.exports=o;},null);
__d("MultiChatController",["AsyncSignal","ChatOpenTab","copyProperties","Form","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MercuryMessages').get(),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get();function n(){}i(n,{subscribe:function(o,p){o.subscribe('confirm',function(){this.createGroupThreadFromChooserDialog(o,p);}.bind(this));},createGroupThreadFromChooserDialog:function(o,p){var q=j.serialize(o.getRoot()),r=JSON.parse(q.profileChooserItems),s=[];for(var t in r)if(r[t])s.push(t);var u=n.createThreadForFBIDs(s);l.subscribe('update-thread-ids',function(v,w){for(var x in w)if(w[x]==u)new g('/ajax/groups/chat/log',{group_id:p,message_id:x}).send();});o.hide();},createThreadForTokens:function(o){if(!o.length)return;var p;if(o.length==1){p='user:'+o[0].split(':')[1];}else p='root:'+k.generateNewClientMessageID(Date.now());m.createNewLocalThread(p,o);h.openThread(p,'MultiChatController');},createThreadForFBIDs:function(o){var p=[];for(var q=0;q<o.length;q++)p.push("fbid:"+o[q]);return n.createThreadForTokens(p);}});e.exports=n;},null);
__d("ChatAddFriendsTabSheet",["ArbiterMixin","ChatAddFriendsTabSheetRawRenderer","ChatOpenTab","MercuryLogMessageType","MercurySourceType","MultiChatController","Style","copyProperties","MercuryMessages","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=b('MercuryMessages').get(),p=b('MercuryThreads').get();function q(t,u,v){this._threadID=t;this._rootElement=u;this._sheetView=v;this._typeahead=null;}n(q.prototype,g,{render:function(){p.getThreadMeta(this._threadID,function(t){var u=t.is_canonical_user?r:s;this._typeahead=h.render(this,this._sheetView,this._rootElement,t,u.bind(null,t),p.isNewEmptyLocalThread(this._threadID));this._typeahead.subscribe('tokens-changed',function(){this.inform('chat/tokens-changed',{token_count:this._typeahead.getTokens().length});}.bind(this));this._typeahead.subscribe('resize',function(){this._sheetView.resize();}.bind(this));}.bind(this));},getParticipants:function(){if(!this._typeahead)return null;return this._typeahead.getSelectedParticipantIDs();},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'add_friends_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);},getHeight:function(){return m.get(this._rootElement,'height');}});function r(t,u){var v=t.participants;l.createThreadForTokens(v.concat(u));}function s(t,u){var v=t.thread_id;if(p.isEmptyLocalThread(v)){p.addParticipantsToThreadLocally(v,u);}else o.sendMessage(o.constructLogMessageObject(k.CHAT_WEB,v,j.SUBSCRIBE,{added_participants:u}));i.openThread(v,'ChatAddFriendsTabSheet');}e.exports=q;},null);
__d("ChatNameConversationTabSheetRawRenderer",["DOM","Event","Input","Keys","ChatTabTemplates","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m={render:function(n,o,p,q,r,s){var t=k[':fb:mercury:chat:tab-sheet:name-conversation'].build(),u=t.getNode('nameInput'),v=t.getNode('doneButton'),w="Done",x="Hide",y=q.name;if(y){i.setValue(u,y);}else g.setContent(v,x);var z=function(){var aa=i.getValue(u);if(aa)r(aa);s();o.close(n);};h.listen(u,'input',function(){g.setContent(v,i.getValue(u).length===0?x:w);});h.listen(v,'click',z);h.listen(u,'keyup',function(aa){if(aa.keyCode===j.RETURN){z();return false;}});g.setContent(p,t.getRoot());!n.isAutomatic()&&u.focus();}};e.exports=m;},null);
__d("ChatNameConversationTabSheet",["AsyncRequest","ChatNameConversationTabSheetRawRenderer","MercuryAPIArgsSource","MercuryLogMessageType","MercurySourceType","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryMessages').get(),m=b('MercuryServerRequests').get(),n=b('MercuryThreads').get(),o='/ajax/chat/multichat/name_conversation/dismiss.php',p={};function q(r,s,t){"use strict";this.$ChatNameConversationTabSheet0=r;this.$ChatNameConversationTabSheet1=s;this.$ChatNameConversationTabSheet2=t;this.$ChatNameConversationTabSheet3=false;}q.prototype.render=function(){"use strict";n.getThreadMeta(this.$ChatNameConversationTabSheet0,function(r){h.render(this,this.$ChatNameConversationTabSheet2,this.$ChatNameConversationTabSheet1,r,this.$ChatNameConversationTabSheet4.bind(null,r),this.$ChatNameConversationTabSheet5.bind(this,r));this.$ChatNameConversationTabSheet2.resize();}.bind(this));};q.prototype.isPermanent=function(){"use strict";return true;};q.prototype.isSheetWithInput=function(){"use strict";return true;};q.prototype.getType=function(){"use strict";return 'name_conversation_type';};q.prototype.open=function(r){"use strict";this.$ChatNameConversationTabSheet3=r;if(!(this.$ChatNameConversationTabSheet3&&this.$ChatNameConversationTabSheet6()))this.$ChatNameConversationTabSheet2.open(this);};q.prototype.close=function(){"use strict";this.$ChatNameConversationTabSheet2.close(this);};q.prototype.isAutomatic=function(){"use strict";return this.$ChatNameConversationTabSheet3;};q.prototype.$ChatNameConversationTabSheet6=function(){"use strict";return !!p[this.$ChatNameConversationTabSheet0];};q.prototype.$ChatNameConversationTabSheet7=function(){"use strict";p[this.$ChatNameConversationTabSheet0]=true;};q.prototype.$ChatNameConversationTabSheet5=function(r){"use strict";if(!r.name_conversation_sheet_dismissed||!this.$ChatNameConversationTabSheet6()){this.$ChatNameConversationTabSheet7();m.getServerThreadID(r.thread_id,function(s){new g(o).setData({thread_id:s}).send();});}};q.prototype.$ChatNameConversationTabSheet4=function(r,s){"use strict";var t=r.name;if((s||t)&&(s!=t))l.sendMessage(l.constructLogMessageObject(k.CHAT_WEB,r.thread_id,j.THREAD_NAME,{name:s}),null,i.CHAT);};e.exports=q;},null);
__d("ChatNewMessagesTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:clickable-message-icon-sheet'].build();i.setContent(m.getNode('text'),i.tx._("Scroll down to see new messages."));i.setContent(this._rootElement,m.getRoot());g.listen(m.getRoot(),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'new_messages_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatNoRecipientsTabSheet",["DOM","fbt","MercuryParticipants","ChatTabTemplates","copyProperties","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryThreadInformer').get(),m=b('MercuryThreads').get();function n(o,p,q){this._threadID=o;this._rootElement=p;this._sheetView=q;l.subscribe('threads-updated',this._handleThreadsUpdated.bind(this));}k(n.prototype,{render:function(){var o=j[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(o.getNode('text'),"Everyone has left the conversation.");g.setContent(this._rootElement,o.getRoot());},isPermanent:function(){return true;},getType:function(){return 'no_recipients_type';},_handleThreadsUpdated:function(){m.getThreadMeta(this._threadID,function(o){var p=i.user,q=o.participants.filter(function(r){return r!=p;});if(q.length<1&&!m.isNewEmptyLocalThread(this._threadID)){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));}});e.exports=n;},null);
__d("ChatOfflineTabSheet",["ChatPrivacyActionController","ChatVisibility","CSS","DOM","Event","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreads').get();function r(s,t,u){this._rootElement=t;this._sheetView=u;this._logger=l.create('blackbird');this._canonicalUser=q.getCanonicalUserInThread(s);if(this._canonicalUser)this._privacyActionController=new g(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(r.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('offline_sheet_open_with_non_friend');return;}var s=n[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build(),t='fbid:'+this._canonicalUser;m.get(t,function(u){var v='fbChatGoOnlineLink',w=j.tx._("turn on chat"),x=j.create('a',{href:'#',className:v},w),y=j.tx._("To chat with {name} and other friends, {link}.",{name:u.short_name,link:x});j.setContent(s.getNode('text'),y);i.addClass(s.getRoot(),"_1sk1");j.setContent(this._rootElement,s.getRoot());k.listen(this._rootElement,'click',function(event){if(i.hasClass(event.getTarget(),v)){if(h.isOnline())this._logger.error('tab_sheet_already_online');this._privacyActionController.togglePrivacy();this._logger.log('tab_sheet_go_online',{tab_id:this._canonicalUser});return false;}}.bind(this));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(s){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');switch(s){case g.OFFLINE:this._sheetView.open(this);break;case g.NORMAL:case g.BLOCKED:this._sheetView.close(this);break;}},isPermanent:function(){return true;},getType:function(){return 'offline_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=r;},null);
__d("ChatUploadWarningTabSheet",["DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i){function j(k,l,m){this._threadID=k;this._rootElement=l;this._sheetView=m;}i(j.prototype,{render:function(){var k=h[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(k.getNode('text'),g.tx._("Please wait until the upload is complete before you send your message."));g.setContent(this._rootElement,k.getRoot());},isPermanent:function(){return false;},getType:function(){return 'upload_warning_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=j;},null);
__d("ChatReadOnlyTabSheet",["React","MercuryReadOnlyReason","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){var j=b('MercuryThreads').get();function k(l,m,n){"use strict";this.$ChatReadOnlyTabSheet0=l;this.$ChatReadOnlyTabSheet1=m;this.$ChatReadOnlyTabSheet2=n;}k.prototype.render=function(){"use strict";var l=h.getReason(j.getThreadMetaNow(this.$ChatReadOnlyTabSheet0));g.renderComponent(g.createElement(g.DOM.div,{className:"_87-"},l),this.$ChatReadOnlyTabSheet1);};k.prototype.isPermanent=function(){"use strict";return false;};k.prototype.getType=function(){"use strict";return 'chat-thread-is-read-only';};k.prototype.open=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};k.prototype.close=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};e.exports=k;},null);
__d("ChatThreadIsMutedTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:message-mute-sheet'].build();i.setContent(m.getNode('text'),i.tx._("This conversation is muted. Chat tabs will not pop up for it and push notifications are off."));i.setContent(this._rootElement,m.getRoot());g.listen(m.getNode('unmuteButton'),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return false;},getType:function(){return 'chat-thread-is-muted';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatUserBlockedTabSheet",["CSS","ChatPrivacyActionController","DOM","Event","GenderConst","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","tx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get();function s(t,u,v){this._rootElement=u;this._sheetView=v;this._logger=l.create('blackbird');this._canonicalUser=r.getCanonicalUserInThread(t);if(this._canonicalUser)this._privacyActionController=new h(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(s.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('user_blocked_sheet_open_with_non_friend');return;}var t=n[':fb:mercury:chat:tab-sheet:user-blocked'].build(),u='fbid:'+this._canonicalUser;m.get(u,function(v){var w=null;switch(v.gender){case k.FEMALE_SINGULAR:case k.FEMALE_SINGULAR_GUESS:w=q._("You turned off chat for {name} but you can still send her a message. ",{name:v.short_name});break;case k.MALE_SINGULAR:case k.MALE_SINGULAR_GUESS:w=q._("You turned off chat for {name} but you can still send him a message. ",{name:v.short_name});break;default:w=q._("You turned off chat for {name} but you can still send them a message. ",{name:v.short_name});}i.setContent(t.getNode('text'),w);var x=q._("Turn on chat for {name}?",{name:v.short_name});i.setContent(t.getNode('actionLink'),x);g.addClass(t.getRoot(),"_1sk0");i.setContent(this._rootElement,t.getRoot());j.listen(t.getNode('actionLink'),'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(t){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');if(t==h.BLOCKED){var u='fbid:'+this._canonicalUser;m.get(u,function(v){if(v.is_friend){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));return;}this._sheetView.close(this);},isPermanent:function(){return true;},getType:function(){return 'user_blocked_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=s;},null);
__d("ChatTabSheetController",["ChatAddFriendsTabSheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatUploadWarningTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMutedTabSheet","ChatUserBlockedTabSheet","copyProperties","MercurySheetView","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get(),s=function(t,u,v){this._sheetView=new q(t,u,v);this._addFriendsTabSheet=new g(t,u,this._sheetView);this._nameConversationTabSheet=new h(t,u,this._sheetView);this._userBlockedTabSheet=new o(t,u,this._sheetView);this._offlineTabSheet=new k(t,u,this._sheetView);this._newMessagesTabSheet=new i(t,u,this._sheetView);this._uploadWarningTabSheet=new l(t,u,this._sheetView);this._threadIsMutedTabSheet=new n(t,u,this._sheetView);this._readOnlyTabSheet=new m(t,u,this._sheetView);if(!r.getCanonicalUserInThread(t))this._noRecipientsTabSheet=new j(t,u,this._sheetView);};p(s.prototype,{openAddFriendsSheet:function(){this._addFriendsTabSheet.open();},getAddFriendsTabSheet:function(){return this._addFriendsTabSheet;},getAddFriendsParticipants:function(){var t=this._addFriendsTabSheet.getParticipants();this._addFriendsTabSheet.close();return t;},openNameConversationSheet:function(t){this._nameConversationTabSheet.open(t);},openReadOnlySheet:function(){this._readOnlyTabSheet.open();},openNewMessagesSheet:function(){this._newMessagesTabSheet.open();},openUploadWarningTabSheet:function(){this._uploadWarningTabSheet.open();},openThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.open();},closeAutomaticNameConversationSheet:function(){if(this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();},closeThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.close();},closeNewMessagesSheet:function(){this._newMessagesTabSheet.close();},closeUploadWarningTabSheet:function(){this._uploadWarningTabSheet.close();},onClickNewMessagesSheet:function(t){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',t);},onClickThreadIsMutedSheet:function(t){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',t);},onResize:function(t){this._sheetView.subscribe('resize',t);},onTokensChanged:function(t){this._addFriendsTabSheet.subscribe('chat/tokens-changed',t);},destroy:function(){this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();}});e.exports=s;},null);
__d("EmoticonUtils",["EmoticonsList","Parent","endsWith","startsWith"],function(a,b,c,d,e,f,g,h,i,j){var k='emoticon_',l=g.symbols,m={getEmoteFromTarget:function(n){var o=h.byClass(n,'emoticon');if(!o)return null;var p=null;o.className.split(' ').forEach(function(q){if(j(q,k))p=q.substring(k.length);});return l[p]||null;},insertEmoticon:function(n,o,p){var q=o.substring(0,p.start),r=o.substring(p.end);if(p.start>0&&!i(q,' '))n=' '+n;if(!j(r,' '))n+=' ';var s=q+n+r;p.start+=n.length;p.end=p.start;return {result:s,start:p.start,end:p.end};}};e.exports=m;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler","merge"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this.$SelectionPosition0=l;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}k.prototype.getPos=function(){"use strict";return j(this.$SelectionPosition1);};k.prototype.setPos=function(l,m){"use strict";this.$SelectionPosition1={start:l,end:m};this.restore();};k.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};k.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};k.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};k.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=k;},null);
__d("StickerSearchNUX.react",["React","ReactLayeredComponentMixin","StickerServerRequests","XUIAmbientNUX.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'StickerSearchNUX',mixins:[h],getInitialState:function(){return {nuxShown:true};},componentDidMount:function(){i.markSeenSearchTooltipNUX();},hideNUX:function(){this.setState({nuxShown:false});},onCloseButtonClicked:function(){this.hideNUX();this.props.showIndicatorFunc();},renderLayers:function(){return {stickerSearchNUX:g.createElement(j,{ref:"NUX",contextRef:"container",shown:this.state.nuxShown,position:"above",width:"auto",onCloseButtonClick:this.onCloseButtonClicked},"Now you can search for stickers!")};},render:function(){return (g.createElement(g.DOM.span,{ref:"container"}));}});e.exports=l;},null);
__d("rebound",[],function(a,b,c,d,e,f){var g={},h=g.SpringSystem=function t(){this._springRegistry={};this._activeSprings=[];this._listeners=[];this._idleSpringIndices=[];this._boundFrameCallback=r(this._frameCallback,this);};s(h,{});s(h.prototype,{_springRegistry:null,_isIdle:true,_lastTimeMillis:-1,_activeSprings:null,_listeners:null,_idleSpringIndices:null,_frameCallback:function(){this.loop();},_frameCallbackId:null,createSpring:function(t,u){var v=new i(this);this.registerSpring(v);if(typeof t==='undefined'||typeof u==='undefined'){v.setSpringConfig(k.DEFAULT_ORIGAMI_SPRING_CONFIG);}else{var w=k.fromOrigamiTensionAndFriction(t,u);v.setSpringConfig(w);}return v;},getIsIdle:function(){return this._isIdle;},getSpringById:function(t){return this._springRegistry[t];},getAllSprings:function(){return Object.values(this._springRegistry);},registerSpring:function(t){this._springRegistry[t.getId()]=t;},deregisterSpring:function(t){m(this._activeSprings,t);delete this._springRegistry[t.getId()];},advance:function(t,u){while(this._idleSpringIndices.length>0)this._idleSpringIndices.pop();for(var v=0,w=this._activeSprings.length;v<w;v++){var x=this._activeSprings[v];if(x.systemShouldAdvance()){x.advance(t/1000,u/1000);}else this._idleSpringIndices.push(this._activeSprings.indexOf(x));}while(this._idleSpringIndices.length>0){var y=this._idleSpringIndices.pop();y>=0&&this._activeSprings.splice(y,1);}},loop:function(){var t,u=Date.now();if(this._lastTimeMillis===-1)this._lastTimeMillis=u-1;var v=u-this._lastTimeMillis;this._lastTimeMillis=u;var w=0,x=this._listeners.length;for(w=0;w<x;w++){t=this._listeners[w];t.onBeforeIntegrate&&t.onBeforeIntegrate(this);}this.advance(u,v);if(this._activeSprings.length===0){this._isIdle=true;this._lastTimeMillis=-1;}for(w=0;w<x;w++){t=this._listeners[w];t.onAfterIntegrate&&t.onAfterIntegrate(this);}n(this._frameCallbackId);if(!this._isIdle)this._frameCallbackId=o(this._boundFrameCallback);},activateSpring:function(t){var u=this._springRegistry[t];if(this._activeSprings.indexOf(u)==-1)this._activeSprings.push(u);if(this.getIsIdle()){this._isIdle=false;n(this._frameCallbackId);this._frameCallbackId=o(this._boundFrameCallback);}},addListener:function(t){this._listeners.push(t);},removeListener:function(t){m(this._listeners,t);},removeAllListeners:function(){this._listeners=[];}});var i=g.Spring=function t(u){this._id=t._ID++;this._springSystem=u;this._listeners=[];this._currentState=new j();this._previousState=new j();this._tempState=new j();};s(i,{_ID:0,MAX_DELTA_TIME_SEC:.064,SOLVER_TIMESTEP_SEC:.001});s(i.prototype,{_id:0,_springConfig:null,_overshootClampingEnabled:false,_currentState:null,_previousState:null,_tempState:null,_startValue:0,_endValue:0,_wasAtRest:true,_restSpeedThreshold:.001,_displacementFromRestThreshold:.001,_listeners:null,_timeAccumulator:0,_springSystem:null,destroy:function(){this._listeners=[];this._springSystem.deregisterSpring(this);},getId:function(){return this._id;},setSpringConfig:function(t){this._springConfig=t;return this;},getSpringConfig:function(){return this._springConfig;},setCurrentValue:function(t){this._startValue=t;this._currentState.position=t;for(var u=0,v=this._listeners.length;u<v;u++){var w=this._listeners[u];w.onSpringUpdate&&w.onSpringUpdate(this);}return this;},getStartValue:function(){return this._startValue;},getCurrentValue:function(){return this._currentState.position;},getCurrentDisplacementDistance:function(){return this.getDisplacementDistanceForState(this._currentState);},getDisplacementDistanceForState:function(t){return Math.abs(this._endValue-t.position);},setEndValue:function(t){if(this._endValue==t&&this.isAtRest())return this;this._startValue=this.getCurrentValue();this._endValue=t;this._springSystem.activateSpring(this.getId());for(var u=0,v=this._listeners.length;u<v;u++){var w=this._listeners[u];w.onSpringEndStateChange&&w.onSpringEndStateChange(this);}return this;},getEndValue:function(){return this._endValue;},setVelocity:function(t){this._currentState.velocity=t;return this;},getVelocity:function(){return this._currentState.velocity;},setRestSpeedThreshold:function(t){this._restSpeedThreshold=t;return this;},getRestSpeedThreshold:function(){return this._restSpeedThreshold;},setRestDisplacementThreshold:function(t){this._displacementFromRestThreshold=t;},getRestDisplacementThreshold:function(){return this._displacementFromRestThreshold;},setOvershootClampingEnabled:function(t){this._overshootClampingEnabled=t;return this;},isOvershootClampingEnabled:function(){return this._overshootClampingEnabled;},isOvershooting:function(){return (this._startValue<this._endValue&&this.getCurrentValue()>this._endValue)||(this._startValue>this._endValue&&this.getCurrentValue()<this._endValue);},advance:function(t,u){var v=this.isAtRest();if(v&&this._wasAtRest)return;var w=u;if(u>i.MAX_DELTA_TIME_SEC)w=i.MAX_DELTA_TIME_SEC;this._timeAccumulator+=w;var x=this._springConfig.tension,y=this._springConfig.friction,z=this._currentState.position,aa=this._currentState.velocity,ba=this._tempState.position,ca=this._tempState.velocity,da,ea,fa,ga,ha,ia,ja,ka,la,ma;while(this._timeAccumulator>=i.SOLVER_TIMESTEP_SEC){this._timeAccumulator-=i.SOLVER_TIMESTEP_SEC;if(this._timeAccumulator<i.SOLVER_TIMESTEP_SEC){this._previousState.position=z;this._previousState.velocity=aa;}da=aa;ea=(x*(this._endValue-ba))-y*aa;ba=z+da*i.SOLVER_TIMESTEP_SEC*.5;ca=aa+ea*i.SOLVER_TIMESTEP_SEC*.5;fa=ca;ga=(x*(this._endValue-ba))-y*ca;ba=z+fa*i.SOLVER_TIMESTEP_SEC*.5;ca=aa+ga*i.SOLVER_TIMESTEP_SEC*.5;ha=ca;ia=(x*(this._endValue-ba))-y*ca;ba=z+ha*i.SOLVER_TIMESTEP_SEC*.5;ca=aa+ia*i.SOLVER_TIMESTEP_SEC*.5;ja=ca;ka=(x*(this._endValue-ba))-y*ca;la=1/6*(da+2*(fa+ha)+ja);ma=1/6*(ea+2*(ga+ia)+ka);z+=la*i.SOLVER_TIMESTEP_SEC;aa+=ma*i.SOLVER_TIMESTEP_SEC;}this._tempState.position=ba;this._tempState.velocity=ca;this._currentState.position=z;this._currentState.velocity=aa;if(this._timeAccumulator>0)this.interpolate(this._timeAccumulator/i.SOLVER_TIMESTEP_SEC);if(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting()){this._startValue=this._endValue;this._currentState.position=this._endValue;this.setVelocity(0);v=true;}var na=false;if(this._wasAtRest){this._wasAtRest=false;na=true;}var oa=false;if(v){this._wasAtRest=true;oa=true;}for(var pa=0,qa=this._listeners.length;pa<qa;pa++){var ra=this._listeners[pa];if(na)ra.onSpringActivate&&ra.onSpringActivate(this);ra.onSpringUpdate&&ra.onSpringUpdate(this);if(oa)ra.onSpringAtRest&&ra.onSpringAtRest(this);}},systemShouldAdvance:function(){return !this.isAtRest()||!this.wasAtRest();},wasAtRest:function(){return this._wasAtRest;},isAtRest:function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold;},setAtRest:function(){this._endValue=this._currentState.position;this._tempState.position=this._currentState.position;this._currentState.velocity=0;return this;},interpolate:function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t);this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t);},addListener:function(t){this._listeners.push(t);return this;},removeListener:function(t){m(this._listeners,t);return this;},removeAllListeners:function(){this._listeners=[];return this;},currentValueIsApproximately:function(t){return Math.abs(this.getCurrentValue()-t)<=this.getRestDisplacementThreshold();}});var j=function t(){};s(j.prototype,{position:0,velocity:0});var k=g.SpringConfig=function t(u,v){this.tension=u;this.friction=v;},l={tensionFromOrigamiValue:function(t){return (t-30)*3.62+194;},origamiValueFromTension:function(t){return (t-194)/3.62+30;},frictionFromOrigamiValue:function(t){return (t-8)*3+25;},origamiFromFriction:function(t){return (t-25)/3+8;}};s(k,{fromOrigamiTensionAndFriction:function(t,u){return new k(l.tensionFromOrigamiValue(t),l.frictionFromOrigamiValue(u));}});k.DEFAULT_ORIGAMI_SPRING_CONFIG=k.fromOrigamiTensionAndFriction(40,7);s(k.prototype,{friction:0,tension:0});g.MathUtil={mapValueInRange:function(t,u,v,w,x){var y=v-u,z=x-w,aa=(t-u)/y;return w+(aa*z);}};function m(t,u){var v=t.indexOf(u);v!=-1&&t.splice(v,1);}function n(t){return typeof window!='undefined'&&window.cancelAnimationFrame&&window.cancelAnimationFrame(t);}function o(t){var u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;return u(t);}var p=Array.prototype.concat,q=Array.prototype.slice;function r(t,u){var v=q.call(arguments,2);return function(){t.apply(u,p.call(v,q.call(arguments)));};}function s(t,u){for(var v in u)if(u.hasOwnProperty(v))t[v]=u[v];}e.exports=g;},null);
__d("StickerTriggerImage.react",["React","Image.react","rebound"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=g.createClass({displayName:'StickerTriggerImage',propTypes:{stickers:g.PropTypes.array},getDefaultProps:function(){return {stickers:[]};},getInitialState:function(){return {index:0};},componentWillMount:function(){this._springSystem=new i.SpringSystem();this._spring=this._springSystem.createSpring(50,3);this._spring.addListener({onSpringUpdate:function(k){var l=k.getCurrentValue();l=i.MathUtil.mapValueInRange(l,0,1,1,.5);this._scale(this.getDOMNode(),l);}.bind(this)});this._spring.setEndValue(0);},componentDidMount:function(){this._stopIntervalID=setInterval(this.incrementIndex,3000);},componentWillUnmount:function(){clearInterval(this._stopIntervalID);this._spring.destroy();},componentWillUpdate:function(k,l){if(this.props.stickers.length===0&&k.stickers.length>=0){this._spring.setEndValue(1);setTimeout(function(){return this._spring.setEndValue(0);}.bind(this),100);}},_scale:function(k,l){if(k)k.style.mozTransform=k.style.msTransform=k.style.webkitTransform=k.style.transform='scale3d('+l+', '+l+', 1)';},incrementIndex:function(){var k=this.state.index;if(k<this.props.stickers.length-1){k++;}else k=0;this.setState({index:k});},render:function(){if(this.props.stickers.length===0)return null;return (g.createElement(h,{className:"stickerTriggerImage",src:this.props.stickers[this.state.index].triggerSourceURI}));}});e.exports=j;},null);
__d("XStickerReplyNUXControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AsyncSignal","AvailableListConstants","BanzaiLogger","BanzaiODS","ChatBehavior","ChatConfig","ChatContextualDialogController","ChatFileUploader.react","ChatInput.react","ChatOpenTab","ChatPhotoUploader.react","ChatPrivacyActionController","ChatQuietLinks","ChatShareLinkUploader","ChatStickerButton.react","ChatTabMenu.react","ChatTabMessagesView","ChatTabSheetController","ChatVisibility","MercuryConstants","ContentRollFlyout.react","CurrentUser","CSS","CurrentLocale","Dialog","Dock","DOM","DOMEvent","DOMQuery","DragDropTarget","EmoticonsList","EmoticonUtils","Event","Focus","Input","Keys","Locale","MercuryConfig","MercuryIDs","MercuryFileUploader","MercuryLogMessageType","MercuryParticipants","MercurySourceType","MercuryThreadMetadataRawRenderer","MercuryThreadMuter","MercuryTypingAnimation.react","MercuryTypingReceiver","MessagesEmoticonView","NubController","Parent","PhotosUploadWaterfall","PresencePrivacy","PresenceStatus","React","Run","SelectionPosition","StickerActions","StickerConfig","StickerConstants","StickersFlyout.react","StickerState","StickerSearch","StickerSearchNUX.react","StickerTriggerImage.react","Style","SubscriptionsHandler","ChatTabTemplates","TextAreaControl","Toggler","Tooltip","TypingDetectorController","URI","UserAgent_DEPRECATED","VideoCallCore","WaterfallIDGenerator","WebMessengerThreadPermalinks","XStickerReplyNUXControllerURIBuilder","copyProperties","cx","csx","fbt","getActiveElement","isEmpty","setIntervalAcrossTransitions","tx","OrionTrigger","MercuryMessages","MercuryServerRequests","MercuryThreadInformer","MercuryThreadMetadataRenderer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc){"use strict";var rc=b('OrionTrigger').module,sc=b('MercuryMessages').get(),tc=b('MercuryServerRequests').get(),uc=b('MercuryThreadInformer').get(),vc=b('MercuryThreadMetadataRenderer').get(),wc=b('MercuryThreads').get(),xc=/^\s*$/,yc={},zc=null,ad,bd=10;function cd(xd,yd){var zd=ka.create('div');yd=yd&&yd.filter(function(ce){return ce!=za.user;});if(oc(yd))return bc.remove(xd);var ae=yd.length,be=ae-bd;if(be>1)yd=yd.slice(0,bd);za.getMulti(yd,function(ce){for(var de in ce){var ee=ce[de],fe=yb[':fb:mercury:chat:multichat-tooltip-item'].build();ka.setContent(fe.getNode('name'),ee.name);var ge=za.getUserID(de),he=ge&&kb.get(ge)==l.ACTIVE;ga.conditionShow(fe.getNode('icon'),he);ga.conditionClass(fe.getNode('name'),'tooltipItemWithIcon',he);ka.appendContent(zd,fe.getRoot());}if(be>1){var ie=mc._("and {number of hidden chat participants} more.",[mc.param("number of hidden chat participants",be)]);ka.appendContent(zd,ka.create('div',{},ie));}bc.set(xd,zd,'above');});}var dd={},ed=null,fd=false;function gd(xd,yd,zd){if(zd){dd[xd]=yd;if(!ed)ed=pc(hd,600);}else{ga.removeClass(yd,'highlightTitle');delete dd[xd];}}function hd(){for(var xd in dd){var yd=dd[xd];if(yd.parentNode){ga.conditionClass(yd,'highlightTitle',fd);}else delete dd[xd];}fd=!fd;if(!Object.keys(dd).length){clearInterval(ed);ed=null;}}function id(xd){var yd=tc.tokenizeThreadID(xd);switch(yd.type){case 'user':return yb[':fb:mercury:chat:user-tab'].build();}return yb[':fb:mercury:chat:multichat-tab'].build();}function jd(xd){var yd=xd._getInputValue(),zd=xd._fileUploader.getAttachments();if(pd(xd))ld(xd,yd,zd,function(ae){var be=xd._fileUploader.getImageFiles();if(be.length>0){ae.image_ids=be;ae.has_attachment=true;}var ce=xd._fileUploader.getVideoFiles();if(ce.length>0){ae.video_ids=ce;ae.has_attachment=true;}var de=xd._fileUploader.getAudioFiles();if(de.length>0){ae.audio_ids=de;ae.has_attachment=true;}var ee=xd._fileUploader.getFiles();if(ee.length>0){ae.file_ids=ee;ae.has_attachment=true;}sc.sendMessage(ae);xd._fileUploader.removeAttachments();xd._shareLinkUploader.clear();if(!pb.WebStickerTrigger)xd._getNode('input').value='';xd._typingDetector&&xd._typingDetector.resetState();xd._messagesView&&xd._messagesView.scrollToBottom();});}function kd(xd,yd){if(yd===0)return;sd(xd,ib.POST_PUBLISHED,{count:yd});xd._waterfallID=gc.generate();}function ld(xd,yd,zd,ae){wc.getThreadMeta(xd._threadID,function(be){var ce=sc.constructUserGeneratedMessageObject(yd,ab.CHAT_WEB,xd._threadID);if(zd.length>0){ce.has_attachment=true;ce.raw_attachments=zd;}var de=xd._shareLinkUploader.getAttachData();if(de){ce.has_attachment=true;ce.content_attachment=de;}if(wc.isNewEmptyLocalThread(xd._threadID)){var ee=xd._sheetController.getAddFriendsParticipants();if(ee===null||ee.length===0)return;ee=ee.filter(function(ge){return ge!=za.user;});if(ee.length===0){ce.thread_id=wc.getThreadIDForUser(fa.getID());}else if(ee.length===1){ce.thread_id=wc.getThreadIDForParticipant(ee[0]);}else wc.addParticipantsToThreadLocally(xd._threadID,ee);}if(wc.isEmptyLocalThread(xd._threadID)){var fe=tc.tokenizeThreadID(xd._threadID);ce.message_id=fe.value;ce.specific_to_list=be.participants;}if(typeof ce!='undefined')ce.signatureID=xd._signatureID;ce.ui_push_phase=da.UIPushPhase;ae(ce);if(xd._threadID!==ce.thread_id&&!xd._photoUploader.isUploading()){td.inform('closed-tab',xd._threadID);t.openThread(ce.thread_id,'ChatTabView');}});}function md(xd){xd._blocked=true;xd._sheetController.openUploadWarningTabSheet();}function nd(xd){return (xd._fileUploader.isUploading()||xd._photoUploader.isUploading());}function od(xd){return xd._fileUploader.isUploading();}function pd(xd){var yd=xd._getInputValue();if(!xc.test(yd))return true;if(xd._fileUploader.getAttachments().length>0||xd._fileUploader.getImageFiles().length>0||xd._fileUploader.getVideoFiles().length>0)return true;if(xd._shareLinkUploader.getAttachData())return true;return false;}function qd(xd){if(xd._blocked){if(od(xd))return;xd._blocked=false;jd(xd);xd._sheetController.closeUploadWarningTabSheet();}}function rd(xd){xd._nubController.flyoutContentChanged();xd._attachmentsDiv.scrollTop=xd._attachmentsDiv.scrollHeight;}function sd(xd,yd,zd){ib.sendSignal(jc({qn:xd._waterfallID,step:yd,uploader:ib.APP_CHAT},zd||{}));}function td(xd,yd,zd){if(yd)tc.ensureThreadIsFetched(yd);this._threadID=xd;this._signatureID=zd;this._eventListeners=[];this._isDragDropActive=false;this._tabTemplate=id(xd);this._tabElem=this._tabTemplate.getRoot();this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._waterfallID=gc.generate();this._subscriptionsHandler=new xb();this._initializeAutoSendPhotoUploader();this._stickersFlyoutShown=false;var ae=ma.scry(this._tabElem,"._1ia");if(ae&&ae.length>0){this._dropTarget=new na(ae[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}this._attachmentsDiv=this._getNode('attachmentShelf');this._initializeThingsWithInput();this._sheetController=new ba(this._threadID,this._getNode('sheet'),this._tabElem);if(p.get('chat_react_option_menu')){this._initializeReactMenu(this._tabTemplate.getNode('attachmentShelf'));}else{this._fileUploader=new xa(this._tabTemplate.getNode('attachmentShelf'),this._tabTemplate.getNode('attachButtonForm'),this._tabTemplate.getNode('fileInput'),this._tabTemplate.getNode('attachID'));this._initializeUploader(this._fileUploader);}this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();td.inform('read',this._threadID);}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){wc.updateThreadMuteSetting(this._threadID,0);this.focus();}.bind(this));this._nubController=new gb().init(this._tabElem);this._sheetController.onResize(this._nubController.flyoutContentChanged.bind(this._nubController));this._sheetController.onTokensChanged(function(le,me){wc.getThreadMeta(this._threadID,function(ne){this._updateControls(ne,me.token_count);}.bind(this));}.bind(this));this._contextualDialogController=new q(this._threadID,this._getNode('videoCallLink'));if(zc===null)zc=!p.get('seen_autosend_photo_nux');this._messagesView=null;var be=this._getNode('titlebarText'),ce=function(le){be.setAttribute('href',le);be.removeAttribute('rel');ga.removeClass(be,'noLink');};if(p.get('chat_react_option_menu')){hc.getThreadURI(xd,function(le){return ce(le);});}else{var de=this._getNode('conversationLink');ga.hide(de);vc.renderWebMessengerLink(xd,de,function(){ga.show(de);ce(de.href);});}if(!wc.getCanonicalUserInThread(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var ee=this._getCanonicalUserID();if(this._getCanonicalUserID()){za.get(za.getIDForUser(ee),function(le){if(le.href)ce(le.href);});}else if(p.get('chat_react_option_menu')&&this._reactChatTabMenu.props.fullURL){ce(this._reactChatTabMenu.props.fullURL);}else if(de&&de.href)ce(de.href);var fe=this._inputContainerNode.clientHeight;if(!pb.WebStickerTrigger)zb.getInstance(this._getNode('input')).subscribe('resize',function(){var le=this._inputContainerNode.clientHeight;if(le!=fe)this._nubController.flyoutContentChanged();fe=le;}.bind(this));this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));this._setNameConversationLink();this._listen('closeButton','click',this._closeClicked);this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('addFriendLink','click',this._addFriendLinkClicked,true);this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);this._listen('nameConversationLink','click',this._nameConversationLinkClicked,true);this._listen('clearWindowLink','click',this._clearHistory,true);this._listen('unsubscribeLink','click',this._unsubscribeLinkClicked,true);this._listen('videoCallLink','click',this._callClicked,true);this._listen('reportSpamLink','click',this._reportSpamClicked,true);this._listen('createGroupLink','click',this._createGroupClicked,true);this._listen('enableDesktopNotif','click',this._enableDesktopNotif,true);this._listen('muteThreadLink','click',cb.showMuteChangeDialog.bind(null,this._threadID),true);this._listen('unmuteThreadLink','click',function(){wc.updateThreadMuteSetting(this._threadID,0);ac.hide();}.bind(this),true);if(!pb.WebStickerTrigger){this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);}this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===ta.TAB){this._focusInput();event.kill();}}.bind(this));this._stickersFlyoutToggler=this._getNode('emoticons');this._emoticonView=null;if(this._stickersFlyoutToggler&&!pb.WebStickerTrigger)this._emoticonView=new fb(this._stickersFlyoutToggler,this._getNode('input'));if(pb.WebStickerTrigger){this._triggeredWord=null;this._stickerTriggerImage=lb.renderComponent(lb.createElement(vb,null),this._getNode('stickersTriggerImageContainer'));this._chatInput=lb.renderComponent(lb.createElement(s,{getTriggeredWordFn:this.getTriggeredWord.bind(this),initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputChanged:this._inputChanged.bind(this),inputKeyDown:this._inputKeyDown.bind(this),isTriggerValid:this.isTriggerValid.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),resizeFn:this._nubController.flyoutContentChanged.bind(this._nubController),uploadPhotoFn:this._photoUploader.uploadFile}),this._getNode('chatInputContainer'));}if(sb.shouldShowStickerSearchNUXIndicator()){this._addStickerSearchNUXIndicator();this._listen('emoticons','click',function(){if(sb.shouldShowStickerSearchNUXIndicator()){ob.selectPack(qb.SEARCH_PACK_ID);sb.clearShowStickerSearchNUXIndicator();}g.inform('stickerSearchNUXIndicator/hide');},true);g.subscribeOnce('stickerSearchNUXIndicator/hide',function(){this._clearStickerSearchNUXIndicator();this._clearStickerSearchNUXTooltip();}.bind(this));td.subscribe('lower-activated',function(le,me){if(me===this._threadID&&sb.shouldShowStickerSearchNUXIndicator()){this._clearStickerSearchNUXTooltip();this._addStickerSearchNUXIndicator();}}.bind(this));}this._stickersFlyoutPackID=null;if(p.get('chat_react_sticker_button')){this._selectionPosition=new nb(this._getNode('input'));this._stickerButton=lb.renderComponent(lb.createElement(y,{onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this)}),this._getNode('stickerButtonContainer'));n.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var ge=this._getNode('stickers');if(ge)this._stickersFlyout=lb.renderComponent(lb.createElement(rb,{onStickerSelect:function(le){this._stickerSelected(le);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)}),ge);this._eventListeners.push(sb.addListener(sb.PACK_SELECTED,function(le){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:le});}.bind(this)));}if(rc){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=lb.renderComponent(lb.createElement(rc,{onTrigger:this._orionTriggered.bind(this)}),this._orionTriggerContainer);}var he=this._getNode('contentRoll');if(he)lb.renderComponent(lb.createElement(ea,{onSelection:function(le){this._shareLinkUploader&&this._shareLinkUploader.loadShare(le.url,{content_roll_entry:le});this.focus();}.bind(this),userID:fa.getID()}),he);if(!pb.WebStickerTrigger)if(ec.firefox()&&ha.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._privacyLink=this._getNode('privacyLink');if(this._privacyLink){this._privacyActionController=new v(ee,this._updatePrivacyLink.bind(this));this._eventListeners.push(qa.listen(this._privacyLink,'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController)));}wc.getThreadMeta(this._threadID,function(le){this._setUpMutingSettings(le);}.bind(this));var ie=this._getNode('muteGroupLink');if(ie){var je=wc.getCanonicalGroupInThread(this._threadID);if(je)ie.setAttribute('ajaxify',dc(ie.getAttribute('ajaxify')).addQueryData({id:je}));}w.removeEmptyHrefs(this._tabElem);yc[xd]=this;this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);var ke={threadID:xd,userID:ee,signatureID:this._signatureID};new k('/ajax/chat/opentab_tracking.php',ke).send();mb.onBeforeUnload(function(){if(this._hasUnfinishedPost())return "You haven't sent your message yet. Do you want to leave without sending?";if(sc.getNumberLocalMessages(this._threadID))return "Your message is still being sent. Are you sure you want to leave?";return null;}.bind(this),false);mb.onUnload(function(){ud(this);}.bind(this));}function ud(xd){if(xd._photoUploader.isUploading())sd(xd,ib.CANCEL_DURING_UPLOAD);}function vd(){for(var xd in yc){yc[xd].updateAvailableStatus();yc[xd].updateMultichatTooltip();}}g.subscribe(['buddylist/availability-changed'],vd);jb.subscribe(['privacy-changed','privacy-availability-changed'],vd);o.subscribe(o.ON_CHANGED,function(){for(var xd in yc)wc.getThreadMeta(xd,function(yd){yc[xd]._updateUnreadCount(yd);});});eb.addRetroactiveListener('state-changed',function(xd){for(var yd in xd){var zd=xd[yd]&&xd[yd].length,ae=yc[yd];ae&&ae.showTypingIndicator(zd);}});uc.subscribe('threads-updated',function(xd,yd){for(var zd in yc){var ae=yc[zd];yd[zd]&&ae.updateTab();if(ae._newThreadIDFromPhotoUpload&&!ae._photoUploader.isUploading()&&yd[ae._newThreadIDFromPhotoUpload]){td.inform('closed-tab',ae._threadID);t.openThread(ae._newThreadIDFromPhotoUpload,'ChatTabView');ae._newThreadIDFromPhotoUpload=null;}}});uc.subscribe('threads-deleted',function(xd,yd){for(var zd in yc)yd[zd]&&td.inform('thread-deleted',zd);});jc(td,h,{get:function(xd){return yc[xd];}});jc(td.prototype,{getThreadID:function(){return this._threadID;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(xd){setTimeout((function(){this._sheetController.openNameConversationSheet(xd);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return ga.shown(this._tabElem);},setVisibleState:function(xd,yd){var zd=ga.shown(this._tabElem),ae=ga.hasClass(this._tabElem,'opened');ga.conditionShow(this._tabElem,xd);ga.conditionClass(this._tabElem,'opened',yd);if(!(zd&&ae)&&xd&&yd){if(!this._messagesView)this._messagesView=new aa(this._threadID,this._sheetController,this._getNode('chatConv'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}if(zd&&ae&&!(xd&&yd))this._contextualDialogController.tabNotActive();},focus:function(){if(ga.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var xd=nc();return hb.byClass(xd,"_50mz")===this._tabElem;},hasEmptyInput:function(){var xd;if(pb.WebStickerTrigger){xd=this._chatInput.getValue();}else xd=this._getNode('input').value;return xc.test(xd);},getInputElem:function(){if(pb.WebStickerTrigger){return this._chatInput.getDOMNode();}else return this._getNode('input');},setStickersFlyoutPackID:function(xd){if(this._stickerButton){this._setPackIDReact(xd);}else this._setPackIDLegacy(xd);},_linkDropped:function(xd){this._shareLinkUploader.loadShare(xd);},_filesDropped:function(xd){if(this._fileUploader)this._fileUploader.addDroppedFiles(xd);},showStickerSearchNUXTooltip:function(){this._clearStickerSearchNUXIndicator();this._stickerSearchNUXTooltip=lb.renderComponent(lb.createElement(ub,{showIndicatorFunc:this._addStickerSearchNUXIndicator.bind(this)}),this._getNode('tooltipNUXContainer'));},_setPackIDLegacy:function(xd){var yd=this._stickersFlyout;if(!this._stickersFlyoutToggler||!yd||!yd.isMounted())return;ob.selectPack(xd);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(xd){if(!this._stickerButton.isMounted())return;ob.selectPack(xd);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(xd){this._stickerButton.showFlyout();this._stickersFlyoutShown=xd;},_toggleStickersFlyoutShownLegacy:function(xd){if(xd){ac.show(this._stickersFlyoutToggler);}else ac.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=xd;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(ad)return;var xd=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new j(new ic().getURI()).setRelativeTo(xd).setData({thread_id:this._threadID}).setHandler(function(yd){sb.clearShowStickerReplyNUX();}).send();},insertBefore:function(xd){ka.insertBefore(xd._tabElem,this._tabElem);},appendTo:function(xd){ka.appendContent(xd,this._tabElem);},nextTabIs:function(xd){var yd=xd&&xd._tabElem;return this._tabElem.nextSibling==yd;},getScrollTop:function(){return ka.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop;},setScrollTop:function(xd){ka.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop=xd;},destroy:function(){ka.remove(this._tabElem);this._emoticonView&&this._emoticonView.destroy();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();if(p.get('chat_react_option_menu')){lb.unmountComponentAtNode(this._getNode('menuContainer'));}else this._fileUploader&&this._fileUploader.destroy();lb.unmountComponentAtNode(this._getNode('photoUploaderContainer'));if(p.get('chat_react_sticker_button')){lb.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else lb.unmountComponentAtNode(this._getNode('stickers'));if(pb.WebStickerTrigger){lb.unmountComponentAtNode(this._getNode('stickersTriggerImageContainer'));clearTimeout(this._triggerTimeoutID);}this._subscriptionsHandler&&this._subscriptionsHandler.release();this._contextualDialogController&&this._contextualDialogController.destroy();this._privacyActionController&&this._privacyActionController.destroy();delete yc[this._threadID];ja.unregisterNubController(this._nubController);if(!pb.WebStickerTrigger)sa.reset(this._getNode('input'));},updateAvailableStatus:function(){wc.getThreadMeta(this._threadID,function(xd){var yd=l.OFFLINE,zd=this._getCanonicalUserID();if(zd){yd=kb.get(zd);}else{var ae=xd.participants.map(function(ce){return za.getUserID(ce);});yd=kb.getGroup(ae);}if(!ca.isOnline())yd=l.OFFLINE;if(zd)this._updateCallLink(yd);ga.conditionClass(this._tabElem,"_5238",yd===l.ACTIVE);ga.conditionClass(this._tabElem,"_42nw",yd===l.IDLE);ga.conditionClass(this._tabElem,"_5239",yd===l.MOBILE);var be=this._getNode('presenceIndicator');switch(yd){case l.ACTIVE:be.setAttribute('alt',"Online");break;case l.MOBILE:be.setAttribute('alt',"Mobile");break;default:be.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){this._setNameConversationLink();wc.getThreadMeta(this._threadID,function(xd){vc.renderAndSeparatedParticipantList(this._threadID,[this._getNode('name'),this._getNode('titlebarText')],{names_renderer:bb.renderShortNames,check_length:true});this._updateControls(xd);this._updateMutingSettings(xd);this._updateUnreadCount(xd);this.updateMultichatTooltip();this._updateArchiveWarning(xd);this._updateNewThread(xd);this._updateNameConversationSheet(xd);this._updateReadOnlySheet(xd);}.bind(this));},_setNameConversationLink:function(){var xd=this._getNode('nameConversationLink');if(xd)wc.isEmptyLocalThread(this._threadID)?ga.hide(xd):ga.show(xd);},_updateNameConversationSheet:function(xd){if(wc.canReply(xd.thread_id)&&!xd.name&&!xd.is_canonical&&!xd.name_conversation_sheet_dismissed&&!xd.has_email_participant&&!xd.read_only&&!wc.isEmptyLocalThread(xd.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(xd){var yd=wc.canReply(xd.thread_id),zd=wc.isEmptyLocalThread(xd.thread_id);if(!yd&&!zd)this._sheetController.openReadOnlySheet();},updateSignatureID:function(xd){this._signatureID=xd;},_showPhotoNUXIfNecessary:function(){if(zc){zc=false;new j('/ajax/chat/photo_nux.php').setRelativeTo(this._getNode('photoUploaderContainer')).setData({threadID:this._threadID}).send();return true;}},_setUpMutingSettings:function(xd){var yd=cb.isThreadMuted(xd);if(yd)this._sheetController.openThreadIsMutedTabSheet();this._updateActionMenu(yd);},_updateMutingSettings:function(xd){var yd=cb.isThreadMuted(xd),zd;if(p.get('chat_react_option_menu')){zd=this._reactChatTabMenu.props.isMuted;}else zd=ga.shown(this._getNode('unmuteThreadLink').parentNode);if(yd&&!zd){this._sheetController.openThreadIsMutedTabSheet();}else if(!yd&&zd)this._sheetController.closeThreadIsMutedTabSheet();this._updateActionMenu(yd);},_updateActionMenu:function(xd){if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({isMuted:xd});}else{ga.conditionShow(this._getNode('muteThreadLink').parentNode,!xd);ga.conditionShow(this._getNode('unmuteThreadLink').parentNode,xd);}},_updateArchiveWarning:function(xd){var yd=false;za.get(za.user,function(zd){yd=zd.employee;if(yd)za.getMulti(xd.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));}.bind(this));},_updateControls:function(xd,yd){var zd=false;if(xd&&xd.thread_id){var ae=tc.tokenizeThreadID(xd.thread_id);if(ae.type==='user'){var be=ae.value;zd=!tc.isUser(be);}}var ce=wc.canReply(xd.thread_id)&&(!oc(xd.participants)||yd);ga.conditionShow(this._inputContainerNode,ce);ga.conditionShow(this._iconsContainerNode,ce);if(!p.get('chat_react_option_menu')){ga.conditionShow(this._getNode('dropdown'),ce);}else{this._reactChatTabMenu.setProps({show:ce});if(zd)this._reactChatTabMenu.setProps({showAddFriend:null});}ga.conditionShow(this._getNode('addToThreadLink'),ce&&!zd);this._resizeInputContainer();this._updateOrionTrigger(ce);},_updateOrionTrigger:function(xd){if(this._orionTrigger&&xd){var yd=this.getParticipantIDForOrionNUX();ga.conditionShow(this._orionTriggerContainer,yd);if(yd){za.get(yd,function(zd){zd.userId=za.getUserID(yd);this._orionTrigger.setProps({receiver:zd,disabled:!zd.orion_eligible});if(this.isOrionNUXEligible())this.showOrionNUXTooltip();}.bind(this));}else this._orionTrigger.setProps({receiver:null});}},getParticipantIDForOrionNUX:function(){var xd=this._sheetController.getAddFriendsTabSheet(),yd=xd.getParticipants(),zd=this._getCanonicalUserID(),ae=null;if(zd){ae=za.getIDForUser(zd);}else if(yd&&yd.length===1)ae=yd[0];return ae;},showOrionNUXTooltip:function(){if(this._orionTrigger&&va.ShowOrionNUXTooltip)this._orionTrigger.setShouldShowNUXTooltip();},isOrionNUXEligible:function(){var xd=this.getParticipantIDForOrionNUX();return xd&&this.isVisible()&&ga.hasClass(this._tabElem,'opened');},_resizeInputContainer:function(){var xd=this._tabElem.clientWidth,yd=2,zd=xd-(this._inputContainerNode.clientWidth+yd),ae=ua.isRTL()?'left':'right';wb.set(this._iconsContainerNode,ae,zd+'px');if(!pb.WebStickerTrigger)zb.getInstance(this._getNode('input')).update();},_updateNewThread:function(xd){if(wc.isNewEmptyLocalThread(xd.thread_id))this.showAddFriend();},_showArchiveWarningIfAllParticipantsAreEmployees:function(xd){var yd=true;for(var zd in xd)yd=yd&&xd[zd].employee;var ae=this._getNode('titanArchiveWarning');if(ae){if(this._titlebarTooltipAnchor)ga.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',yd);ga.conditionShow(ae,yd);}},updateMultichatTooltip:function(){wc.getThreadMeta(this._threadID,function(xd){if(!xd.is_canonical)cd(this._titlebarTooltipAnchor,xd.participants);}.bind(this));},_getNode:function(xd){return this._tabTemplate.getNode(xd);},_getCanonicalUserID:function(){return wc.getCanonicalUserInThread(this._threadID);},_listen:function(xd,event,yd,zd){var ae=this._getNode(xd);if(ae){this._eventListeners.push(qa.listen(ae,event,yd.bind(this)));}else if(!zd)throw new Error('Could not find node "'+xd+'"');},_closePreClicked:function(xd){this._closeMouseDown=true;},_closeClicked:function(xd){ud(this);td.inform('closed-tab',this._threadID);xd.kill();},_closeEnter:function(xd){if(xd.keyCode===ta.RETURN)this._closeClicked(xd);},_nubClicked:function(xd){if(!this._isDragDropActive){xd.kill();return td.inform('nub-activated',this._threadID);}},_dockKeyDown:function(event){if(event.keyCode===ta.RETURN||event.keyCode===ta.SPACE){td.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===ta.ESC){this._handleEscape();if(pb.WebStickerTrigger)event=new la(event);event.kill();}else if(event.keyCode===ta.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var xd=td.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(pb.WebStickerTrigger)event=new la(event);!xd&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}ud(this);if(this.hasEmptyInput()){td.inform('esc-pressed',this._threadID);}else{var xd="Are you sure you want to close this chat window?",yd="You haven't sent your message.",zd=new ia().setTitle(xd).setBody(yd).setButtons([ia.CLOSE,ia.CANCEL]).setHandler(td.inform.bind(td,'esc-pressed',this._threadID,null)).setModal(true).show(),ae=zd.getButtonElement('yes');ae&&ra.set(ae);}},_titleClicked:function(event){var xd=event.getTarget();if(!hb.byClass(xd,'titlebarText')&&!hb.byClass(xd,'uiSelector')&&!hb.byClass(xd,'addToThread')&&!hb.byClass(xd,'optionMenu')&&!this._isDragDropActive){td.inform('lower-activated',this._threadID);event.kill();}},_callClicked:function(xd){var yd=this._getCanonicalUserID();if(fc.availableForCall(yd)){var zd='chat_tab_icon';if(xd.target&&ga.hasClass(xd.target,'video_call_promo')){zd='chat_tab_icon_promo';}else if(xd.target&&ga.hasClass(xd.target,'video_call_tour'))zd='chat_tab_icon_tour';td.inform('video-call-clicked',{threadID:this._threadID,userID:yd,clickSource:zd});}return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_nameConversationLinkClicked:function(){this.showNameConversation();},_showParticipantsClicked:function(){tc.getServerThreadID(this._threadID,function(xd){i.send(new j(dc('/ajax/browser/dialog/multichat_members/').addQueryData({id:xd})));});},_clearHistory:function(){var xd=wc.getThreadMetaNow(this._threadID);if(xd){var yd=this._getCanonicalUserID();tc.clearChat(this._threadID,yd,xd.timestamp);}},_unsubscribeLinkClicked:function(){var xd=[];xd.push({name:'unsubscribe',label:"Leave Conversation",handler:this._unsubscribeToThread.bind(this)});xd.push(ia.CANCEL);new ia().setTitle("Leave Conversation?").setBody("You will stop receiving messages from this conversation and people will see that you left.").setButtons(xd).show();},_getUserParticipants:function(xd){var yd=[];xd.forEach(function(zd){var ae=za.getUserID(zd);ae&&yd.push(ae);});return yd;},_createGroupClicked:function(){wc.getThreadMeta(this._threadID,function(xd){if(!xd.is_canonical){var yd=dc('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),zd=this._getUserParticipants(xd.participants);yd.addQueryData({members:zd});if(xd.name)yd.addQueryData({name:xd.name});i.send(new j(yd));}}.bind(this));},_enableDesktopNotif:function(){Notification.requestPermission();},_reportSpamClicked:function(){var xd=this._getCanonicalUserID(),yd=dc('/ajax/chat/report.php').addQueryData({id:xd}).addQueryData({src:'top_report_link'});i.send(new j(yd));},_inputPasted:function(event){if(ec.chrome()){var xd=event.clipboardData||event.originalEvent.clipboardData;if(!xd||!xd.items||xd.items.length<1)return;var yd=xd.items[0].type;if(yd!=='image/png')return;if(xd.items[0].getAsFile){var zd=xd.items[0].getAsFile();this._photoUploader.uploadFile(zd);}}},_focusInput:function(){if(pb.WebStickerTrigger){this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){ga.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._contextualDialogController.tabFocused();if(!ad&&this._showPhotoNUXIfNecessary())g.subscribe(['ChatNUX/show','ChatNUX/hide'],function(event){ad=event==='ChatNUX/show';});this._closeMouseDown=false;this._setCloseTooltip(true);td.inform('focus-tab',this._threadID);},_blurTab:function(){ga.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(xd){var yd=this._getNode('titlebarCloseButton'),zd=xd?"Press Esc to close":"Close tab";bc.set(yd,zd,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===ta.RETURN&&!event.shiftKey){if(od(this)){md(this);event.kill&&event.kill();return;}jd(this);if(pb.WebStickerTrigger)this._activateStickerTriggerAfterparty();event.kill&&event.kill();return;}if(event.keyCode===ta.DOWN&&event.shiftKey&&this.hasEmptyInput()){td.inform('lower-activated',this._threadID);event.kill&&event.kill();return;}this._handleHotkeyPressed(event);},_activateStickerTriggerAfterparty:function(){this._persistTrigger=true;clearTimeout(this._triggerTimeoutID);this._triggerTimeoutID=setTimeout(this._deactivateStickerTriggerAfterparty.bind(this),10000);},_deactivateStickerTriggerAfterparty:function(){clearTimeout(this._triggerTimeoutID);this._persistTrigger=false;this._userUsedTrigger=false;this._setStickerTrigger([],null);},_setStickerTrigger:function(xd,yd){if(yd===this._triggeredWord)return;this._triggeredWord=yd;this._stickerTriggerImage.setProps({stickers:xd});m.log('StickersLoggerConfig',{event:'sticker_trigger_activated',triggeredword:yd,triggerused:false});},getTriggeredWord:function(){return this._triggeredWord;},isTriggerValid:function(){return !this._userUsedTrigger;},_inputChanged:function(xd){if(this._persistTrigger)this._deactivateStickerTriggerAfterparty();if(this.isTriggerValid())tb.prepareTagsData().then(function(){return tb.findTagForInput(xd,function(yd,zd){return this._setStickerTrigger(yd,zd);}.bind(this));}.bind(this));},_initializeThingsWithInputFn:function(xd,yd){this._shareLinkUploader=new x(this._tabTemplate.getNode('attachmentShelf'),xd,this.focus.bind(this),yd);this._initializeUploader(this._shareLinkUploader);wc.getThreadMeta(this._threadID,function(zd){tc.getServerThreadID(this._threadID,function(ae){this._typingDetector=new cc(this._getCanonicalUserID(),xd,'mercury-chat',null,ae,yd);}.bind(this));}.bind(this));},_initializeThingsWithInput:function(){if(!pb.WebStickerTrigger)this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));},_getInputValue:function(){if(pb.WebStickerTrigger){return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},_hasUnfinishedPost:function(){return pd(this)||nd(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){td.inform('read',this._threadID);return true;}return false;},_chatConvClicked:function(xd){this.tryMarkAsRead();if(hb.byTag(xd.getTarget(),'a')||ka.getSelection())return;this.focus();},_inputContainerClicked:function(xd){this.tryMarkAsRead();this.focus();},showTypingIndicator:function(xd){if(p.get('chat_closed_tab_typing_indicator_animated')){var yd=ka.find(this._tabElem,"._54m9");if(xd){this._animatedTypingIndicator=lb.renderComponent(lb.createElement(db,null),yd);this._updateAnimatedIndicatorColor();ga.addClass(this._tabElem,"_54m8");ga.show(yd);}else{ga.removeClass(this._tabElem,"_54m8");ga.hide(yd);lb.unmountComponentAtNode(yd);this._animatedTypingIndicator=null;}}else ga.conditionClass(this._tabElem,'typing',xd);},_updateAnimatedIndicatorColor:function(){if(this._animatedTypingIndicator){var xd=ga.hasClass(this._tabElem,'highlightTab')?'light':'dark';this._animatedTypingIndicator.setProps({color:xd});}},_updateUnreadCount:function(xd){var yd=xd.unread_count;if(typeof yd!='undefined'){var zd=!!yd&&(!o.showsTabUnreadUI||o.showsTabUnreadUI()),ae=this._getNode('numMessages');ga.conditionShow(ae,zd);ga.conditionClass(this._tabElem,'highlightTab',zd);this._updateAnimatedIndicatorColor();gd(this._threadID,this._tabElem,zd);ka.setContent(ae,yd);}},_updateCallLink:function(xd){var yd=this._getNode('videoCallLink'),zd=this._getCanonicalUserID();if(zd===fa.getID()){this._hideVideoCallouts();ga.hide(yd);return;}if(ca.isOnline()){var ae='fbid:'+zd;za.get(ae,function(be){if(fc.availableForCall(zd)){bc.set(yd,qc._("Start a video call with {firstname}",{firstname:be.short_name}));}else{bc.set(yd,qc._("{firstname} is currently unavailable for video calling",{firstname:be.short_name}));this._hideVideoCallouts();}}.bind(this));}else{bc.set(yd,"You must be online to make a call.");this._hideVideoCallouts();}},_hideVideoCallouts:function(){this._contextualDialogController.hideVideoCallouts();},_updatePrivacyLink:function(xd){var yd;if(xd==v.OFFLINE){yd="Go online";if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({privacyText:yd});}else ka.setContent(this._privacyLink,yd);return;}var zd=this._getCanonicalUserID();if(!zd)return;var ae='fbid:'+zd;za.get(ae,function(be){if(xd==v.BLOCKED){yd=qc._("Turn On Chat for {name}",{name:be.short_name});}else yd=qc._("Turn Off Chat for {name}",{name:be.short_name});if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({privacyText:yd});}else ka.setContent(this._privacyLink,yd);}.bind(this));},_unsubscribeToThread:function(){if(!wc.isEmptyLocalThread(this._threadID)){var xd=sc.constructLogMessageObject(ab.CHAT_WEB,this._threadID,ya.UNSUBSCRIBE,{removed_participants:[za.user]});sc.sendMessage(xd);}td.inform('unsubscribed',this._threadID);return true;},_initializeUploader:function(xd){this._subscriptionsHandler.addSubscriptions(xd.subscribe(['all-uploads-completed','upload-canceled'],function(){qd(this);}.bind(this)),xd.subscribe('dom-updated',function(){rd(this);}.bind(this)),xd.subscribe('submit',function(){this._focusInput();}.bind(this)));},_initializeReactMenu:function(xd){var yd=this._getNode('menuContainer'),zd=wa.isMultichat(this._threadID),ae=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(yd)this._reactChatTabMenu=lb.renderComponent(lb.createElement(z,{onFileUploaderMounted:this.setFileUploader.bind(this),updatePrivacyLinkFunc:this._updatePrivacyLink.bind(this),nameConversationFunc:this._nameConversationLinkClicked.bind(this),showParticipantsFunc:this._showParticipantsClicked.bind(this),leaveConversationFunc:this._unsubscribeLinkClicked.bind(this),clearHistoryFunc:this._clearHistory.bind(this),reportSpamFunc:this._reportSpamClicked.bind(this),createGroupFunc:this._createGroupClicked.bind(this),isMultichat:zd,showAddFriend:ae,threadID:this._threadID,attachmentsShelf:xd,onUploadFinished:qd.bind(this,this),onUpdateAttachmentsShelf:rd.bind(this,this),onSubmit:this._focusInput.bind(this),enableDesktopNotif:function(){this._enableDesktopNotif();}.bind(this)}),yd);},_initializeReactFileUploader:function(xd){this._fileUploader=lb.renderComponent(lb.createElement(r,{onFileUploaderMount:this.setFileUploader.bind(this),attachmentsShelf:xd,onUploadFinished:qd.bind(this,this),onUpdateAttachmentsShelf:rd.bind(this,this),onSubmit:this._focusInput.bind(this)}),this._getNode('fileUploaderContainer'));},setFileUploader:function(xd){this._fileUploader=xd;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=lb.renderComponent(lb.createElement(u,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_handlePUSubmit:function(xd,yd){sd(this,ib.UPLOAD_START,yd);ld(this,'',[],function(zd){if(this._threadID!==zd.thread_id){this._newThreadIDFromPhotoUpload=zd.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(zd.thread_id);}zd.content_attachment=null;sc.updateNewMessage(zd,yd.upload_id,yd);sc.sendMessage(zd);}.bind(this));this._focusInput();},_handlePULastUploadFailed:function(xd,yd){sd(this,ib.CLIENT_ERROR,yd);wd(yd);var zd="Photo Upload Failed",ae="Please try again. Make sure you are uploading a valid photo.";new ia().setTitle(zd).setBody(ae).setButtons(ia.OK).show();},_handlePULastUploadCanceled:function(xd,yd){sd(this,ib.CANCEL_DURING_UPLOAD,yd);wd(yd);},_handlePUAllUploadsCompleted:function(xd,yd){sd(this,ib.ALL_UPLOADS_DONE,yd);var zd=sc.updateMessageAfterUpload(yd.upload_id,yd);sc.clearUploadedMessage(yd.upload_id);sc.sendMessage(zd);var ae=yd.image_ids.length||yd.attachments.length;kd(this,ae);},_stickerSelected:function(xd){ld(this,'',[],function(yd){yd.has_attachment=true;yd.sticker_id=xd;sc.sendMessage(yd);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(xd){var yd=oa.symbols[xd];if(!yd)return;var zd=zb.getInstance(this._getNode('input')),ae=zd.getValue(),be=pa.insertEmoticon(yd,ae,this._selectionPosition.getPos());zd.setValue(be.result);this._selectionPosition.setPos(be.start,be.end);},_clearStickerSearchNUXIndicator:function(){ga.removeClass(this._getNode('nuxIndicator'),'nux');},_orionTriggered:function(){ld(this,'',[],function(xd){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){ga.addClass(this._getNode('nuxIndicator'),'nux');},_clearStickerSearchNUXTooltip:function(){this._stickerSearchNUXTooltip&&this._stickerSearchNUXTooltip.hideNUX();},_onFlyoutShown:function(xd){if(p.get('chat_react_sticker_button')){var yd=this._stickersFlyout.props.packID;if(yd!==qb.SEARCH_PACK_ID)this.focus();}if(pb.WebStickerTrigger&&this._triggeredWord&&!this._userUsedTrigger){m.log('StickersLoggerConfig',{event:'sticker_trigger_activated',triggeredword:this._triggeredWord,triggerused:true});this._userUsedTrigger=true;this._stickersFlyout.setProps({packID:qb.SEARCH_PACK_ID,trigger:this._triggeredWord},xd);this._stickerTriggerImage.setProps({stickers:[]});}else xd();this.flyoutShown=true;},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();}});function wd(xd){var yd=sc.updateMessageAfterUpload(xd.upload_id,xd);sc.clearUploadedMessage(xd.upload_id);sc.deleteMessages(yd.thread_id,[yd.message_id]);sc.deleteLocalMessage(yd.thread_id);}e.exports=td;},null);
__d("ChatNewMessageHandler",["ArbiterMixin","ChatActivity","ChatMentionsNotifications","ChatTabModel","ChatTabView","JSLogger","MercuryAssert","MercuryBrowserAlerts","UserActivity","MercuryConfig","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=l.create('chat_new_message'),s={_raiseNewMessageTab:function(t,u){var v=j.getTab(t),w=false;if(v){w=v.raised;}else w=true;s.inform('chat/new-message-from-server',{thread_id:t});u.to_new_tab=!v;u.to_raised_tab=!!w;},_notify:function(t,u,v){if(p.DesktopNotificationsGK)i.notifyIfMessageToMe(u);var w=k.get(t);v.view_is_visible=w&&w.isVisible();v.view_is_focused=w&&w.isFocused();if(!v.view_is_visible)r.log('message_to_hidden');v.is_active=h.isActive();n.messageReceived(u);},newMessage:function(t,u,v){m.isThreadID(t);var w={thread_id:t,message_id:u.message_id};this._raiseNewMessageTab(t,w);this._notify(t,u,w);r.log('message',w);}};q(s,g);n.subscribe('before-alert',function(t,event){var u=event.threadID,v=k.get(u),w=j.getTab(u);if(w&&w.raised&&v&&v.isVisible()&&v.isFocused()&&o.isActive()){v.tryMarkAsRead();event.cancelAlert();}});e.exports=s;},null);
__d("ChatTabLRUManager",["ChatTabView","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={getLRUVisibleTab:function(k){if(k.hasRoomForRaisedTab())return undefined;var l=Object.keys(k.getTabsToShow()||{}),m=1*60,n=null,o=Infinity;for(var p=0;p<l.length;p++){var q=l[p],r=i.getThreadMetaNow(q);if(h.isTabPromoted(q))continue;if(!g.get(q).hasEmptyInput()||!r)continue;var s=(h.getServerTime()-r.timestamp)/1000;if(!r.timestamp||(r.timestamp&&r.timestamp<o&&s>m)){n=r.thread_id;o=r.timestamp;}}return n;}};e.exports=j;},null);
__d("ChatTabPolicy",["ChatBehavior","JSLogger","MercuryActionTypeConstants","MercuryLogMessageType","MercuryAssert","MercuryParticipants","MercuryParticipantTypes","MercurySourceType","MercuryThreadMode","MercuryThreadMuter","MessagingTag","PresencePrivacy","ShortProfiles","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=b('MercuryUnseenState').get(),u=h.create('tab_policy');function v(w,x){t.markThreadSeen(w,x);}e.exports={messageIsAllowed:function(w,x,y){var z=w.thread_id,aa=x.message_id;k.isThreadID(z);k.isParticipantID(x.author);var ba;if(p.isThreadMuted(w)){ba={thread_id:z,message_id:aa,mute_settings:w.mute_settings};u.log('message_thread_muted',ba);return;}if(w.mode==o.OBJECT_ORIGINATED){ba={thread_id:z,message_id:aa,mode:w.mode};u.log('message_object_originated',ba);return;}if(x.source==n.EMAIL||x.source==n.TITAN_EMAIL_REPLY){ba={thread_id:z,message_id:aa,source:x.source};u.log('message_source_not_allowed',ba);return;}var ca=l.getUserID(x.author);if(!ca){u.log('message_bad_author',{thread_id:z,message_id:aa,user:ca});return;}if(x.action_type!=i.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(x,w)){ba={thread_id:z,message_id:aa,type:x.action_type};u.log('message_non_user_generated',ba);return;}if(w.is_canonical_user&&!g.notifiesUserMessages()){u.log('message_jabber',{thread_id:z,message_id:aa});v(z,true);return;}if(w.is_canonical&&!w.canonical_fbid){u.log('message_canonical_contact',{thread_id:z,message_id:aa});return;}if(w.folder!=q.INBOX){u.log('message_folder',{thread_id:z,message_id:aa,folder:w.folder});return;}var da=l.getUserID(l.user);s.getMulti([ca,da],function(ea){if(!r.allows(ca)){u.log('message_privacy',{thread_id:z,message_id:aa,user:ca});return;}var fa=ea[ca].employee&&ea[da].employee;if(!fa&&ea[ca].type!==m.FRIEND){u.log('message_non_friend',{thread_id:z,message_id:aa,user:ca});return;}y();});},_messageIsNewlyCreatedGroup:function(w,x){return w.action_type===i.LOG_MESSAGE&&w.log_message_type===j.THREAD_NAME&&x.message_count===1;}};},null);
__d("ChatTabViewSelector",["Event","Arbiter","CSS","DataStore","DOM","MenuDeprecated","NubController","ChatTabTemplates","Toggler","copyProperties","MercuryThreadInformer","MercuryThreads","MercuryThreadMetadataRenderer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreadInformer').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadMetadataRenderer').get();function t(u){var v=n[':fb:chat:tab:selector'].build(),w=v.getRoot(),x=v.getNode('menu'),y=k.find(x,'.uiMenuInner'),z={},aa=new m().init(w);i.hide(w);k.insertBefore(u,w);function ba(ea){var fa=0;for(var ga in z){var ha=z[ga],ia=r.getThreadMetaNow(ga),ja=ha.getNode('unreadCount'),ka=(ia&&ia.unread_count)||0;fa+=ka;if(ka>9)ka='+';i.conditionClass(ja,'invisible_elem',!ka);k.setContent(ja,ka);}var la=v.getNode('numMessages');i.conditionShow(la,fa);k.setContent(la,fa);}this.setTabData=function(ea){z={};if(ea.length<1){i.hide(w);return;}i.show(w);k.empty(y);ea.forEach(function(fa){var ga=n[':fb:chat:tab:selector:item'].build();z[fa.id]=ga;var ha=ga.getNode('content');s.renderAndSeparatedParticipantList(fa.id,ha);k.prependContent(y,ga.getRoot());j.set(ga.getRoot(),'threadID',fa.id);var ia=ga.getNode('closeButton');g.listen(ia,'click',function(event){t.inform('selector/close-tab',fa.id);event.kill();});});aa.flyoutContentChanged();k.setContent(v.getNode('numTabs'),ea.length);ba();};function ca(event,ea){if(ea.menu!=x)return;var fa=j.get(ea.item,'threadID');t.inform('selected',fa);o.hide(w);}function da(event,ea){l.register(x);}l.subscribe('select',ca.bind(this));o.listen('show',w,function(){h.inform('layer_shown',{type:'ChatTabSelector'});da();});o.listen('hide',w,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});q.subscribe('threads-updated',ba);}p(t,new h());e.exports=t;},null);
__d("ChatTabController",["Arbiter","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabLRUManager","ChatTabMessagesView","ChatTabModel","ChatTabPolicy","ChatTabView","ChatTabViewSelector","JSLogger","MercuryConfig","MercuryParticipants","StickerState","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreads","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b('ChatTabPresence');b('ChatTypeaheadBehavior');var x=b('MercuryThreadInformer').get(),y=b('MercuryThreads').get(),z=b('MercuryUnseenState').get(),aa=i.get('tab_auto_close_timeout')||7200000,ba=q.create('tab_controller');function ca(qa){y.changeThreadReadStatus(qa,true);da(qa);}function da(qa){z.markThreadSeen(qa);}function ea(qa,ra,sa){var ta=m.get().tabs;qa+=ra?1:-1;while(qa>=0&&qa<ta.length){var ua=ta[qa],va=o.get(ua.id);if(va&&va.isVisible()&&(!sa||ua.raised)){va.focus();return true;}qa+=ra?1:-1;}return false;}function fa(qa,ra){var sa=ra&&ra.getRightmostHiddenTab();if(sa===qa)return null;return sa;}function ga(){return Math.floor(Math.random()*2147483648).toString(16);}function ha(qa,ra,sa,ta){m.raiseTab(qa,true,sa);var ua=ra&&ra.getLeftmostVisibleTab(),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua){m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra),true);}else m.setPromotedTab(qa);g.inform('chat/open-tab',qa);var wa=o.get(qa);wa&&wa.focus();}function ia(qa,ra,sa){var ta=sa.forceDrop();if(!m.getTab(qa))m.raiseTab(qa,false);if(ta)return;var ua=ra&&k.getLRUVisibleTab(ra),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua)m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra));}function ja(qa,ra){var sa=m.indexOf(qa);m.closeTab(qa,ra);return sa;}function ka(qa,ra){j.subscribe('chat/new-message-from-server',function(za,ab){ia(ab.thread_id,qa,ra);});p.subscribe('selected',function(za,ab){ha(ab,qa);});g.subscribe('chat/tabs-order-changed',function(za,ab){m.changeShowingTabs(ab);});g.subscribe('page_transition',function(za,ab){m.closeFragileTabs();});g.subscribe('chat/close-all-tabs',function(){m.closeAllTabs();});if(i.get('chat_close_all_tabs_when_offline'))g.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});o.subscribe('read',function(event,za){ca(za);});h.subscribe('idle',function(za,ab){if(ab>aa){var bb=m.get().tabs;bb.forEach(function(cb){var db=cb.id;y.getThreadMeta(db,function(eb){if(!eb.unread_count){ba.log('autoclose_idle_seen',{thread_id:db,idleness:ab});m.closeTab(db,'autoclose_idle_seen');}});});}});o.subscribe('nub-activated',function(za,ab){ha(ab,qa);});o.subscribe('lower-activated',function(za,ab){m.lowerTab(ab);var bb=o.get(ab);bb&&bb.focus();});o.subscribe('focus-tab',function(za,ab){var bb=m.getTab(ab);if(bb&&bb.raised)ha(ab,qa,bb.signatureID,true);});function sa(za,ab){w.showOutgoingCallDialog(ab.userID,ab.clickSource);m.lowerTab(ab.threadID);}o.subscribe('video-call-clicked',sa);l.subscribe('video-call-clicked',sa);l.subscribe('interaction-with-tab',function(za,ab){var bb=m.getTab(ab);bb&&bb.raised&&da(ab);});o.subscribe('closed-tab',function(za,ab){ba.log('close_view',{thread_id:ab});ja(ab,'close_view');return false;});o.subscribe('thread-deleted',function(za,ab){ba.log('close_thread_deleted',{thread_id:ab});ja(ab,'close_thread_deleted');return false;});o.subscribe('unsubscribed',function(za,ab){ba.log('close_view_unsubscribed',{thread_id:ab});ja(ab,'close_view_unsubscribed');return false;});o.subscribe('esc-pressed',function(za,ab){ba.log('close_esc',{thread_id:ab});var bb=ja(ab,'close_esc');setTimeout(function(){ea(bb-1,true,true)||ea(bb,false,true);},0);});p.subscribe('selector/close-tab',function(za,ab){ba.log('close_chat_from_selector',{thread_id:ab});ja(ab,'close_chat_from_selector');});x.subscribe('messages-received',function(za,ab){for(var bb in ab){var cb=ab[bb];for(var db=0;db<cb.length;db++){var eb=cb[db];if(eb.author!=s.user){if(!eb.is_unread){ba.log('message_already_read',{action_id:eb.action_id,thread_id:eb.thread_id});continue;}y.getThreadMeta(bb,function(fb){n.messageIsAllowed(fb,eb,function(){j.newMessage(bb,eb,qa);});});}}}});x.subscribe('thread-read-changed',function(za,ab){for(var bb in ab)if(!ab[bb].mark_as_read){ba.log('autoclose_marked_unread',{thread_id:bb});m.closeTab(bb,'autoclose_marked_unread');}});o.subscribe('tab-pressed',function(za,ab){return !ea(m.indexOf(ab.id),ab.shiftPressed);});g.subscribe(q.DUMP_EVENT,function(za,ab){ab.chat_controller={auto_close_timeout:aa};});this.openTab=function(za,ab){ha(za,ab,ga());};var ta,ua,va,wa=[],xa;if(t.shouldShowStickerSearchNUXTooltip()){ua=qa.getRightmostRaisedTab();if(ua){xa=o.get(ua);xa.showStickerSearchNUXTooltip();}else g.subscribeOnce('chat/open-tab',function(za,ab){xa=o.get(ab);xa.showStickerSearchNUXTooltip();});}else if(r.ShowOrionNUXTooltip){wa=qa.getRaisedVisibleTabs();for(var ya=0;ya<wa.length;ya++){va=o.get(wa[ya]);if(va.isOrionNUXEligible()){xa=va;break;}}if(xa){xa.showOrionNUXTooltip();}else ta=g.subscribe('chat/open-tab',function(za,ab){xa=o.get(ab);if(xa.isOrionNUXEligible()){g.unsubscribe(ta);xa.showOrionNUXTooltip();}});}}if(v.firefox()){var la=function(){return u.get(document.body,'overflowX')+' '+u.get(document.body,'overflowY');},ma=la(),na=function(){var qa=la();if(qa!==ma){ma=qa;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var oa=new MutationObserver(na),pa={attributes:true,attributeFilter:['class','style']};oa.observe(document.documentElement,pa);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))na();},false);}e.exports=ka;},null);
__d("ChatTabViewCoordinator",["Arbiter","BanzaiODS","Bootloader","ChatTabModel","ChatTabView","ChatTabViewSelector","CSS","JSLogger","Style","Rect","VideoCallSupport","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=n.create('chat_tab_coordinator'),t,u;function v(w,x){var y=new l(w),z={},aa={},ba=false;function ca(){var oa=j.get(),pa={};oa.tabs.forEach(function(ra){pa[ra.id]=1;});s.log('process_tab_changed',{model_tabs:Object.keys(pa),view_tabs:Object.keys(z)});for(var qa in z)if(!pa[qa]){s.log('remove_tab',{tab_id:qa});z[qa].destroy();delete(z[qa]);}da(oa);ma(oa);if(oa.tabNeedsFocus&&!oa.tabNeedsFocus.isFocused())oa.tabNeedsFocus.focus();}function da(oa){var pa=null;oa.tabs.forEach(function(qa){var ra=qa.id,sa=false;if(!z[ra]){s.log('add_tab',{tab_id:ra});z[ra]=new k(ra,qa.server_id,qa.signatureID);sa=true;}else z[ra].updateSignatureID(qa.signatureID);if(z[ra].isFocused())oa.tabNeedsFocus=z[ra];if(sa||!z[ra].nextTabIs(pa)){var ta=z[ra].getScrollTop();if(pa){z[ra].insertBefore(pa);}else z[ra].appendTo(w);if(ta)z[ra].setScrollTop(ta);}pa=z[ra];});}function ea(){var oa=x.getShowingTabsOrder();if(!oa||!oa.length)return;var pa=z[oa[0].id]._tabElem,qa=z[oa[oa.length-1].id]._tabElem,ra=parseInt(o.get(qa,'margin-left'),10)||0,sa=p.getElementBounds(qa).l-2*ra;sa=sa>0?sa:0;t&&t.setBoundingBox(new p(0,p.getElementBounds(pa).r,0,sa));}function fa(oa,pa){var qa=false;pa.forEach(function(ta){if(ta.raised){if(aa[ta.id]){qa=true;delete aa[ta.id];}}else if(!aa[ta.id]){qa=true;aa[ta.id]=true;}});if(qa)return true;if(!t)return true;var ra=ga()||[];if(ra.length!==oa.length)return true;for(var sa=0;sa<oa.length;sa++)if(ra[sa]!==oa[sa].id)return true;return false;}function ga(){var oa=t&&t.getOrder();oa&&oa.reverse();return oa;}function ha(){var oa=ga();if(oa){h.bumpEntityKey('chat.web','tab.drag_order_changed');g.inform('chat/tabs-order-changed',oa);}}function ia(oa,pa,qa){if(z[qa]._scrollTop!=null)z[qa].setScrollTop(z[qa]._scrollTop);}function ja(oa,pa){u=pa;z[pa]._isDragDropActive=true;z[pa]._scrollTop=z[pa].getScrollTop();o.set(z[pa]._tabElem,'z-index',1);ea();h.bumpEntityKey('chat.web','tab.drag_started');}function ka(oa){o.set(z[oa]._tabElem,'z-index','');if(z[oa]._scrollTop!=null)z[oa].setScrollTop(z[oa]._scrollTop);z[oa]._scrollTop=null;u=null;setTimeout(function(){z[oa]._isDragDropActive=false;},0);}function la(oa){i.loadModules(["SortableGroup"],function(pa){var qa=x.getShowingTabsOrder(),ra=fa(qa,oa);if(qa.length<=1){t&&t.removeAllSortables();return;}if(ra){if(t){t.removeAllSortables();}else t=new pa().setBeforeGrabCallback(ja).setDragOverCallback(ia).setDropCallback(ka).setOrderChangeHandler(ha).setUseScroller(false).setDragOverHorizontally();for(var sa=0;sa<qa.length;sa++){var ta=qa[sa];t.addSortable(ta.id,z[ta.id]._tabElem,aa[ta.id]?null:z[ta.id]._titlebar);}}});}function ma(oa){var pa=x.getTabsToShow(oa),qa=[],ra=false;oa.tabs.forEach(function(sa){if(!pa[sa.id]){z[sa.id].setVisibleState(false,sa.raised);qa.push(sa);}});oa.tabs.forEach(function(sa){if(pa[sa.id]){z[sa.id].setVisibleState(true,sa.raised);ra|=sa.raised;}});y.setTabData(qa);na(ra);la(oa.tabs);}function na(oa){if(!oa&&ba){g.inform('layer_hidden',{type:'ChatTab'});ba=false;}else if(oa&&!ba){g.inform('layer_shown',{type:'ChatTab'});ba=true;}}if(q.isVideoCallSupported())m.addClass(w,'videoCallEnabled');x.subscribe('tabs-changed',ca);ca();}r(v.prototype,{forceDrop:function(){if(t&&u){t.forceDrop(u);u=null;return true;}return false;}});e.exports=v;},null);
__d("ChatApp",["CSS","JSLogger"],function(a,b,c,d,e,f,g,h){var i={init:function(j,k,l){if(this._isInitialized){h.create('chat_app').error('repeated_init');return;}this._rootElem=j;d(['TabsViewport','ChatTabController','ChatTabViewCoordinator','MercuryServerRequests','MercuryChannelHandler','MercuryStateCheck'],function(m,n,o,p,q,r){q=q.get();q.turnOn();p.get().handleUpdate(l);this.tabsViewport=new m(k);this.tabViewCoordinator=new o(k,this.tabsViewport);this.tabController=new n(this.tabsViewport,this.tabViewCoordinator);this._isInitialized=this._isLoaded=true;}.bind(this));},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;g.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){g.show(this._rootElem);this.tabsViewport.checkWidth();d(['Dock'],function(j){j.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){d(['UIPagelet'],function(j){j.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');j.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};e.exports=i;},null);